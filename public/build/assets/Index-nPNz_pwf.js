import{r as s,j as o,H as ft,a as y}from"./app-mUrH0ynJ.js";import{C as yt,a as gt,b as xt}from"./card-D_RIkHPn.js";import{u as _t}from"./usePermissions-BawB_cjI.js";import{A as St}from"./app-layout-CXK9X9au.js";import vt from"./NoticeAndEvictionsCreateDrawer-CgmaiIbQ.js";import Ct from"./NoticeAndEvictionsEditDrawer-D0yJk_M0.js";import{FilterBar as wt}from"./FilterBar-Dyt2o17J.js";import{NoticeEvictionsTable as Pt}from"./NoticeEvictionsTable-kbSkVWLi.js";import{PageHeader as jt}from"./PageHeader-oXfEmPZC.js";import{PaginationControls as Et}from"./PaginationControls-4tKP_kkT.js";import{f as Dt}from"./format-PYUiRpxY.js";import"./app-BxoA0TtB.js";import"./utils-CBfrqCZ4.js";import"./index-Co1yv0YL.js";import"./index-CdJFUDDL.js";import"./button-BFBNYzQ-.js";import"./index-CQgkcMAl.js";import"./index-CgzaaCP9.js";import"./index-Do303mGv.js";import"./index-D9BBn6e9.js";import"./index-bRwiAiPA.js";import"./index-kDRJ7vWo.js";import"./x-BVVw4O5L.js";import"./createLucideIcon-DUXn48BB.js";import"./index-Dc_FVRD7.js";import"./index-CXBw7cFo.js";import"./index-DEcWu7_s.js";import"./index-5IheD20q.js";import"./index-I5U3wwZt.js";import"./collapsible-DR70Hr7v.js";import"./chevron-right-o746ehSI.js";import"./index-DK4fbPLM.js";import"./log-out-CXDwqi9T.js";import"./chevrons-up-down-FHN_82j5.js";import"./app-logo-icon-afD3Sqey.js";import"./house-Bx2Ik4FM.js";import"./building-uSWxfBdk.js";import"./users-C2kYwBw2.js";import"./wrench-Cq_dpeQy.js";import"./credit-card-Bcb_2PMm.js";import"./dollar-sign-BB476t67.js";import"./file-text-CjfNfFxM.js";import"./triangle-alert-Dr9RWMLY.js";import"./bell-ch4AgGU_.js";import"./drawer-B7FkQmZP.js";import"./CascadingSelectionFields-BUMxM570.js";import"./label-DmNL2-zA.js";import"./command-B6QMfif7.js";import"./search-BHqZNlG5.js";import"./popover-B07j7TfD.js";import"./check-nxBTAIc9.js";import"./SelectionSummary-CFnaAzW6.js";import"./NoticeFormFields-DPZfzxVu.js";import"./DateField-C5n2duFO.js";import"./calendar-DAc8iCNl.js";import"./chevron-left-Bx0Sy0a0.js";import"./chevron-down-CcniYHCH.js";import"./calendar-e6qKYHCo.js";import"./EvectedOrPaymentPlanField-BUf0tbk9.js";import"./radioGroup-DvkZrWpP.js";import"./index-p6YNWFgp.js";import"./EvictionsField-CE0DrJZQ.js";import"./input-Bo52L6_R.js";import"./HaveAnExceptionField-BFNElK0R.js";import"./HearingDatesField-CGBpHCOy.js";import"./IfLeftField-COimYKX1.js";import"./NoteField-BuNBu9ky.js";import"./OtherTenantsField-CgC0Mgk_.js";import"./SentToAttorneyField-CGlOYDQ1.js";import"./StatusField-BgUtm9T-.js";import"./TypeOfNoticeField-9QfHKOqz.js";import"./select-NL-VGbzo.js";import"./chevron-up-Cls6AU_3.js";import"./WritDateField-B712hmwY.js";import"./CascadingSelectionSection-Zy4Hk4ss.js";import"./SelectionSummary-DOitddaB.js";import"./StatusSection-BzYuWGVz.js";import"./DateSection-x4mVV1z1.js";import"./NoticeTypeSection-C6nYluKG.js";import"./ExceptionSection-JnMxa6jl.js";import"./NoteSection-D2hfm2mH.js";import"./EvictionsSection-qibLmxPj.js";import"./AttorneySection-BxEWxwHt.js";import"./HearingDatesSection-D2UE2TSs.js";import"./EvictionPaymentPlanSection-Ci-Rfeyb.js";import"./IfLeftSection-DZ5f8_Wh.js";import"./WritDateSection-CcCWCuYy.js";import"./OtherTenantsSection-Bvjz392-.js";import"./FilterDropdown-Bkd1Jdkg.js";import"./table-DpihfFkM.js";import"./NoticeEvictionsTableRow-D6BSVzvx.js";import"./StatusBadge-VOFYQkEy.js";import"./badge-CXaZ35ua.js";import"./YesNoBadge-DMBH27o1.js";import"./eye-sD0tKuKR.js";import"./square-pen-3gz5SX3m.js";import"./trash-2-PUmSVtRb.js";import"./download-tURfbWWG.js";import"./plus-Vhp6TgB7.js";const T=i=>{if(!i)return"";const c=/^(\d{4})-(\d{2})-(\d{2})/.exec(i);if(!c)return"";const[,n,l,m]=c;return`${n}-${l}-${m}`},U=(i,c="-")=>{if(!i)return c;const n=/^(\d{4})-(\d{2})-(\d{2})/.exec(i);if(!n)return c;const[,l,m,g]=n,p=new Date(Number(l),Number(m)-1,Number(g));return Dt(p,"P")},bt=(i,c="notice-evictions.csv")=>{try{const n=e=>e==null?"":String(e).replace(/"/g,'""'),m=[["ID","Unit Name","City Name","Property Name","Tenants Name","Other Tenants","Status","Date","Type of Notice","Have An Exception","Note","Evictions","Sent to Attorney","Hearing Dates","Evicted/Payment Plan","If Left","Writ Date"].join(","),...i.map(e=>{try{return[e.id||"",`"${n(e.unit_name)}"`,`"${n(e.city_name)}"`,`"${n(e.property_name)}"`,`"${n(e.tenants_name)}"`,`"${n(e.other_tenants)}"`,`"${n(e.status)}"`,`"${U(e.date,"")}"`,`"${n(e.type_of_notice)}"`,`"${n(e.have_an_exception)}"`,`"${n(e.note)}"`,`"${n(e.evictions)}"`,`"${n(e.sent_to_atorney)}"`,`"${U(e.hearing_dates,"")}"`,`"${n(e.evected_or_payment_plan)}"`,`"${n(e.if_left)}"`,`"${U(e.writ_date,"")}"`].join(",")}catch(b){return console.error("Error processing record row:",e,b),""}}).filter(e=>e!=="")].join(`
`),g=new Blob([m],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a"),w=URL.createObjectURL(g);return p.setAttribute("href",w),p.setAttribute("download",c),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(w),!0}catch(n){throw console.error("CSV Export Error:",n),n}},vn=({paginatedRecords:i,cities:c=[],properties:n=[],units:l=[],tenants:m=[],notices:g=[],pagination:p={current_page:1,per_page:15,total:0,last_page:1}})=>{const[w,e]=s.useState(!1),[b,N]=s.useState(!1),[B,$]=s.useState(!1),[x,A]=s.useState(null),[O,F]=s.useState(p.current_page),[S,R]=s.useState(p.per_page),[v]=s.useState(i),[a,k]=s.useState({city:"",property:"",unit:"",tenant:""}),[,H]=s.useState({city:"",property:"",unit:"",tenant:""}),[W,P]=s.useState(!1),[z,j]=s.useState(!1),[G,E]=s.useState(!1),[J,D]=s.useState(!1),u=(t,r)=>{k(_=>({..._,[t]:r}))},K=t=>{u("city",t.city),P(!1)},M=t=>{const r=t.target.value;u("city",r),P(r.length>0)},X=t=>{const r=t.target.value;u("property",r),j(r.length>0)},Y=t=>{u("property",t.property_name),j(!1)},Z=t=>{const r=t.target.value;u("unit",r),E(r.length>0)},tt=t=>{u("unit",t.unit_name),E(!1)},et=t=>{const r=t.target.value;u("tenant",r),D(r.length>0)},nt=t=>{u("tenant",t.full_name),D(!1)},C=(t=1,r=S)=>{const _=c.find(f=>f.city===a.city),h=n.find(f=>f.property_name===a.property),q=l.find(f=>f.unit_name===a.unit),V=m.find(f=>f.full_name===a.tenant),d={page:t,per_page:r};return _?.id?d.city_id=_.id:a.city.trim()&&(d.city_name=a.city.trim()),h?.id?d.property_id=h.id:a.property.trim()&&(d.property_name=a.property.trim()),q?.id?d.unit_id=q.id:a.unit.trim()&&(d.unit_name=a.unit.trim()),V?.id?d.tenant_id=V.id:a.tenant.trim()&&(d.tenant_name=a.tenant.trim()),d},rt=()=>{const t=C(O,S),r=[];return Object.entries(t).forEach(([_,h])=>{h!=null&&h!==""&&r.push(`${encodeURIComponent(_)}=${encodeURIComponent(String(h))}`)}),r.length>0?"?"+r.join("&"):""},ot=()=>{H(a);const t=C(1);y.get(route("notice_and_evictions.index"),t,{preserveState:!0})},it=()=>{k({city:"",property:"",unit:"",tenant:""}),H({city:"",property:"",unit:"",tenant:""}),P(!1),j(!1),E(!1),D(!1),y.get(route("notice_and_evictions.index"),{},{preserveState:!1})},at=t=>{F(t);const r=C(t,S);y.get(route("notice_and_evictions.index"),r,{preserveState:!0})},st=t=>{R(t),F(1);const r=C(1,t);y.get(route("notice_and_evictions.index"),r,{preserveState:!0})},I=()=>C(O,S),ct=t=>{if(window.confirm("Delete this record? This cannot be undone.")){const r=I();y.delete(`/notice_and_evictions/${t.id}`,{data:r})}},pt=t=>{A(t),$(!0)},mt=()=>{$(!1),A(null),y.reload()},lt=()=>{N(!1),y.reload()},dt=()=>{if(!i.data||i.data.length===0){alert("No data to export");return}e(!0);try{const t=`notice-evictions-${new Date().toISOString().split("T")[0]}.csv`;bt(i.data,t)}catch(t){console.error("Export failed:",t),alert(`Export failed: ${t instanceof Error?t.message:"Unknown error"}. Please check the console for details.`)}finally{e(!1)}},{hasPermission:L,hasAnyPermission:ut,hasAllPermissions:Q}=_t(),ht=rt();return o.jsxs(St,{children:[o.jsx(ft,{title:"Notice & Evictions"}),o.jsx("div",{className:"min-h-screen bg-background py-12 text-foreground transition-colors",children:o.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[o.jsx(jt,{title:"Notice & Evictions",onExport:dt,onAdd:()=>N(!0),isExporting:w,hasRecords:i.data&&i.data.length>0,canCreate:Q(["notice-and-evictions.create","notice-and-evictions.store"])}),o.jsxs(yt,{className:"bg-card text-card-foreground shadow-lg",children:[o.jsx(gt,{children:o.jsx(wt,{tempFilters:a,cities:c,properties:n,units:l,tenants:m,showCityDropdown:W,showPropertyDropdown:z,showUnitDropdown:G,showTenantDropdown:J,setShowCityDropdown:P,setShowPropertyDropdown:j,setShowUnitDropdown:E,setShowTenantDropdown:D,onCityInputChange:M,onPropertyInputChange:X,onUnitInputChange:Z,onTenantInputChange:et,onCitySelect:K,onPropertySelect:Y,onUnitSelect:tt,onTenantSelect:nt,onSearch:ot,onClear:it})}),o.jsxs(xt,{children:[o.jsx(Pt,{records:i.data,hasShowPermission:L("notice-and-evictions.show"),hasEditPermission:Q(["notice-and-evictions.edit","notice-and-evictions.update"]),hasDeletePermission:L("notice-and-evictions.destroy"),hasAnyActionPermission:ut(["notice-and-evictions.show","notice-and-evictions.edit","notice-and-evictions.update","notice-and-evictions.destroy"]),onEdit:pt,onDelete:ct,filterQueryString:ht}),i.data.length===0&&o.jsxs("div",{className:"py-8 text-center text-muted-foreground",children:[o.jsx("p",{className:"text-lg",children:"No records found."}),o.jsx("p",{className:"text-sm",children:"Try adjusting your search criteria."})]}),i.data.length>0&&o.jsx("div",{className:"mt-6 border-t border-border pt-4",children:o.jsxs("div",{className:"flex flex-col items-center justify-between gap-4 md:flex-row",children:[o.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",v.from," to ",v.to," of ",v.total," records"]}),o.jsx(Et,{currentPage:v.current_page,lastPage:v.last_page,perPage:S,onPageChange:at,onPerPageChange:st})]})})]})]})]})}),o.jsx(vt,{open:b,onOpenChange:N,cities:c,properties:n,units:l,tenants:m,notices:g,onSuccess:lt,queryParams:I()}),x&&o.jsx(Ct,{record:{...x,date:T(x.date),hearing_dates:T(x.hearing_dates),writ_date:T(x.writ_date)},cities:c,properties:n,units:l,tenants:m,notices:g,open:B,onOpenChange:$,onSuccess:mt,queryParams:I()},x.id)]})};export{vn as default};
