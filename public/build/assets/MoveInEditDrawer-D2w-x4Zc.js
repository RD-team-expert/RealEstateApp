import{r as _,b as Q,j as i}from"./app-DfhMz46N.js";import{B as k}from"./button-D70ZdTAE.js";import{D as W,a as X,b as Y}from"./drawer-DfcxSr7r.js";import Z from"./CitySelector-De3h6Wdv.js";import B from"./PropertySelector-DVzqcVG7.js";import ee from"./UnitSelector-DPGUHei3.js";import te from"./LeaseSigningSection-Bxvf4THX.js";import ie from"./MoveInDetailsSection-C1qCWXZX.js";import re from"./PaymentSection-CObgi8Xf.js";import ne from"./KeysAndFormsSection-GjiVHTbA.js";import oe from"./InsuranceSection-DRxAr3ir.js";import"./app-B7C1jyr3.js";import"./index-DCi-Xv1e.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-BQKCx-PJ.js";import"./index-CBYZjZBF.js";import"./index-Be_qgOKl.js";import"./index-Bd9tPrb_.js";import"./index-DV6UInPh.js";import"./index-BTxfuEuk.js";import"./x-DZ3FO5Wj.js";import"./createLucideIcon-DgVEEFYv.js";import"./select-CjXVIajk.js";import"./index-Dc_FVRD7.js";import"./index-PkKgVJHn.js";import"./index-Ct5EcCoK.js";import"./index-CubYnoId.js";import"./index-DbgZyH5A.js";import"./chevron-down-VWfm6OW2.js";import"./check-CordmqsZ.js";import"./chevron-up-dLBEGKat.js";import"./FormSection-D6ibOaio.js";import"./label-DcH_3_W8.js";import"./RadioGroupField-BSzZhEyY.js";import"./radioGroup-D6vUyOHk.js";import"./DatePickerField-C14a1Xjh.js";import"./calendar-MDrvGB0M.js";import"./format-PYUiRpxY.js";import"./chevron-left-DiUZGSRN.js";import"./chevron-right-BW9owo_I.js";import"./popover-CAZC23Eq.js";import"./calendar-Rkx4ksc5.js";function We({moveIn:t,units:M,cities:w,properties:y,unitsByProperty:l,open:R,onOpenChange:j,onSuccess:V}){const C=_.useRef(null),S=_.useRef(null),v=_.useRef(null),[U,m]=_.useState(""),[I,x]=_.useState(""),[L,u]=_.useState(""),[A,b]=_.useState([]),[K,D]=_.useState([]),[h,F]=_.useState(""),[g,E]=_.useState(""),[f,T]=_.useState({lease_signing_date:!1,move_in_date:!1,scheduled_paid_time:!1,move_in_form_sent_date:!1,date_of_move_in_form_filled:!1,date_of_insurance_expiration:!1}),c=(e,o)=>{T(s=>({...s,[e]:o}))},z=()=>{if(!t.unit_id)return{cityId:"",propertyId:""};const e=M.find(s=>s.id===t.unit_id);if(!e)return{cityId:"",propertyId:""};const o=y.find(s=>s.property_name===e.property_name);return o?{cityId:o.city_id?.toString()||"",propertyId:o.id.toString()}:{cityId:"",propertyId:""}},{cityId:p,propertyId:d}=z(),{data:r,setData:n,put:H,processing:O,errors:a}=Q({unit_id:t.unit_id??"",signed_lease:t.signed_lease??"No",lease_signing_date:t.lease_signing_date??"",move_in_date:t.move_in_date??"",paid_security_deposit_first_month_rent:t.paid_security_deposit_first_month_rent??"No",scheduled_paid_time:t.scheduled_paid_time??"",handled_keys:t.handled_keys??"No",move_in_form_sent_date:t.move_in_form_sent_date??"",filled_move_in_form:t.filled_move_in_form??"No",date_of_move_in_form_filled:t.date_of_move_in_form_filled??"",submitted_insurance:t.submitted_insurance??"No",date_of_insurance_expiration:t.date_of_insurance_expiration??""});_.useEffect(()=>{F(p),E(d)},[p,d]),_.useEffect(()=>{if(p){const e=y.filter(o=>o.city_id?.toString()===p);D(e)}d&&l[d]&&b(l[d])},[p,d,y,l]);const P=()=>{m(""),x(""),u("")},$=e=>{if(F(e),E(""),n("unit_id",""),x(""),u(""),m(""),e){const o=y.filter(s=>s.city_id?.toString()===e);D(o)}else D([]);b([])},q=e=>{E(e),n("unit_id",""),u(""),m(""),e&&l&&l[e]?b(l[e]):b([])},G=e=>{n("unit_id",parseInt(e)),m("")},N=e=>{e.preventDefault(),m(""),x(""),u("");let o=!1;(!h||h.trim()==="")&&(x("Please select a city before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),o=!0),(!g||g.trim()==="")&&(u("Please select a property before submitting the form."),v.current&&(v.current.focus(),v.current.scrollIntoView({behavior:"smooth",block:"center"})),o=!0),(!r.unit_id||typeof r.unit_id!="number"||r.unit_id<=0)&&(m("Please select a unit before submitting the form."),C.current&&(C.current.focus(),C.current.scrollIntoView({behavior:"smooth",block:"center"})),o=!0),!o&&H(route("move-in.update",t.id),{onSuccess:()=>{P(),j(!1),V?.()}})},J=()=>{n({unit_id:t.unit_id??"",signed_lease:t.signed_lease??"No",lease_signing_date:t.lease_signing_date??"",move_in_date:t.move_in_date??"",paid_security_deposit_first_month_rent:t.paid_security_deposit_first_month_rent??"No",scheduled_paid_time:t.scheduled_paid_time??"",handled_keys:t.handled_keys??"No",move_in_form_sent_date:t.move_in_form_sent_date??"",filled_move_in_form:t.filled_move_in_form??"No",date_of_move_in_form_filled:t.date_of_move_in_form_filled??"",submitted_insurance:t.submitted_insurance??"No",date_of_insurance_expiration:t.date_of_insurance_expiration??""}),F(p),E(d),P(),j(!1)};return i.jsx(W,{open:R,onOpenChange:j,modal:!1,children:i.jsx(X,{size:"half",title:`Edit Move-In Record #${t.id}`,children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:N,className:"space-y-4",children:[i.jsx(Z,{cities:w,selectedCityId:h,onCityChange:$,cityRef:S,error:I||(a.unit_id?"Please select a valid unit.":void 0)}),i.jsx(B,{properties:K,selectedPropertyId:g,onPropertyChange:q,propertyRef:v,disabled:!h,selectedCityId:h,error:L}),i.jsx(ee,{units:A,selectedUnitId:r.unit_id,onUnitChange:G,unitRef:C,disabled:!g,selectedPropertyId:g,validationError:U,error:a.unit_id}),i.jsx(te,{signedLease:r.signed_lease,onSignedLeaseChange:e=>n("signed_lease",e),leaseSigningDate:r.lease_signing_date,onLeaseSigningDateChange:e=>n("lease_signing_date",e),isCalendarOpen:f.lease_signing_date,onCalendarOpenChange:e=>c("lease_signing_date",e),signedLeaseError:a.signed_lease,dateError:a.lease_signing_date}),i.jsx(ie,{moveInDate:r.move_in_date,onMoveInDateChange:e=>n("move_in_date",e),isCalendarOpen:f.move_in_date,onCalendarOpenChange:e=>c("move_in_date",e),error:a.move_in_date}),i.jsx(re,{paidSecurityDeposit:r.paid_security_deposit_first_month_rent,onPaidSecurityDepositChange:e=>n("paid_security_deposit_first_month_rent",e),scheduledPaidTime:r.scheduled_paid_time,onScheduledPaidTimeChange:e=>n("scheduled_paid_time",e),isCalendarOpen:f.scheduled_paid_time,onCalendarOpenChange:e=>c("scheduled_paid_time",e),paidError:a.paid_security_deposit_first_month_rent,dateError:a.scheduled_paid_time}),i.jsx(ne,{handledKeys:r.handled_keys,onHandledKeysChange:e=>n("handled_keys",e),moveInFormSentDate:r.move_in_form_sent_date,onMoveInFormSentDateChange:e=>n("move_in_form_sent_date",e),filledMoveInForm:r.filled_move_in_form,onFilledMoveInFormChange:e=>n("filled_move_in_form",e),dateOfMoveInFormFilled:r.date_of_move_in_form_filled,onDateOfMoveInFormFilledChange:e=>n("date_of_move_in_form_filled",e),formSentCalendarOpen:f.move_in_form_sent_date,onFormSentCalendarOpenChange:e=>c("move_in_form_sent_date",e),formFilledCalendarOpen:f.date_of_move_in_form_filled,onFormFilledCalendarOpenChange:e=>c("date_of_move_in_form_filled",e),handledKeysError:a.handled_keys,formSentDateError:a.move_in_form_sent_date,filledFormError:a.filled_move_in_form,formFilledDateError:a.date_of_move_in_form_filled}),i.jsx(oe,{submittedInsurance:r.submitted_insurance,onSubmittedInsuranceChange:e=>n("submitted_insurance",e),dateOfInsuranceExpiration:r.date_of_insurance_expiration,onDateOfInsuranceExpirationChange:e=>n("date_of_insurance_expiration",e),isCalendarOpen:f.date_of_insurance_expiration,onCalendarOpenChange:e=>c("date_of_insurance_expiration",e),submittedError:a.submitted_insurance,dateError:a.date_of_insurance_expiration})]})}),i.jsx(Y,{children:i.jsxs("div",{className:"flex w-full justify-end gap-2",children:[i.jsx(k,{type:"button",variant:"outline",onClick:J,children:"Cancel"}),i.jsx(k,{type:"submit",disabled:O,onClick:N,children:O?"Updating...":"Update Move-In Record"})]})})]})})})}export{We as default};
