import{r as n,b as L,j as e}from"./app-B8ebXpyL.js";import{D as q,a as B,b as G}from"./drawer-BGYUKi-8.js";import{B as w}from"./button-CPgLtvIU.js";import H from"./LocationSection-BRB1axux.js";import J from"./DateFieldsSection-DhTiM1QC.js";import K from"./PropertyDetailsSection-CN4Ru_4a.js";import Q from"./StatusFieldsSection-CYTHEBfZ.js";import"./app-DzAncQ8Z.js";import"./index-D1eOqOTZ.js";import"./index-BvTxALZe.js";import"./index-DAWwAdgX.js";import"./index-D-HIh1V3.js";import"./index-D14oVES4.js";import"./index-B1T6AYU9.js";import"./index-Ck7g32ef.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-DoFGuxfS.js";import"./createLucideIcon-B4WReUhf.js";import"./FormField-G78_9zjH.js";import"./label-nhRupGpP.js";import"./SelectField-h6E-ygpo.js";import"./select-B8s2DExj.js";import"./index-Dc_FVRD7.js";import"./index-B2KxWlhD.js";import"./index-7ugTB-P5.js";import"./index-Z2oIQlZU.js";import"./index-BCMuVr1f.js";import"./chevron-down-CWVENDnU.js";import"./check-BsIcLAQ3.js";import"./chevron-up-LAfsrV3l.js";import"./TextInputField-C4adQWE_.js";import"./input-C70n0jI8.js";import"./DatePickerField-CE6QW7H3.js";import"./calendar-2G-LkQ2N.js";import"./format-PYUiRpxY.js";import"./chevron-left-DmipREnY.js";import"./chevron-right-g-fM4TgC.js";import"./popover-B8Dlw1xh.js";import"./calendar-4DeXn0g1.js";import"./TextAreaField-eZWtfTt0.js";import"./textarea-CZFxMIAV.js";import"./RadioGroupField-AWoVbwde.js";import"./radioGroup-Bu6NMix8.js";function Ot({cities:N,propertiesByCityId:h,unitsByPropertyId:y,open:P,onOpenChange:b,onSuccess:R}){const l=n.useRef(null),u=n.useRef(null),c=n.useRef(null),[k,i]=n.useState({city:"",property:"",unit:""}),[C,g]=n.useState(null),[x,f]=n.useState(null),[v,m]=n.useState(null),[I,_]=n.useState([]),[E,p]=n.useState([]),[U,V]=n.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:a,setData:s,post:F,processing:S,errors:d,reset:M}=L({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",move_out_form:"",utility_type:""}),T=r=>{const t=parseInt(r);g(t),f(null),m(null),s("unit_id",null),i(o=>({...o,city:"",property:"",unit:""})),t&&h[t]?_(h[t]):_([]),p([])},A=r=>{const t=parseInt(r);f(t),m(null),s("unit_id",null),i(o=>({...o,property:"",unit:""})),t&&y[t]?p(y[t]):p([])},O=r=>{const t=parseInt(r);m(t),s("unit_id",t),i(o=>({...o,unit:""}))},z=r=>{V(t=>({...t,[r]:!t[r]}))},j=r=>{r.preventDefault(),i({city:"",property:"",unit:""});let t=!1;C||(i(o=>({...o,city:"Please select a city before submitting the form."})),l.current&&(l.current.focus(),l.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),x||(i(o=>({...o,property:"Please select a property before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),(!v||!a.unit_id)&&(i(o=>({...o,unit:"Please select a unit before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),!t&&F(route("move-out.store"),{onSuccess:()=>{D(),R?.()}})},D=()=>{M(),g(null),f(null),m(null),i({city:"",property:"",unit:""}),_([]),p([]),b(!1)};return e.jsx(q,{open:P,onOpenChange:b,modal:!1,children:e.jsx(B,{size:"half",title:"Create New Move-Out Record",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx(H,{cities:N,availableProperties:I,availableUnits:E,selectedCity:C,selectedProperty:x,selectedUnit:v,validationErrors:k,cityRef:l,propertyRef:u,unitRef:c,onCityChange:T,onPropertyChange:A,onUnitChange:O,tenants:a.tenants,tenantsError:d.tenants,onTenantsChange:r=>s("tenants",r)}),e.jsx(J,{data:a,errors:d,calendarStates:U,onCalendarToggle:z,onDataChange:s}),e.jsx(K,{data:a,errors:d,onDataChange:s}),e.jsx(Q,{data:a,errors:d,onDataChange:s})]})}),e.jsx(G,{children:e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(w,{type:"button",variant:"outline",onClick:D,className:"flex-1",children:"Cancel"}),e.jsx(w,{type:"submit",onClick:j,disabled:S,className:"flex-1",children:S?"Creating...":"Create Move-Out Record"})]})})]})})})}export{Ot as default};
