import{r as s,b as ie,j as t}from"./app-B8FMPvUf.js";import{B as F}from"./button-DIZZiQM7.js";import{D as ae,a as re,b as oe}from"./drawer-By-qy253.js";import de from"./CitySection-BeC9amuj.js";import le from"./PropertySection-CCXXCWay.js";import ce from"./UnitSection-B5Yx5bVR.js";import ue from"./VendorSection-CAM8BLlr.js";import me from"./TaskSubmissionDateSection-aSDhAU5z.js";import fe from"./ScheduledVisitsSection-8XM7pAn7.js";import _e from"./TaskEndingDateSection-B7fyCNay.js";import he from"./AssignedTasksSection-CFy7tkkR.js";import pe from"./NotesSection-wH5PEr24.js";import ge from"./StatusSection-BEE9xDtJ.js";import ke from"./UrgencySection-DP7lVbb7.js";import"./app-BrEbHAEe.js";import"./index-C_zQ9kkn.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-fZywndxp.js";import"./index-CA_GOVUL.js";import"./index-Ci8SDCQb.js";import"./index-beSbUtJq.js";import"./index-CAMxjZm0.js";import"./index-3cnTBEqV.js";import"./x-krc9GB28.js";import"./createLucideIcon-C8-5KvOO.js";import"./label-mSIjHkAE.js";import"./popover-BMQC-RgO.js";import"./index-9ieSGg2S.js";import"./command-Byz7UfAg.js";import"./search-CLz9Z_Gu.js";import"./chevrons-up-down-BYxCyuCA.js";import"./check-BVaiT64F.js";import"./calendar-CzDWs5lf.js";import"./format-PYUiRpxY.js";import"./chevron-left-nbVEm8OA.js";import"./chevron-right-Ccb_WXJ_.js";import"./chevron-down-C7VOkDBv.js";import"./calendar-DesMu7qT.js";import"./radioGroup-CuIQOkQ9.js";import"./index-CguEkJq1.js";import"./index-BlkGWg27.js";function ot({cities:z,vendors:q,propertiesByCity:R,unitsByProperty:j,filters:G,open:H,onOpenChange:E,onSuccess:J}){const g=s.useRef(null),k=s.useRef(null),b=s.useRef(null),v=s.useRef(null),S=s.useRef(null),[K,u]=s.useState(""),[L,d]=s.useState(""),[M,c]=s.useState(""),[Q,m]=s.useState(""),[W,f]=s.useState(""),[P,_]=s.useState([]),[X,h]=s.useState([]),[U,C]=s.useState([]),[D,T]=s.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),y=(e,i)=>{T(l=>({...l,[e]:i}))},{data:n,setData:a,post:Y,processing:A,errors:r,reset:O,transform:Z}=ie({vendor_id:"",unit_id:"",task_submission_date:"",assigned_tasks:"",any_scheduled_visits:"",notes:"",task_ending_date:"",status:"",urgent:"No"}),[o,w]=s.useState(""),[I,x]=s.useState(""),[,p]=s.useState(""),[,V]=s.useState(""),$=e=>{w(e),x(""),p(""),V(""),a("unit_id",""),a("vendor_id",""),u(""),d(""),c(""),e?(R[e]?h(R[e]):h([]),C(q)):(h([]),C([])),_([])},B=e=>{x(e),p(""),a("unit_id",""),d(""),o&&e&&j[o]&&j[o][e]?_(j[o][e]):_([])},ee=e=>{const i=P.find(l=>l.id.toString()===e);i&&(p(i.unit_name),a("unit_id",e),d(""))},te=e=>{const i=U.find(l=>l.id.toString()===e);i&&(V(i.vendor_name),a("vendor_id",e),c(""))},se=e=>{a("assigned_tasks",e.target.value),f("")},N=e=>{e.preventDefault(),u(""),d(""),c(""),m(""),f("");let i=!1;(!o||o.trim()==="")&&(u("Please select a city before submitting the form."),g.current&&(g.current.focus(),g.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.unit_id||n.unit_id.trim()==="")&&(d("Please select a unit before submitting the form."),k.current&&(k.current.focus(),k.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.vendor_id||n.vendor_id.trim()==="")&&(c("Please select a vendor before submitting the form."),b.current&&(b.current.focus(),b.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.task_submission_date||n.task_submission_date.trim()==="")&&(m("Please select a task submission date before submitting the form."),v.current&&(v.current.focus(),v.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.assigned_tasks||n.assigned_tasks.trim()==="")&&(f("Please enter assigned tasks before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),!i&&(Z(l=>({...l,redirect_filters:{...G}})),Y(route("vendor-task-tracker.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{O(),w(""),x(""),p(""),V(""),u(""),d(""),c(""),m(""),f(""),_([]),h([]),C([]),T({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),E(!1),J?.()}}))},ne=()=>{O(),w(""),x(""),p(""),V(""),u(""),d(""),c(""),m(""),f(""),_([]),h([]),C([]),T({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),E(!1)};return t.jsx(ae,{open:H,onOpenChange:E,modal:!1,children:t.jsx(re,{size:"half",title:"Create New Vendor Task",children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.jsxs("form",{onSubmit:N,className:"space-y-4",children:[t.jsx(de,{cities:z,selectedCity:o,onCityChange:$,cityRef:g,errors:r,validationError:K}),t.jsx(le,{availableProperties:X,selectedProperty:I,selectedCity:o,onPropertyChange:B}),t.jsx(ce,{availableUnits:P,selectedProperty:I,unitId:n.unit_id,onUnitChange:ee,unitRef:k,errors:r,validationError:L}),t.jsx(ue,{availableVendors:U,selectedCity:o,vendorId:n.vendor_id,onVendorChange:te,vendorRef:b,errors:r,validationError:M}),t.jsx(me,{taskSubmissionDate:n.task_submission_date,calendarOpen:D.task_submission_date,onCalendarOpenChange:e=>y("task_submission_date",e),onDateChange:e=>{a("task_submission_date",e),m("")},taskSubmissionDateRef:v,errors:r,validationError:Q}),t.jsx(fe,{scheduledVisits:n.any_scheduled_visits,calendarOpen:D.any_scheduled_visits,onCalendarOpenChange:e=>y("any_scheduled_visits",e),onDateChange:e=>a("any_scheduled_visits",e),errors:r}),t.jsx(_e,{taskEndingDate:n.task_ending_date,calendarOpen:D.task_ending_date,onCalendarOpenChange:e=>y("task_ending_date",e),onDateChange:e=>a("task_ending_date",e),errors:r}),t.jsx(he,{assignedTasks:n.assigned_tasks,onAssignedTasksChange:se,assignedTasksRef:S,errors:r,validationError:W}),t.jsx(pe,{notes:n.notes,onNotesChange:e=>a("notes",e.target.value),errors:r}),t.jsx(ge,{status:n.status,onStatusChange:e=>a("status",e),errors:r}),t.jsx(ke,{urgent:n.urgent,onUrgentChange:e=>a("urgent",e),errors:r})]})}),t.jsx(oe,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(F,{type:"button",variant:"outline",onClick:ne,className:"flex-1",children:"Cancel"}),t.jsx(F,{type:"submit",onClick:N,disabled:A,className:"flex-1",children:A?"Creating...":"Create Task"})]})})]})})})}export{ot as default};
