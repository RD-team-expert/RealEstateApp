import{r as p,b as G,j as i,a as J}from"./app-BSOlzI_M.js";import{B as k}from"./button-D2rKFPK1.js";import{D as K,a as M,b as O}from"./drawer-B6ZRXvIZ.js";import{CascadingSelectionSection as Q}from"./CascadingSelectionSection-BN9lXIqW.js";import{SelectionSummary as X}from"./SelectionSummary-BUAsJqSE.js";import{StatusSection as Y}from"./StatusSection-BWQZS7q3.js";import{DateSection as Z}from"./DateSection-BbjgYa4_.js";import{NoticeTypeSection as tt}from"./NoticeTypeSection-B7s2yZ_E.js";import{ExceptionSection as et}from"./ExceptionSection-CT6wqJWS.js";import{NoteSection as nt}from"./NoteSection-BbcRUh_f.js";import{EvictionsSection as it}from"./EvictionsSection-DJc-ipMq.js";import{AttorneySection as ot}from"./AttorneySection-DWd0YpIN.js";import{HearingDatesSection as at}from"./HearingDatesSection-QkOJe0Vm.js";import{EvictionPaymentPlanSection as rt}from"./EvictionPaymentPlanSection-6O10Cwcr.js";import{IfLeftSection as st}from"./IfLeftSection-BpQZ8vQz.js";import{WritDateSection as lt}from"./WritDateSection-Blo3u7KX.js";import{OtherTenantsSection as _t}from"./OtherTenantsSection-Chfn4suH.js";import"./app-D9zByHv3.js";import"./index-ByB7CnZO.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-09CEhTtY.js";import"./index-BK07_5Wa.js";import"./index-C5g_kYK6.js";import"./index-DIXGfQsU.js";import"./index-BLt4aHaa.js";import"./index-Eh5rTZKr.js";import"./x-V2a7Zg3Q.js";import"./createLucideIcon-BGWKpKjb.js";import"./label-ku6Bo0xE.js";import"./command-CBR154ui.js";import"./search-BcNZ_u8M.js";import"./popover-CKsI89_0.js";import"./index-C4PIvpnm.js";import"./chevrons-up-down-D-iRWSMZ.js";import"./check-BE4k6INO.js";import"./radioGroup-DqEJ_5sj.js";import"./index-p7EaCzMM.js";import"./index-C4dPa-2_.js";import"./calendar-Di5dbzoO.js";import"./format-PYUiRpxY.js";import"./chevron-left-CVo-4b8C.js";import"./chevron-right-DU-yjHU5.js";import"./chevron-down--Oeingn_.js";import"./calendar-CthI5zTo.js";import"./select-Ckv1zRlQ.js";import"./index-Dc_FVRD7.js";import"./index-CJ72cHre.js";import"./chevron-up-RzjEL1k0.js";import"./input-DWv8_Yxn.js";function re({record:e,cities:D,properties:f,units:d,tenants:u,notices:A,open:x,onOpenChange:g,onSuccess:B,queryParams:V={}}){const[$,_]=p.useState({}),[S,E]=p.useState(null),[C,j]=p.useState(null),[h,y]=p.useState(null),[w,P]=p.useState([]),[T,I]=p.useState([]),[b,v]=p.useState([]),m=t=>{if(!t||t.trim()==="")return"";try{const n=new Date(t);return isNaN(n.getTime())?"":n.toISOString().split("T")[0]}catch(n){return console.warn("Date formatting error:",n),""}},{data:s,setData:a,processing:U,errors:l}=G({tenant_id:e.tenant_id||null,status:e.status||"",date:m(e.date)||"",type_of_notice:e.type_of_notice||"",have_an_exception:e.have_an_exception||"",note:e.note||"",evictions:e.evictions||"",sent_to_atorney:e.sent_to_atorney||"",hearing_dates:m(e.hearing_dates)||"",evected_or_payment_plan:e.evected_or_payment_plan||"",if_left:e.if_left||"",writ_date:m(e.writ_date)||"",other_tenants:e.other_tenants||""});p.useEffect(()=>{if(e&&e.tenant_id&&x){const t=u.find(n=>n.id===e.tenant_id);if(t){const n=d.find(o=>o.id===t.unit_id);if(n){const o=f.find(r=>r.id===n.property_id);if(o){E(o.city_id);const r=f.filter(c=>c.city_id===o.city_id);P(r),j(o.id);const N=d.filter(c=>c.property_id===o.id);I(N),y(n.id);const q=u.filter(c=>c.unit_id===n.id);v(q)}}}}},[e,u,d,f,x]);const z=t=>{const n=parseInt(t);E(n),j(null),y(null),a("tenant_id",null),a("other_tenants","");const o=f.filter(r=>r.city_id===n);P(o),I([]),v([]),_(r=>({...r,city:"",property:"",unit:"",tenant:""}))},H=t=>{const n=parseInt(t);j(n),y(null),a("tenant_id",null),a("other_tenants","");const o=d.filter(r=>r.property_id===n);I(o),v([]),_(r=>({...r,property:"",unit:"",tenant:""}))},L=t=>{const n=parseInt(t);y(n),a("tenant_id",null),a("other_tenants","");const o=u.filter(r=>r.unit_id===n);v(o),_(r=>({...r,unit:"",tenant:""}))},R=t=>{const n=parseInt(t);a("tenant_id",n),_(o=>({...o,tenant:""}))},F=t=>{t.preventDefault(),_({});let n=!1;const o={};if(S||(o.city="Please select a city before submitting the form.",n=!0),C||(o.property="Please select a property before submitting the form.",n=!0),h||(o.unit="Please select a unit before submitting the form.",n=!0),s.tenant_id||(o.tenant="Please select a tenant before submitting the form.",n=!0),n){_(o);return}const r={...s,...V};J.put(`/notice_and_evictions/${e.id}`,r,{onSuccess:()=>{_({}),g(!1),B?.()},onError:N=>{console.log("Form submission errors:",N)}})},W=()=>{a({tenant_id:e.tenant_id||null,status:e.status||"",date:m(e.date)||"",type_of_notice:e.type_of_notice||"",have_an_exception:e.have_an_exception||"",note:e.note||"",evictions:e.evictions||"",sent_to_atorney:e.sent_to_atorney||"",hearing_dates:m(e.hearing_dates)||"",evected_or_payment_plan:e.evected_or_payment_plan||"",if_left:e.if_left||"",writ_date:m(e.writ_date)||"",other_tenants:e.other_tenants||""}),_({}),g(!1)};return i.jsx(K,{open:x,onOpenChange:g,modal:!1,children:i.jsx(M,{size:"half",title:`Edit Notice & Eviction (ID: ${e.id})`,children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:F,className:"space-y-4",children:[i.jsx(Q,{cities:D,filteredProperties:w,filteredUnits:T,filteredTenants:b,selectedCityId:S,selectedPropertyId:C,selectedUnitId:h,tenantId:s.tenant_id,onCityChange:z,onPropertyChange:H,onUnitChange:L,onTenantChange:R,validationErrors:$,errors:l}),i.jsx(X,{cities:D,filteredProperties:w,filteredUnits:T,filteredTenants:b,selectedCityId:S,selectedPropertyId:C,selectedUnitId:h,tenantId:s.tenant_id}),i.jsx(_t,{value:s.other_tenants,onChange:t=>a("other_tenants",t),error:l.other_tenants,tenants:b,disabled:!h}),i.jsx(Y,{value:s.status,onChange:t=>a("status",t),error:l.status}),i.jsx(Z,{value:s.date,onChange:t=>a("date",t),error:l.date}),i.jsx(tt,{value:s.type_of_notice,onChange:t=>a("type_of_notice",t),notices:A,error:l.type_of_notice}),i.jsx(et,{value:s.have_an_exception,onChange:t=>a("have_an_exception",t),error:l.have_an_exception}),i.jsx(nt,{value:s.note||"",onChange:t=>a("note",t),error:l.note}),i.jsx(it,{value:s.evictions||"",onChange:t=>a("evictions",t),error:l.evictions}),i.jsx(ot,{value:s.sent_to_atorney,onChange:t=>a("sent_to_atorney",t),error:l.sent_to_atorney}),i.jsx(at,{value:s.hearing_dates,onChange:t=>a("hearing_dates",t),error:l.hearing_dates}),i.jsx(rt,{value:s.evected_or_payment_plan,onChange:t=>a("evected_or_payment_plan",t),error:l.evected_or_payment_plan}),i.jsx(st,{value:s.if_left,onChange:t=>a("if_left",t),error:l.if_left}),i.jsx(lt,{value:s.writ_date,onChange:t=>a("writ_date",t),error:l.writ_date})]})}),i.jsx(O,{children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(k,{type:"button",variant:"outline",onClick:W,className:"flex-1",children:"Cancel"}),i.jsx(k,{type:"submit",onClick:F,disabled:U,className:"flex-1",children:U?"Updating...":"Update Notice & Eviction"})]})})]})})})}export{re as default};
