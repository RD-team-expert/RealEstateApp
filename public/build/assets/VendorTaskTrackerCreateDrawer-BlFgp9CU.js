import{r as n,b as fe,j as e}from"./app-nUSYw4ai.js";import{B as k}from"./createLucideIcon-C5GD6QeA.js";import{P as I,a as z,p as u,b as $,C as H}from"./popover-CMnBhXYh.js";import{D as _e,a as je,b as pe}from"./drawer-ikeMES7v.js";import{L as i}from"./label-DtPmPEai.js";import{S as D,a as F,b as M,c as E,d as T}from"./select-PjIVfLW0.js";import{R as ae}from"./radioGroup-BdD1VW6H.js";import{C as L}from"./calendar-C-0kt65W.js";import{f as h}from"./format-PYUiRpxY.js";import"./app-oDNfBSri.js";import"./chevron-right-uK37_yne.js";import"./chevron-up-BHOYq5G1.js";import"./index-nh9QAngE.js";import"./index-CedKduyQ.js";import"./index-5YpAK82Y.js";import"./index-UYkM-lg7.js";import"./index-DbaH1TRh.js";import"./index-DGbRjXgX.js";import"./index-BKS2-tOY.js";import"./index-mn3Hv6wy.js";function ze({cities:ne,propertiesByCity:Y,unitsByProperty:R,vendorsByCity:G,open:re,onOpenChange:A,onSuccess:le}){const N=n.useRef(null),y=n.useRef(null),S=n.useRef(null),C=n.useRef(null),w=n.useRef(null),[q,x]=n.useState(""),[J,o]=n.useState(""),[K,c]=n.useState(""),[Q,b]=n.useState(""),[W,f]=n.useState(""),[X,_]=n.useState([]),[ie,j]=n.useState([]),[Z,p]=n.useState([]),[O,de]=n.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),m=(s,r)=>{de(v=>({...v,[s]:r}))},{data:t,setData:l,post:oe,processing:B,errors:a,reset:ee}=fe({vendor_id:"",unit_id:"",task_submission_date:"",assigned_tasks:"",any_scheduled_visits:"",notes:"",task_ending_date:"",status:"",urgent:"No"}),[d,U]=n.useState(""),[se,V]=n.useState(""),[,g]=n.useState(""),[,P]=n.useState(""),ce=s=>{U(s),V(""),g(""),P(""),l("unit_id",""),l("vendor_id",""),x(""),o(""),c(""),s?(Y[s]?j(Y[s]):j([]),G[s]?p(G[s]):p([])):(j([]),p([])),_([])},me=s=>{V(s),g(""),l("unit_id",""),o(""),d&&s&&R[d]&&R[d][s]?_(R[d][s]):_([])},ue=s=>{const r=X.find(v=>v.id.toString()===s);r&&(g(r.unit_name),l("unit_id",s),o(""))},he=s=>{const r=Z.find(v=>v.id.toString()===s);r&&(P(r.vendor_name),l("vendor_id",s),c(""))},xe=s=>{l("assigned_tasks",s.target.value),f("")},te=s=>{s.preventDefault(),x(""),o(""),c(""),b(""),f("");let r=!1;(!d||d.trim()==="")&&(x("Please select a city before submitting the form."),N.current&&(N.current.focus(),N.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!t.unit_id||t.unit_id.trim()==="")&&(o("Please select a unit before submitting the form."),y.current&&(y.current.focus(),y.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!t.vendor_id||t.vendor_id.trim()==="")&&(c("Please select a vendor before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!t.task_submission_date||t.task_submission_date.trim()==="")&&(b("Please select a task submission date before submitting the form."),C.current&&(C.current.focus(),C.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!t.assigned_tasks||t.assigned_tasks.trim()==="")&&(f("Please enter assigned tasks before submitting the form."),w.current&&(w.current.focus(),w.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),!r&&oe(route("vendor-task-tracker.store"),{onSuccess:()=>{ee(),U(""),V(""),g(""),P(""),x(""),o(""),c(""),b(""),f(""),_([]),j([]),p([]),A(!1),le?.()}})},be=()=>{ee(),U(""),V(""),g(""),P(""),x(""),o(""),c(""),b(""),f(""),_([]),j([]),p([]),A(!1)};return e.jsx(_e,{open:re,onOpenChange:A,modal:!1,children:e.jsx(je,{size:"half",title:"Create New Vendor Task",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:te,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"city",className:"text-base font-semibold",children:"City *"})}),e.jsxs(D,{onValueChange:ce,value:d,children:[e.jsx(F,{ref:N,children:e.jsx(M,{placeholder:"Select city"})}),e.jsx(E,{children:ne?.map(s=>e.jsx(T,{value:s.city,children:s.city},s.id))||[]})]}),a.vendor_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.vendor_id}),q&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:q})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"property",className:"text-base font-semibold",children:"Property *"})}),e.jsxs(D,{onValueChange:me,value:se,disabled:!d,children:[e.jsx(F,{children:e.jsx(M,{placeholder:"Select property"})}),e.jsx(E,{children:ie?.map(s=>e.jsx(T,{value:s.property_name,children:s.property_name},s.id))||[]})]})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"unit_name",className:"text-base font-semibold",children:"Unit Name *"})}),e.jsxs(D,{onValueChange:ue,value:t.unit_id,disabled:!se,children:[e.jsx(F,{ref:y,children:e.jsx(M,{placeholder:"Select unit"})}),e.jsx(E,{children:X?.map(s=>e.jsx(T,{value:s.id.toString(),children:s.unit_name},s.id))||[]})]}),a.unit_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.unit_id}),J&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:J})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-purple-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"vendor_name",className:"text-base font-semibold",children:"Vendor Name *"})}),e.jsxs(D,{onValueChange:he,value:t.vendor_id,disabled:!d,children:[e.jsx(F,{ref:S,children:e.jsx(M,{placeholder:"Select vendor"})}),e.jsx(E,{children:Z?.map(s=>e.jsx(T,{value:s.id.toString(),children:s.vendor_name},s.id))||[]})]}),a.vendor_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.vendor_id}),K&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:K})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"task_submission_date",className:"text-base font-semibold",children:"Task Submission Date *"})}),e.jsxs(I,{open:O.task_submission_date,onOpenChange:s=>m("task_submission_date",s),modal:!1,children:[e.jsx(z,{asChild:!0,children:e.jsxs(k,{ref:C,variant:"outline",className:`w-full justify-start text-left font-normal ${!t.task_submission_date&&"text-muted-foreground"}`,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),t.task_submission_date?h(u(t.task_submission_date,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx($,{className:"z-[60] w-auto p-0",onOpenAutoFocus:s=>s.preventDefault(),children:e.jsx(H,{mode:"single",selected:t.task_submission_date?u(t.task_submission_date,"yyyy-MM-dd",new Date):void 0,onSelect:s=>{s&&(l("task_submission_date",h(s,"yyyy-MM-dd")),m("task_submission_date",!1),b(""))},initialFocus:!0})})]}),a.task_submission_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.task_submission_date}),Q&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:Q})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"any_scheduled_visits",className:"text-base font-semibold",children:"Any Scheduled Visits"})}),e.jsxs(I,{open:O.any_scheduled_visits,onOpenChange:s=>m("any_scheduled_visits",s),modal:!1,children:[e.jsx(z,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:`w-full justify-start text-left font-normal ${!t.any_scheduled_visits&&"text-muted-foreground"}`,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),t.any_scheduled_visits?h(u(t.any_scheduled_visits,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx($,{className:"z-[60] w-auto p-0",onOpenAutoFocus:s=>s.preventDefault(),children:e.jsx(H,{mode:"single",selected:t.any_scheduled_visits?u(t.any_scheduled_visits,"yyyy-MM-dd",new Date):void 0,onSelect:s=>{s&&(l("any_scheduled_visits",h(s,"yyyy-MM-dd")),m("any_scheduled_visits",!1))},initialFocus:!0})})]}),a.any_scheduled_visits&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.any_scheduled_visits})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"task_ending_date",className:"text-base font-semibold",children:"Task Ending Date"})}),e.jsxs(I,{open:O.task_ending_date,onOpenChange:s=>m("task_ending_date",s),modal:!1,children:[e.jsx(z,{asChild:!0,children:e.jsxs(k,{variant:"outline",className:`w-full justify-start text-left font-normal ${!t.task_ending_date&&"text-muted-foreground"}`,children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),t.task_ending_date?h(u(t.task_ending_date,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx($,{className:"z-[60] w-auto p-0",onOpenAutoFocus:s=>s.preventDefault(),children:e.jsx(H,{mode:"single",selected:t.task_ending_date?u(t.task_ending_date,"yyyy-MM-dd",new Date):void 0,onSelect:s=>{s&&(l("task_ending_date",h(s,"yyyy-MM-dd")),m("task_ending_date",!1))},initialFocus:!0})})]}),a.task_ending_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.task_ending_date})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"assigned_tasks",className:"text-base font-semibold",children:"Assigned Tasks *"})}),e.jsx("textarea",{ref:w,id:"assigned_tasks",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.assigned_tasks,onChange:xe,rows:3,placeholder:"Describe the assigned tasks..."}),a.assigned_tasks&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.assigned_tasks}),W&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:W})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"notes",className:"text-base font-semibold",children:"Notes"})}),e.jsx("textarea",{id:"notes",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.notes,onChange:s=>l("notes",s.target.value),rows:3,placeholder:"Enter any additional notes..."}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.notes})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-red-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"status",className:"text-base font-semibold",children:"Status"})}),e.jsx(ae,{value:t.status,onValueChange:s=>l("status",s),name:"status",options:[{value:"Pending",label:"Pending"},{value:"In Progress",label:"In Progress"},{value:"Completed",label:"Completed"},{value:"On Hold",label:"On Hold"}],className:"flex-wrap"}),a.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.status})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-yellow-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"urgent",className:"text-base font-semibold",children:"Urgent"})}),e.jsx(ae,{value:t.urgent,onValueChange:s=>l("urgent",s),name:"urgent",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}]}),a.urgent&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.urgent})]})]})}),e.jsx(pe,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{type:"button",variant:"outline",onClick:be,className:"flex-1",children:"Cancel"}),e.jsx(k,{type:"submit",onClick:te,disabled:B,className:"flex-1",children:B?"Creating...":"Create Task"})]})})]})})})}export{ze as default};
