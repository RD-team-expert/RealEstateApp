import{r as s,b as q,j as r}from"./app-B8ebXpyL.js";import{B as A}from"./button-CPgLtvIU.js";import{D as G,a as H,b as J}from"./drawer-BGYUKi-8.js";import{CityPropertyUnitSelector as K}from"./CityPropertyUnitSelector-Kt-IQXiH.js";import{ApplicantInformationSection as L}from"./ApplicantInformationSection-BLC3ArBk.js";import{StatusAndDateSection as M}from"./StatusAndDateSection-DVCsn4Ug.js";import{AdditionalDetailsSection as Q}from"./AdditionalDetailsSection-Dm5Wgtfr.js";import"./app-DzAncQ8Z.js";import"./index-BvTxALZe.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-D1eOqOTZ.js";import"./index-DAWwAdgX.js";import"./index-D-HIh1V3.js";import"./index-D14oVES4.js";import"./index-B1T6AYU9.js";import"./index-Ck7g32ef.js";import"./x-DoFGuxfS.js";import"./createLucideIcon-B4WReUhf.js";import"./label-nhRupGpP.js";import"./select-B8s2DExj.js";import"./index-Dc_FVRD7.js";import"./index-B2KxWlhD.js";import"./index-7ugTB-P5.js";import"./index-Z2oIQlZU.js";import"./index-BCMuVr1f.js";import"./chevron-down-CWVENDnU.js";import"./check-BsIcLAQ3.js";import"./chevron-up-LAfsrV3l.js";import"./input-C70n0jI8.js";import"./application-CnwOiERd.js";import"./calendar-2G-LkQ2N.js";import"./format-PYUiRpxY.js";import"./chevron-left-DmipREnY.js";import"./chevron-right-g-fM4TgC.js";import"./popover-B8Dlw1xh.js";import"./radioGroup-Bu6NMix8.js";import"./calendar-4DeXn0g1.js";import"./file-text-CFwiw5Hy.js";function Ft({cities:P,properties:C,units:b,open:d,onOpenChange:v,onSuccess:D}){const l=s.useRef(null),[f,o]=s.useState({}),[x,h]=s.useState(null),[y,m]=s.useState(null),[N,c]=s.useState([]),[w,p]=s.useState([]),{data:i,setData:n,post:E,processing:g,errors:u,reset:_,clearErrors:S}=q({unit_id:null,name:"",co_signer:"",status:"New",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]});s.useEffect(()=>{d||(_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""))},[d]);const F=t=>{const e=parseInt(t);h(e),m(null),n("unit_id",null),o(a=>({...a,city:void 0,property:void 0,unit:void 0})),C[e]?c(C[e]):c([]),p([])},U=t=>{const e=parseInt(t);m(e),n("unit_id",null),o(a=>({...a,property:void 0,unit:void 0})),b[e]?p(b[e]):p([])},R=t=>{const e=parseInt(t);n("unit_id",e),o(a=>({...a,unit:void 0}))},V=t=>{n("name",t),o(e=>({...e,name:void 0}))},k=t=>{n("co_signer",t)},B=t=>{n("applicant_applied_from",t)},z=t=>{n("status",t),o(e=>({...e,status:void 0}))},j=t=>{t.preventDefault(),o({});let e=!1;const a={};if(x||(a.city="Please select a city before submitting the form.",e=!0),y||(a.property="Please select a property before submitting the form.",e=!0),i.unit_id||(a.unit="Please select a unit before submitting the form.",e=!0),(!i.name||i.name.trim()==="")&&(a.name="Please enter a name before submitting the form.",e=!0),(!i.status||i.status.trim()==="")&&(a.status="Please select a status before submitting the form.",e=!0),e){o(a);return}E(route("applications.store"),{onSuccess:()=>{I(),D?.()}})},I=()=>{_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""),v(!1)};return r.jsx(G,{open:d,onOpenChange:v,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Application",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:j,className:"space-y-4",children:[r.jsx(K,{cities:P,selectedCityId:x,selectedPropertyId:y,availableProperties:N,availableUnits:w,unitId:i.unit_id,onCityChange:F,onPropertyChange:U,onUnitChange:R,errors:u,validationErrors:f}),r.jsx(L,{name:i.name,coSigner:i.co_signer,applicantAppliedFrom:i.applicant_applied_from,onNameChange:V,onCoSignerChange:k,onApplicantAppliedFromChange:B,errors:u,validationErrors:f}),r.jsx(M,{status:i.status,date:i.date,onStatusChange:z,onDateChange:t=>n("date",t),errors:u,validationErrors:f}),r.jsx(Q,{stageInProgress:i.stage_in_progress,notes:i.notes,attachments:i.attachments,onStageInProgressChange:t=>n("stage_in_progress",t),onNotesChange:t=>n("notes",t),onAttachmentsChange:t=>n("attachments",t),fileInputRef:l,errors:u})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(A,{type:"button",variant:"outline",onClick:I,disabled:g,children:"Cancel"}),r.jsx(A,{type:"submit",onClick:j,disabled:g,children:g?"Creating...":"Create Application"})]})})]})})})}export{Ft as default};
