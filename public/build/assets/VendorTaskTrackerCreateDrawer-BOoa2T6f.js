import{r as s,b as se,j as t}from"./app-p7g_f0wo.js";import{B as N}from"./button-CgWb-OwV.js";import{D as ne,a as ie,b as oe}from"./drawer-BG8f08dK.js";import re from"./CitySection-DJrA--aZ.js";import ae from"./PropertySection-DkkPpaKK.js";import de from"./UnitSection-xQ4NWCy-.js";import le from"./VendorSection-DPV9k7uv.js";import ce from"./TaskSubmissionDateSection-BxliUMGy.js";import ue from"./ScheduledVisitsSection-FTDlpk1S.js";import me from"./TaskEndingDateSection-Cc4Y4OWv.js";import fe from"./AssignedTasksSection-HTt4wu-Z.js";import pe from"./NotesSection-ByzEvyuZ.js";import _e from"./StatusSection-CPlpnUC4.js";import he from"./UrgencySection-DEd4cDBk.js";import"./app-D9ss4c-j.js";import"./index-6lgmZUbB.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-C9RY0Fne.js";import"./index-H5dANVBP.js";import"./index-DkhO7hde.js";import"./index-soOnB7Xl.js";import"./index-CiElmmUH.js";import"./index-DqXNBRMy.js";import"./x-CLgUf5rt.js";import"./createLucideIcon-DCkjgf37.js";import"./label-DYy2JzQ2.js";import"./select-CfH1ySLB.js";import"./index-Dc_FVRD7.js";import"./index-BxQHv4UU.js";import"./index-DBAs5r5h.js";import"./index-DbQ0MNsB.js";import"./index-BFObTlUk.js";import"./index-BAfRhOcu.js";import"./chevron-down-QjJMMFQo.js";import"./check-Cfkty5Qk.js";import"./chevron-up-DNYJO-3s.js";import"./input-DiaYLKYe.js";import"./calendar-BbyHMKLt.js";import"./format-PYUiRpxY.js";import"./chevron-left-DEQB7mOe.js";import"./chevron-right-DVrPLLPg.js";import"./popover-B4-HGuiv.js";import"./calendar-C5PdxC03.js";import"./radioGroup-Dy3ozKpR.js";function dt({cities:F,vendors:z,propertiesByCity:R,unitsByProperty:j,open:q,onOpenChange:E,onSuccess:G}){const g=s.useRef(null),k=s.useRef(null),b=s.useRef(null),S=s.useRef(null),v=s.useRef(null),[H,c]=s.useState(""),[J,d]=s.useState(""),[K,l]=s.useState(""),[L,u]=s.useState(""),[M,m]=s.useState(""),[y,f]=s.useState([]),[Q,p]=s.useState([]),[P,C]=s.useState([]),[D,W]=s.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),T=(e,i)=>{W(h=>({...h,[e]:i}))},{data:n,setData:o,post:X,processing:U,errors:r,reset:A}=se({vendor_id:"",unit_id:"",task_submission_date:"",assigned_tasks:"",any_scheduled_visits:"",notes:"",task_ending_date:"",status:"",urgent:"No"}),[a,w]=s.useState(""),[O,x]=s.useState(""),[,_]=s.useState(""),[,V]=s.useState(""),Y=e=>{w(e),x(""),_(""),V(""),o("unit_id",""),o("vendor_id",""),c(""),d(""),l(""),e?(R[e]?p(R[e]):p([]),C(z)):(p([]),C([])),f([])},Z=e=>{x(e),_(""),o("unit_id",""),d(""),a&&e&&j[a]&&j[a][e]?f(j[a][e]):f([])},$=e=>{const i=y.find(h=>h.id.toString()===e);i&&(_(i.unit_name),o("unit_id",e),d(""))},B=e=>{const i=P.find(h=>h.id.toString()===e);i&&(V(i.vendor_name),o("vendor_id",e),l(""))},ee=e=>{o("assigned_tasks",e.target.value),m("")},I=e=>{e.preventDefault(),c(""),d(""),l(""),u(""),m("");let i=!1;(!a||a.trim()==="")&&(c("Please select a city before submitting the form."),g.current&&(g.current.focus(),g.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.unit_id||n.unit_id.trim()==="")&&(d("Please select a unit before submitting the form."),k.current&&(k.current.focus(),k.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.vendor_id||n.vendor_id.trim()==="")&&(l("Please select a vendor before submitting the form."),b.current&&(b.current.focus(),b.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.task_submission_date||n.task_submission_date.trim()==="")&&(u("Please select a task submission date before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.assigned_tasks||n.assigned_tasks.trim()==="")&&(m("Please enter assigned tasks before submitting the form."),v.current&&(v.current.focus(),v.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),!i&&X(route("vendor-task-tracker.store"),{onSuccess:()=>{A(),w(""),x(""),_(""),V(""),c(""),d(""),l(""),u(""),m(""),f([]),p([]),C([]),E(!1),G?.()}})},te=()=>{A(),w(""),x(""),_(""),V(""),c(""),d(""),l(""),u(""),m(""),f([]),p([]),C([]),E(!1)};return t.jsx(ne,{open:q,onOpenChange:E,modal:!1,children:t.jsx(ie,{size:"half",title:"Create New Vendor Task",children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.jsxs("form",{onSubmit:I,className:"space-y-4",children:[t.jsx(re,{cities:F,selectedCity:a,onCityChange:Y,cityRef:g,errors:r,validationError:H}),t.jsx(ae,{availableProperties:Q,selectedProperty:O,selectedCity:a,onPropertyChange:Z}),t.jsx(de,{availableUnits:y,selectedProperty:O,unitId:n.unit_id,onUnitChange:$,unitRef:k,errors:r,validationError:J}),t.jsx(le,{availableVendors:P,selectedCity:a,vendorId:n.vendor_id,onVendorChange:B,vendorRef:b,errors:r,validationError:K}),t.jsx(ce,{taskSubmissionDate:n.task_submission_date,calendarOpen:D.task_submission_date,onCalendarOpenChange:e=>T("task_submission_date",e),onDateChange:e=>{o("task_submission_date",e),u("")},taskSubmissionDateRef:S,errors:r,validationError:L}),t.jsx(ue,{scheduledVisits:n.any_scheduled_visits,calendarOpen:D.any_scheduled_visits,onCalendarOpenChange:e=>T("any_scheduled_visits",e),onDateChange:e=>o("any_scheduled_visits",e),errors:r}),t.jsx(me,{taskEndingDate:n.task_ending_date,calendarOpen:D.task_ending_date,onCalendarOpenChange:e=>T("task_ending_date",e),onDateChange:e=>o("task_ending_date",e),errors:r}),t.jsx(fe,{assignedTasks:n.assigned_tasks,onAssignedTasksChange:ee,assignedTasksRef:v,errors:r,validationError:M}),t.jsx(pe,{notes:n.notes,onNotesChange:e=>o("notes",e.target.value),errors:r}),t.jsx(_e,{status:n.status,onStatusChange:e=>o("status",e),errors:r}),t.jsx(he,{urgent:n.urgent,onUrgentChange:e=>o("urgent",e),errors:r})]})}),t.jsx(oe,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(N,{type:"button",variant:"outline",onClick:te,className:"flex-1",children:"Cancel"}),t.jsx(N,{type:"submit",onClick:I,disabled:U,className:"flex-1",children:U?"Creating...":"Create Task"})]})})]})})})}export{dt as default};
