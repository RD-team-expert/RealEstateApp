import{r,b as T,j as o}from"./app-mUrH0ynJ.js";import{D as z,a as H,b as q}from"./drawer-B7FkQmZP.js";import{B as S}from"./button-BFBNYzQ-.js";import{CityPropertyUnitSelector as B}from"./CityPropertyUnitSelector-C4tAUwXK.js";import{LeaseInformationFields as G}from"./LeaseInformationFields-BgHzeVRc.js";import{PaymentInformationFields as J}from"./PaymentInformationFields-BiTjWcCT.js";import{KeysAndFormsFields as Q}from"./KeysAndFormsFields-B5yLiAZW.js";import{InsuranceInformationFields as W}from"./InsuranceInformationFields-Bsvmujfb.js";import"./app-BxoA0TtB.js";import"./index-CQgkcMAl.js";import"./index-Co1yv0YL.js";import"./index-CgzaaCP9.js";import"./index-Do303mGv.js";import"./index-D9BBn6e9.js";import"./index-bRwiAiPA.js";import"./index-kDRJ7vWo.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-BVVw4O5L.js";import"./createLucideIcon-DUXn48BB.js";import"./label-DmNL2-zA.js";import"./select-NL-VGbzo.js";import"./index-Dc_FVRD7.js";import"./index-DK4fbPLM.js";import"./index-CXBw7cFo.js";import"./index-DEcWu7_s.js";import"./index-5IheD20q.js";import"./index-p6YNWFgp.js";import"./chevron-down-CcniYHCH.js";import"./check-nxBTAIc9.js";import"./chevron-up-Cls6AU_3.js";import"./radioGroup-DvkZrWpP.js";import"./DatePickerField-YWR5BVdA.js";import"./calendar-DAc8iCNl.js";import"./format-PYUiRpxY.js";import"./chevron-left-Bx0Sy0a0.js";import"./chevron-right-o746ehSI.js";import"./popover-B07j7TfD.js";import"./calendar-e6qKYHCo.js";function ke({cities:j,properties:D,unitsByProperty:f,open:F,onOpenChange:p,onSuccess:P}){const d=r.useRef(null),m=r.useRef(null),c=r.useRef(null),[E,n]=r.useState(""),[w,_]=r.useState(""),[N,a]=r.useState(""),[M,u]=r.useState([]),[R,h]=r.useState([]),[v,b]=r.useState(""),[g,C]=r.useState(""),{data:t,setData:i,post:V,processing:x,errors:l,reset:k}=T({unit_id:"",signed_lease:"No",lease_signing_date:"",move_in_date:"",paid_security_deposit_first_month_rent:"No",scheduled_paid_time:"",handled_keys:"No",move_in_form_sent_date:"",filled_move_in_form:"No",date_of_move_in_form_filled:"",submitted_insurance:"No",date_of_insurance_expiration:""}),y=()=>{k(),n(""),_(""),a(""),u([]),h([]),b(""),C("")},U=e=>{if(b(e),C(""),i("unit_id",""),_(""),a(""),n(""),e){const s=D.filter(O=>O.city_id?.toString()===e);h(s)}else h([]);u([])},L=e=>{C(e),i("unit_id",""),a(""),n(""),e&&f&&f[e]?u(f[e]):u([])},A=e=>{i("unit_id",parseInt(e)),n("")},I=e=>{e.preventDefault(),n(""),_(""),a("");let s=!1;(!v||v.trim()==="")&&(_("Please select a city before submitting the form."),m.current&&(m.current.focus(),m.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!g||g.trim()==="")&&(a("Please select a property before submitting the form."),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.unit_id||typeof t.unit_id=="number"&&t.unit_id<=0)&&(n("Please select a unit before submitting the form."),d.current&&(d.current.focus(),d.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),!s&&V(route("move-in.store"),{onSuccess:()=>{y(),p(!1),P?.()}})},K=()=>{y(),p(!1)};return o.jsx(z,{open:F,onOpenChange:p,modal:!1,children:o.jsx(H,{size:"half",title:"Create New Move-In Record",children:o.jsxs("div",{className:"flex h-full flex-col",children:[o.jsx("div",{className:"flex-1 overflow-auto p-6",children:o.jsxs("form",{onSubmit:I,className:"space-y-4",children:[o.jsx(B,{cities:j,availableProperties:R,availableUnits:M,selectedCityId:v,selectedPropertyId:g,unitId:t.unit_id,cityRef:m,propertyRef:c,unitRef:d,onCityChange:U,onPropertyChange:L,onUnitChange:A,errors:l,cityValidationError:w,propertyValidationError:N,validationError:E}),o.jsx(G,{signedLease:t.signed_lease,leaseSigningDate:t.lease_signing_date,moveInDate:t.move_in_date,onSignedLeaseChange:e=>i("signed_lease",e),onLeaseSigningDateChange:e=>i("lease_signing_date",e),onMoveInDateChange:e=>i("move_in_date",e),errors:l}),o.jsx(J,{paidSecurityDeposit:t.paid_security_deposit_first_month_rent,scheduledPaidTime:t.scheduled_paid_time,onPaidSecurityDepositChange:e=>i("paid_security_deposit_first_month_rent",e),onScheduledPaidTimeChange:e=>i("scheduled_paid_time",e),errors:l}),o.jsx(Q,{handledKeys:t.handled_keys,moveInFormSentDate:t.move_in_form_sent_date,filledMoveInForm:t.filled_move_in_form,dateOfMoveInFormFilled:t.date_of_move_in_form_filled,onHandledKeysChange:e=>i("handled_keys",e),onMoveInFormSentDateChange:e=>i("move_in_form_sent_date",e),onFilledMoveInFormChange:e=>i("filled_move_in_form",e),onDateOfMoveInFormFilledChange:e=>i("date_of_move_in_form_filled",e),errors:l}),o.jsx(W,{submittedInsurance:t.submitted_insurance,dateOfInsuranceExpiration:t.date_of_insurance_expiration,onSubmittedInsuranceChange:e=>i("submitted_insurance",e),onDateOfInsuranceExpirationChange:e=>i("date_of_insurance_expiration",e),errors:l})]})}),o.jsx(q,{children:o.jsxs("div",{className:"flex w-full justify-end gap-2",children:[o.jsx(S,{type:"button",variant:"outline",onClick:K,children:"Cancel"}),o.jsx(S,{type:"submit",disabled:x,onClick:I,children:x?"Creating...":"Create Move-In Record"})]})})]})})})}export{ke as default};
