import{r as a,b as z,j as n}from"./app-mUrH0ynJ.js";import{B as P}from"./button-BFBNYzQ-.js";import{D as q,a as G,b as H}from"./drawer-B7FkQmZP.js";import{CityPropertyUnitSelector as J}from"./CityPropertyUnitSelector-vQsmbbe1.js";import{ApplicantInformationSection as K}from"./ApplicantInformationSection-ELbYdsrb.js";import{StatusAndDateSection as L}from"./StatusAndDateSection-CPp19IqC.js";import{AdditionalDetailsSection as M}from"./AdditionalDetailsSection-CknTuds7.js";import"./app-BxoA0TtB.js";import"./index-Co1yv0YL.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-CQgkcMAl.js";import"./index-CgzaaCP9.js";import"./index-Do303mGv.js";import"./index-D9BBn6e9.js";import"./index-bRwiAiPA.js";import"./index-kDRJ7vWo.js";import"./x-BVVw4O5L.js";import"./createLucideIcon-DUXn48BB.js";import"./label-DmNL2-zA.js";import"./select-NL-VGbzo.js";import"./index-Dc_FVRD7.js";import"./index-DK4fbPLM.js";import"./index-CXBw7cFo.js";import"./index-DEcWu7_s.js";import"./index-5IheD20q.js";import"./index-p6YNWFgp.js";import"./chevron-down-CcniYHCH.js";import"./check-nxBTAIc9.js";import"./chevron-up-Cls6AU_3.js";import"./input-Bo52L6_R.js";import"./calendar-DAc8iCNl.js";import"./format-PYUiRpxY.js";import"./chevron-left-Bx0Sy0a0.js";import"./chevron-right-o746ehSI.js";import"./popover-B07j7TfD.js";import"./radioGroup-DvkZrWpP.js";import"./calendar-e6qKYHCo.js";function wt({cities:D,properties:C,units:b,open:d,onOpenChange:v,onSuccess:A}){const l=a.useRef(null),[f,s]=a.useState({}),[x,g]=a.useState(null),[y,c]=a.useState(null),[N,u]=a.useState([]),[w,m]=a.useState([]),{data:r,setData:o,post:E,processing:h,errors:p,reset:S,clearErrors:_}=z({unit_id:null,name:"",co_signer:"",status:"New",date:"",stage_in_progress:"",notes:"",attachment:null});a.useEffect(()=>{d||(S(),_(),s({}),g(null),c(null),u([]),m([]),l.current&&(l.current.value=""))},[d]);const U=e=>{const t=parseInt(e);g(t),c(null),o("unit_id",null),s(i=>({...i,city:void 0,property:void 0,unit:void 0})),C[t]?u(C[t]):u([]),m([])},R=e=>{const t=parseInt(e);c(t),o("unit_id",null),s(i=>({...i,property:void 0,unit:void 0})),b[t]?m(b[t]):m([])},V=e=>{const t=parseInt(e);o("unit_id",t),s(i=>({...i,unit:void 0}))},k=e=>{o("name",e),s(t=>({...t,name:void 0}))},B=e=>{o("co_signer",e),s(t=>({...t,co_signer:void 0}))},F=e=>{o("status",e),s(t=>({...t,status:void 0}))},j=e=>{e.preventDefault(),s({});let t=!1;const i={};if(x||(i.city="Please select a city before submitting the form.",t=!0),y||(i.property="Please select a property before submitting the form.",t=!0),r.unit_id||(i.unit="Please select a unit before submitting the form.",t=!0),(!r.name||r.name.trim()==="")&&(i.name="Please enter a name before submitting the form.",t=!0),(!r.co_signer||r.co_signer.trim()==="")&&(i.co_signer="Please enter a co-signer before submitting the form.",t=!0),(!r.status||r.status.trim()==="")&&(i.status="Please select a status before submitting the form.",t=!0),t){s(i);return}E(route("applications.store"),{onSuccess:()=>{I(),A?.()}})},I=()=>{S(),_(),s({}),g(null),c(null),u([]),m([]),l.current&&(l.current.value=""),v(!1)};return n.jsx(q,{open:d,onOpenChange:v,modal:!1,children:n.jsx(G,{size:"half",title:"Create New Application",children:n.jsxs("div",{className:"flex h-full flex-col",children:[n.jsx("div",{className:"flex-1 overflow-auto p-6",children:n.jsxs("form",{onSubmit:j,className:"space-y-4",children:[n.jsx(J,{cities:D,selectedCityId:x,selectedPropertyId:y,availableProperties:N,availableUnits:w,unitId:r.unit_id,onCityChange:U,onPropertyChange:R,onUnitChange:V,errors:p,validationErrors:f}),n.jsx(K,{name:r.name,coSigner:r.co_signer,onNameChange:k,onCoSignerChange:B,errors:p,validationErrors:f}),n.jsx(L,{status:r.status,date:r.date,onStatusChange:F,onDateChange:e=>o("date",e),errors:p,validationErrors:f}),n.jsx(M,{stageInProgress:r.stage_in_progress,notes:r.notes,attachment:r.attachment,onStageInProgressChange:e=>o("stage_in_progress",e),onNotesChange:e=>o("notes",e),onAttachmentChange:e=>o("attachment",e),fileInputRef:l,errors:p})]})}),n.jsx(H,{children:n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx(P,{type:"button",variant:"outline",onClick:I,disabled:h,children:"Cancel"}),n.jsx(P,{type:"submit",onClick:j,disabled:h,children:h?"Creating...":"Create Application"})]})})]})})})}export{wt as default};
