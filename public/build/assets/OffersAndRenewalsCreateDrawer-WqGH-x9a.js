import{r as d,b as T,j as o,a as K}from"./app-BSOlzI_M.js";import{B as x}from"./button-D2rKFPK1.js";import{D as B,a as U,b as z}from"./drawer-B6ZRXvIZ.js";import F from"./CascadingSelectors-Duhtp6RI.js";import W from"./OfferInformationSection-WFkUOMLo.js";import q from"./AcceptanceSection-jcnCsI7-.js";import G from"./LeaseInformationSection-CeqOUCxV.js";import H from"./RenewalInformationSection-Cw6wDpbc.js";import J from"./AdditionalFieldsSection-BSs0EBqW.js";import M from"./DateOfDeclineSection-CUlAPuX_.js";import"./app-D9zByHv3.js";import"./index-ByB7CnZO.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-09CEhTtY.js";import"./index-BK07_5Wa.js";import"./index-C5g_kYK6.js";import"./index-DIXGfQsU.js";import"./index-BLt4aHaa.js";import"./index-Eh5rTZKr.js";import"./x-V2a7Zg3Q.js";import"./createLucideIcon-BGWKpKjb.js";import"./label-ku6Bo0xE.js";import"./popover-CKsI89_0.js";import"./index-C4PIvpnm.js";import"./command-CBR154ui.js";import"./search-BcNZ_u8M.js";import"./input-DWv8_Yxn.js";import"./chevrons-up-down-D-iRWSMZ.js";import"./check-BE4k6INO.js";import"./DatePickerField-C79Eyshh.js";import"./calendar-Di5dbzoO.js";import"./format-PYUiRpxY.js";import"./chevron-left-CVo-4b8C.js";import"./chevron-right-DU-yjHU5.js";import"./chevron-down--Oeingn_.js";import"./calendar-CthI5zTo.js";import"./RadioGroupField-CFJWPo8-.js";import"./radioGroup-DqEJ_5sj.js";import"./index-p7EaCzMM.js";import"./index-C4dPa-2_.js";function Pe({hierarchicalData:b,open:O,onOpenChange:h,onSuccess:j,currentFilters:_,perPage:D,page:v}){const f=d.useRef(null),p=d.useRef(null),m=d.useRef(null),u=d.useRef(null),[g,i]=d.useState({}),[r,w]=d.useState({date_sent_offer:!1,date_of_acceptance:!1,last_notice_sent:!1,date_sent_lease:!1,date_signed:!1,last_notice_sent_2:!1,date_of_decline:!1}),l=(e,n)=>{w(c=>({...c,[e]:n}))},{data:t,setData:a,processing:C,errors:s,reset:y}=T({tenant_id:"",city_id:"",property_id:"",unit_id:"",other_tenants:"",date_sent_offer:"",status:"",date_of_acceptance:"",last_notice_sent:"",notice_kind:"",lease_sent:"",date_sent_lease:"",lease_signed:"",date_signed:"",last_notice_sent_2:"",notice_kind_2:"",notes:"",date_of_decline:"",city_name:"",property_name:"",unit_name:"",tenant_name:"",per_page:"",page:1}),R=e=>{a({...t,city_id:e,property_id:"",unit_id:"",tenant_id:""}),i(n=>({...n,city:void 0}))},k=e=>{a({...t,property_id:e,unit_id:"",tenant_id:""}),i(n=>({...n,property:void 0}))},N=e=>{a({...t,unit_id:e,tenant_id:""}),i(n=>({...n,unit:void 0}))},I=e=>{a("tenant_id",e),i(n=>({...n,tenant:void 0}))},L=e=>{a("other_tenants",e)},V=e=>{a("date_sent_offer",e||""),i(n=>({...n,date_sent_offer:void 0}))},A=e=>{a("date_of_decline",e||"")},S=e=>{e.preventDefault(),i({});let n=!1;const c={};if((!t.city_id||t.city_id.trim()==="")&&(c.city="Please select a city before submitting the form.",f.current&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!t.property_id||t.property_id.trim()==="")&&(c.property="Please select a property before submitting the form.",p.current&&!n&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!t.unit_id||t.unit_id.trim()==="")&&(c.unit="Please select a unit before submitting the form.",m.current&&!n&&(m.current.focus(),m.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!t.tenant_id||t.tenant_id.trim()==="")&&(c.tenant="Please select a tenant before submitting the form.",u.current&&!n&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),n){i(c);return}const P={...t,city_name:_.city||"",property_name:_.property||"",unit_name:_.unit||"",tenant_name:_.tenant||"",per_page:String(D),page:v};K.post(route("offers_and_renewals.store"),P,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{y(),i({}),h(!1),j?.()}})},E=()=>{y(),i({}),h(!1)};return o.jsx(B,{open:O,onOpenChange:h,modal:!1,children:o.jsx(U,{size:"half",title:"Create New Offer/Renewal",children:o.jsxs("div",{className:"flex h-full flex-col",children:[o.jsx("div",{className:"flex-1 overflow-auto p-6",children:o.jsxs("form",{onSubmit:S,className:"space-y-4",children:[o.jsx(F,{hierarchicalData:b,cityId:t.city_id,propertyId:t.property_id,unitId:t.unit_id,tenantId:t.tenant_id,otherTenants:t.other_tenants,onCityChange:R,onPropertyChange:k,onUnitChange:N,onTenantChange:I,onOtherTenantsChange:L,errors:s,validationErrors:g,cityRef:f,propertyRef:p,unitRef:m,tenantRef:u}),o.jsx(W,{dateSentOffer:t.date_sent_offer,status:t.status,onDateSentOfferChange:V,onStatusChange:e=>a("status",e),errors:s,validationErrors:g,calendarOpen:r.date_sent_offer,onCalendarOpenChange:e=>l("date_sent_offer",e)}),t.status==="Didn't Accept"?o.jsx(M,{dateOfDecline:t.date_of_decline,onDateOfDeclineChange:A,errors:s,calendarOpen:r.date_of_decline,onCalendarOpenChange:e=>l("date_of_decline",e)}):o.jsxs(o.Fragment,{children:[o.jsx(q,{dateOfAcceptance:t.date_of_acceptance,lastNoticeSent:t.last_notice_sent,noticeKind:t.notice_kind,onDateOfAcceptanceChange:e=>a("date_of_acceptance",e||""),onLastNoticeSentChange:e=>a("last_notice_sent",e||""),onNoticeKindChange:e=>a("notice_kind",e),errors:s,calendarStates:{date_of_acceptance:r.date_of_acceptance,last_notice_sent:r.last_notice_sent},onCalendarOpenChange:l}),o.jsx(G,{leaseSent:t.lease_sent,dateSentLease:t.date_sent_lease,leaseSigned:t.lease_signed,dateSigned:t.date_signed,onLeaseSentChange:e=>a("lease_sent",e),onDateSentLeaseChange:e=>a("date_sent_lease",e||""),onLeaseSignedChange:e=>a("lease_signed",e),onDateSignedChange:e=>a("date_signed",e||""),errors:s,calendarStates:{date_sent_lease:r.date_sent_lease,date_signed:r.date_signed},onCalendarOpenChange:l}),o.jsx(H,{lastNoticeSent2:t.last_notice_sent_2,noticeKind2:t.notice_kind_2,onLastNoticeSent2Change:e=>a("last_notice_sent_2",e||""),onNoticeKind2Change:e=>a("notice_kind_2",e),errors:s,calendarOpen:r.last_notice_sent_2,onCalendarOpenChange:e=>l("last_notice_sent_2",e)}),o.jsx(J,{notes:t.notes,onNotesChange:e=>a("notes",e),errors:s})]})]})}),o.jsx(z,{children:o.jsxs("div",{className:"flex gap-2 justify-end",children:[o.jsx(x,{type:"button",variant:"outline",onClick:E,children:"Cancel"}),o.jsx(x,{type:"submit",onClick:S,disabled:C,children:C?"Creating...":"Create Offer/Renewal"})]})})]})})})}export{Pe as default};
