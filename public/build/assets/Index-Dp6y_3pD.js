import{r as _,j as e,H as A,L as j,b as y}from"./app-DnZTfT0_.js";import{u as E,A as $}from"./app-layout-NpEgK4_T.js";import{B as c}from"./app-logo-icon-Bc2eyx79.js";import{I as C}from"./input-DQ_wq_vv.js";import{C as D,a as L,b as U,c as T}from"./card-C4RmjogZ.js";import{P as B,T as P,a as M,b as k,c as s,d as R,e as a,f as v}from"./table-7_H-LZJM.js";import{B as l}from"./badge-CCSbDhbi.js";import{D as I}from"./download-DrHPYDYz.js";import{S as H}from"./search-D1fLgR4z.js";import{E as z}from"./eye-Cf9la-Va.js";import{S as V}from"./square-pen-qd8CnHV4.js";import"./app-8ZSuAH30.js";import"./index-CToc1y-v.js";import"./index-D6oF8zzd.js";const F=(n,h="move-outs.csv")=>{try{const i=r=>{if(!r)return"";try{return new Date(r).toLocaleDateString()}catch{return r||""}},o=r=>r==null?"":String(r).replace(/"/g,'""'),x=[["ID","Unit Name","Tenant Name","Move Out Date","Lease Status","Lease Ending on Buildium","Keys Location","Utilities Under Our Name","Date Utility Put Under Our Name","Walkthrough","Repairs","Send Back Security Deposit","Notes","Cleaning","List the Unit","Move Out Form"].join(","),...n.map(r=>{try{return[r.id||"",`"${o(r.units_name)}"`,`"${o(r.tenants_name)}"`,`"${i(r.move_out_date)}"`,`"${o(r.lease_status)}"`,`"${i(r.date_lease_ending_on_buildium)}"`,`"${o(r.keys_location)}"`,`"${o(r.utilities_under_our_name)}"`,`"${i(r.date_utility_put_under_our_name)}"`,`"${o(r.walkthrough)}"`,`"${o(r.repairs)}"`,`"${o(r.send_back_security_deposit)}"`,`"${o(r.notes)}"`,`"${o(r.cleaning)}"`,`"${o(r.list_the_unit)}"`,`"${o(r.move_out_form)}"`].join(",")}catch(m){return console.error("Error processing move-out row:",r,m),""}}).filter(r=>r!=="")].join(`
`),f=new Blob([x],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),u=URL.createObjectURL(f);return d.setAttribute("href",u),d.setAttribute("download",h),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(u),!0}catch(i){throw console.error("CSV Export Error:",i),i}};function ae({moveOuts:n,search:h}){const[i,o]=_.useState(h||""),[g,x]=_.useState(!1),f=t=>{t.preventDefault(),y.get(route("move-out.index"),{search:i},{preserveState:!0})},d=t=>{confirm("Are you sure you want to delete this move-out record?")&&y.delete(route("move-out.destroy",t.id))},u=()=>{if(!n||!n.data||n.data.length===0){alert("No data to export");return}x(!0);try{console.log("Exporting move-out data:",n.data);const t=`move-outs-${new Date().toISOString().split("T")[0]}.csv`;F(n.data,t),console.log("Export completed successfully")}catch(t){console.error("Export failed:",t),alert(`Export failed: ${t.message||"Unknown error"}. Please check the console for details.`)}finally{x(!1)}},r=t=>t===null?e.jsx(l,{variant:"outline",children:"N/A"}):e.jsx(l,{variant:t==="Yes"?"default":"secondary",className:t==="Yes"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",children:t}),m=t=>t===null?e.jsx(l,{variant:"outline",children:"N/A"}):e.jsx(l,{variant:t==="cleaned"?"default":"secondary",className:t==="cleaned"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",children:t}),S=t=>t===null?e.jsx(l,{variant:"outline",children:"N/A"}):e.jsx(l,{variant:t==="filled"?"default":"secondary",className:t==="filled"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",children:t}),p=t=>t?new Date(t).toLocaleDateString():"N/A",{hasPermission:N,hasAnyPermission:b,hasAllPermissions:w}=E();return e.jsxs($,{children:[e.jsx(A,{title:"Move-Out Management"}),e.jsx("div",{className:"py-12 bg-background text-foreground transition-colors min-h-screen",children:e.jsx("div",{className:"max-w-[100vw] mx-auto sm:px-6 lg:px-8",children:e.jsxs(D,{className:"bg-card text-card-foreground shadow-lg",children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(U,{className:"text-2xl",children:"Move-Out Management"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:u,disabled:g||!n?.data||n.data.length===0,className:"flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),g?"Exporting...":"Export CSV"]}),w(["move-out.create","move-out.store"])&&e.jsx(j,{href:route("move-out.create"),children:e.jsxs(c,{children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Move-Out Record"]})})]})]}),e.jsxs("form",{onSubmit:f,className:"flex gap-2 mt-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(C,{type:"text",placeholder:"Search by tenant name, unit, or status...",value:i,onChange:t=>o(t.target.value),className:"bg-input text-input-foreground"})}),e.jsx(c,{type:"submit",children:e.jsx(H,{className:"h-4 w-4"})})]})]}),e.jsxs(T,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(P,{children:[e.jsx(M,{children:e.jsxs(k,{className:"border-border",children:[e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Unit Name"}),e.jsx(s,{className:"min-w-[150px] text-muted-foreground",children:"Tenant Name"}),e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Move Out Date"}),e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Lease Status"}),e.jsx(s,{className:"min-w-[150px] text-muted-foreground",children:"Lease Ending on Buildium"}),e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Keys Location"}),e.jsx(s,{className:"min-w-[140px] text-muted-foreground",children:"Utilities Under Our Name"}),e.jsx(s,{className:"min-w-[160px] text-muted-foreground",children:"Date Utility Put Under Our Name"}),e.jsx(s,{className:"min-w-[150px] text-muted-foreground",children:"Walkthrough"}),e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Repairs"}),e.jsx(s,{className:"min-w-[160px] text-muted-foreground",children:"Send Back Security Deposit"}),e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Notes"}),e.jsx(s,{className:"min-w-[100px] text-muted-foreground",children:"Cleaning"}),e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"List the Unit"}),e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Move Out Form"}),b(["move-out.show","move-out.edit","move-out.update","move-out.destroy"])&&e.jsx(s,{className:"min-w-[120px] text-muted-foreground",children:"Actions"})]})}),e.jsx(R,{children:n.data.map(t=>e.jsxs(k,{className:"hover:bg-muted/50 border-border",children:[e.jsx(a,{className:"text-foreground",children:t.units_name}),e.jsx(a,{className:"font-medium text-foreground",children:t.tenants_name}),e.jsx(a,{className:"text-foreground",children:p(t.move_out_date)}),e.jsx(a,{children:t.lease_status?e.jsx(l,{variant:"outline",children:t.lease_status}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(a,{className:"text-foreground",children:p(t.date_lease_ending_on_buildium)}),e.jsx(a,{className:"text-foreground",children:t.keys_location||e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(a,{children:r(t.utilities_under_our_name)}),e.jsx(a,{className:"text-foreground",children:p(t.date_utility_put_under_our_name)}),e.jsx(a,{className:"max-w-[150px] truncate text-foreground",children:t.walkthrough?e.jsx("span",{title:t.walkthrough,children:t.walkthrough.length>50?`${t.walkthrough.substring(0,50)}...`:t.walkthrough}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(a,{className:"max-w-[120px] truncate text-foreground",children:t.repairs?e.jsx("span",{title:t.repairs,children:t.repairs.length>30?`${t.repairs.substring(0,30)}...`:t.repairs}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(a,{className:"text-foreground",children:t.send_back_security_deposit||e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(a,{className:"max-w-[120px] truncate text-foreground",children:t.notes?e.jsx("span",{title:t.notes,children:t.notes.length>30?`${t.notes.substring(0,30)}...`:t.notes}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(a,{children:m(t.cleaning)}),e.jsx(a,{className:"text-foreground",children:t.list_the_unit||e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(a,{children:S(t.move_out_form)}),b(["move-out.show","move-out.edit","move-out.update","move-out.destroy"])&&e.jsx(a,{children:e.jsxs("div",{className:"flex gap-1",children:[N("move-out.show")&&e.jsx(j,{href:route("move-out.show",t.id),children:e.jsx(c,{variant:"outline",size:"sm",children:e.jsx(z,{className:"h-4 w-4"})})}),w(["move-out.edit","move-out.update"])&&e.jsx(j,{href:route("move-out.edit",t.id),children:e.jsx(c,{variant:"outline",size:"sm",children:e.jsx(V,{className:"h-4 w-4"})})}),N("move-out.destroy")&&e.jsx(c,{variant:"outline",size:"sm",onClick:()=>d(t),className:"text-destructive hover:text-destructive hover:bg-destructive/10 border-destructive/20",children:e.jsx(v,{className:"h-4 w-4"})})]})})]},t.id))})]})}),n.data.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-lg",children:"No move-out records found."}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search criteria."})]}),n.meta&&e.jsx("div",{className:"mt-6 flex justify-between items-center border-t border-border pt-4",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",n.meta.from||0," to ",n.meta.to||0," of ",n.meta.total||0," results"]})})]})]})})})]})}export{ae as default};
