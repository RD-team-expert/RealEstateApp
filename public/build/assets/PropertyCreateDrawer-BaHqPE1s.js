import{r as a,b as ie,j as e}from"./app-Dn1r5IbR.js";import{B as z}from"./button-DoJlCKhy.js";import{I as c}from"./input-DJHjvjS7.js";import{L as l}from"./label-CyLYjr_a.js";import{S as q,a as G,b as H,c as J,d as K}from"./select-BPfsX62k.js";import{D as oe,a as ne,b as le}from"./drawer-BbQvx4Pm.js";import{A as ce,a as me}from"./alert-CZnFpNJB.js";import{M as de}from"./map-pin-BM0InOIz.js";import{B as pe}from"./building-2-ST8PpcXf.js";import{C as ue}from"./circle-alert-tTPA0evf.js";import{S as fe}from"./shield-C-VNt_sk.js";import{D as xe}from"./dollar-sign-Ci_GX2V5.js";import{F as he}from"./file-text-goluWCNr.js";import{C as Q}from"./calendar-Xujg-VPa.js";import"./app-BmbQfT0_.js";import"./index-DF1-xgR-.js";import"./utils-CBfrqCZ4.js";import"./index-C5yiDUFi.js";import"./index-Dc_FVRD7.js";import"./index-rczzAiLR.js";import"./index-cId8iuZu.js";import"./index-qhuad6ry.js";import"./index-CGaG4LkD.js";import"./index-BHn9DcD9.js";import"./index-WPnjh8bd.js";import"./index-h5kqUyi-.js";import"./index-IWqIVFcu.js";import"./index-q0Alrdsu.js";import"./index-C0T19-Xq.js";import"./chevron-down-Bfpn-qjr.js";import"./createLucideIcon-ezkluWMI.js";import"./check-CZby3Z4H.js";import"./chevron-up-CyiongBQ.js";import"./index-C_Yr3VBI.js";import"./index-BV3nWfAJ.js";import"./x-BwrjvaMS.js";function Oe({open:h,onOpenChange:b,cities:U=[],availableProperties:S=[],onSuccess:V}){const[n,w]=a.useState(""),[I,j]=a.useState([]),[D,y]=a.useState(""),[P,_]=a.useState(""),[F,N]=a.useState(""),[R,v]=a.useState(""),[k,g]=a.useState(""),[A,C]=a.useState(""),m=a.useRef(null),d=a.useRef(null),p=a.useRef(null),u=a.useRef(null),f=a.useRef(null),x=a.useRef(null),W={property_id:0,insurance_company_name:"",amount:"",policy_number:"",effective_date:"",expiration_date:""},{data:t,setData:o,post:X,processing:B,errors:i,reset:Y,clearErrors:L}=ie(W);a.useEffect(()=>{if(n){const r=S.filter(s=>s.city_id===parseInt(n));j(r)}else j([]);o("property_id",0)},[n,S]),a.useEffect(()=>{h&&E()},[h]);const E=()=>{Y(),w(""),j([]),M(),L()},M=()=>{y(""),_(""),N(""),v(""),g(""),C("")},Z=r=>{o("property_id",parseInt(r)),y("")},$=r=>{o("insurance_company_name",r.target.value),_("")},O=r=>{o("amount",r.target.value),N("")},ee=r=>{o("policy_number",r.target.value),v("")},re=r=>{o("effective_date",r.target.value),g("")},te=r=>{o("expiration_date",r.target.value),C("")},T=r=>{r.preventDefault(),M();let s=!1;(!t.property_id||t.property_id===0)&&(y("Please select a property before submitting the form."),m.current&&(m.current.focus(),m.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.insurance_company_name||t.insurance_company_name.trim()==="")&&(_("Please enter an insurance company name before submitting the form."),d.current&&!s&&(d.current.focus(),d.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.amount||t.amount.trim()==="")&&(N("Please enter an amount before submitting the form."),p.current&&!s&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.policy_number||t.policy_number.trim()==="")&&(v("Please enter a policy number before submitting the form."),u.current&&!s&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.effective_date||t.effective_date.trim()==="")&&(g("Please select an effective date before submitting the form."),f.current&&!s&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.expiration_date||t.expiration_date.trim()==="")&&(C("Please select an expiration date before submitting the form."),x.current&&!s&&(x.current.focus(),x.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),!s&&X(route("properties-info.store"),{onSuccess:()=>{E(),b(!1),V&&V()},onError:()=>{}})},ae=()=>{E(),b(!1)},se=r=>{w(r),o("property_id",0),L()};return e.jsx(oe,{open:h,onOpenChange:b,modal:!1,children:e.jsx(ne,{size:"half",title:"Create New Property Insurance",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"city_select",className:"text-base font-semibold",children:[e.jsx(de,{className:"h-4 w-4 inline mr-1"}),"Select City"]})}),e.jsxs(q,{value:n,onValueChange:se,children:[e.jsx(G,{className:"w-full",children:e.jsx(H,{placeholder:"Choose a city..."})}),e.jsx(J,{children:U.map(r=>e.jsx(K,{value:r.id.toString(),children:r.city},r.id))})]})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"property_select",className:"text-base font-semibold",children:[e.jsx(pe,{className:"h-4 w-4 inline mr-1"}),"Select Property *"]})}),e.jsxs(q,{value:t.property_id&&t.property_id!==0?t.property_id.toString():"",onValueChange:Z,disabled:!n,children:[e.jsx(G,{className:"w-full",ref:m,children:e.jsx(H,{placeholder:n?"Choose a property...":"Select a city first..."})}),e.jsx(J,{children:I.map(r=>e.jsx(K,{value:r.id.toString(),children:r.property_name},r.id))})]}),i.property_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.property_id}),D&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:D}),n&&I.length===0&&e.jsxs(ce,{className:"mt-2",children:[e.jsx(ue,{className:"h-4 w-4"}),e.jsx(me,{children:"No properties found for the selected city."})]})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"insurance_company_name",className:"text-base font-semibold",children:[e.jsx(fe,{className:"h-4 w-4 inline mr-1"}),"Insurance Company *"]})}),e.jsx(c,{ref:d,id:"insurance_company_name",value:t.insurance_company_name,onChange:$,placeholder:"Enter insurance company name"}),i.insurance_company_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.insurance_company_name}),P&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:P})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"amount",className:"text-base font-semibold",children:[e.jsx(xe,{className:"h-4 w-4 inline mr-1"}),"Amount *"]})}),e.jsx(c,{ref:p,id:"amount",type:"number",step:"0.01",min:"0",value:t.amount,onChange:O,placeholder:"0.00"}),i.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.amount}),F&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:F})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"policy_number",className:"text-base font-semibold",children:[e.jsx(he,{className:"h-4 w-4 inline mr-1"}),"Policy Number *"]})}),e.jsx(c,{ref:u,id:"policy_number",value:t.policy_number,onChange:ee,placeholder:"Enter policy number"}),i.policy_number&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.policy_number}),R&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:R})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"effective_date",className:"text-base font-semibold",children:[e.jsx(Q,{className:"h-4 w-4 inline mr-1"}),"Effective Date *"]})}),e.jsx(c,{ref:f,id:"effective_date",type:"date",value:t.effective_date,onChange:re}),i.effective_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.effective_date}),k&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"expiration_date",className:"text-base font-semibold",children:[e.jsx(Q,{className:"h-4 w-4 inline mr-1"}),"Expiration Date *"]})}),e.jsx(c,{ref:x,id:"expiration_date",type:"date",value:t.expiration_date,onChange:te}),i.expiration_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.expiration_date}),A&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:A})]})]})]})}),e.jsxs(le,{className:"flex-row justify-end gap-2 border-t bg-muted/50 p-4",children:[e.jsx(z,{type:"button",variant:"outline",onClick:ae,children:"Cancel"}),e.jsx(z,{type:"submit",onClick:T,disabled:B,children:B?"Creating...":"Create Property"})]})]})})})}export{Oe as default};
