import{r as i,b as Y,j as e}from"./app-C79wt3tX.js";import{B as S}from"./createLucideIcon-C1z_f29J.js";import{P as Z,a as ee,f as B,p as z,b as te,C as se}from"./popover-EABh-nYt.js";import{D as re,a as ae,b as le}from"./drawer-wgoO6h1K.js";import{I as j}from"./input-BS89LrTW.js";import{L as c}from"./label-CArU7ATR.js";import{R as ne}from"./radioGroup-4V0hsG5D.js";import{S as P,a as w,b as I,c as F,d as R}from"./select-4_arDXlR.js";import{C as ie}from"./calendar-DZOiGQZc.js";import"./app-Do7cDRzv.js";import"./chevron-right-CkaRxpST.js";import"./index-DMpLQi-Z.js";import"./index-ChhieIKn.js";import"./index-DkjncacZ.js";import"./index-CkXl1I8e.js";import"./index-DLJGb8q0.js";import"./index-BUbw163t.js";function Se({cities:O,properties:D,units:A,open:v,onOpenChange:V,onSuccess:L}){const x=i.useRef(null),h=i.useRef(null),p=i.useRef(null),m=i.useRef(null),[n,o]=i.useState({}),[N,y]=i.useState(null),[C,f]=i.useState(null),[T,g]=i.useState([]),[$,u]=i.useState([]),[G,b]=i.useState(!1),{data:a,setData:d,post:W,processing:_,errors:r,reset:E,clearErrors:k}=Y({unit_id:null,name:"",co_signer:"",status:"New",date:"",stage_in_progress:"",notes:"",attachment:null});i.useEffect(()=>{v||(E(),k(),o({}),y(null),f(null),g([]),u([]),b(!1),m.current&&(m.current.value=""))},[v]);const q=t=>{const s=parseInt(t);y(s),f(null),d("unit_id",null),o(l=>({...l,city:void 0,property:void 0,unit:void 0})),D[s]?g(D[s]):g([]),u([])},H=t=>{const s=parseInt(t);f(s),d("unit_id",null),o(l=>({...l,property:void 0,unit:void 0})),A[s]?u(A[s]):u([])},J=t=>{const s=parseInt(t);d("unit_id",s),o(l=>({...l,unit:void 0}))},K=t=>{d("name",t),o(s=>({...s,name:void 0}))},Q=t=>{d("co_signer",t),o(s=>({...s,co_signer:void 0}))},X=t=>{d("status",t),o(s=>({...s,status:void 0}))},M=t=>{t.preventDefault(),o({});let s=!1;const l={};if(N||(l.city="Please select a city before submitting the form.",x.current&&(x.current.focus(),x.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),C||(l.property="Please select a property before submitting the form.",!s&&h.current&&(h.current.focus(),h.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),a.unit_id||(l.unit="Please select a unit before submitting the form.",!s&&p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!a.name||a.name.trim()==="")&&(l.name="Please enter a name before submitting the form.",s=!0),(!a.co_signer||a.co_signer.trim()==="")&&(l.co_signer="Please enter a co-signer before submitting the form.",s=!0),(!a.status||a.status.trim()==="")&&(l.status="Please select a status before submitting the form.",s=!0),s){o(l);return}W(route("applications.store"),{onSuccess:()=>{U(),L?.()}})},U=()=>{E(),k(),o({}),y(null),f(null),g([]),u([]),b(!1),m.current&&(m.current.value=""),V(!1)};return e.jsx(re,{open:v,onOpenChange:V,modal:!1,children:e.jsx(ae,{size:"half",title:"Create New Application",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"city",className:"text-base font-semibold",children:"City *"})}),e.jsxs(P,{onValueChange:q,value:N?.toString()||"",children:[e.jsx(w,{ref:x,children:e.jsx(I,{placeholder:"Select city"})}),e.jsx(F,{children:O?.map(t=>e.jsx(R,{value:t.id.toString(),children:t.name},t.id))||[]})]}),r.unit_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.unit_id}),n.city&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.city})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"property",className:"text-base font-semibold",children:"Property *"})}),e.jsxs(P,{onValueChange:H,value:C?.toString()||"",disabled:!N,children:[e.jsx(w,{ref:h,children:e.jsx(I,{placeholder:"Select property"})}),e.jsx(F,{children:T?.map(t=>e.jsx(R,{value:t.id.toString(),children:t.name},t.id))||[]})]}),r.unit_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.unit_id}),n.property&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.property})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-purple-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"unit",className:"text-base font-semibold",children:"Unit *"})}),e.jsxs(P,{onValueChange:J,value:a.unit_id?.toString()||"",disabled:!C,children:[e.jsx(w,{ref:p,children:e.jsx(I,{placeholder:"Select unit"})}),e.jsx(F,{children:$?.map(t=>e.jsx(R,{value:t.id.toString(),children:t.name},t.id))||[]})]}),r.unit_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.unit_id}),n.unit&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.unit})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"name",className:"text-base font-semibold",children:"Name *"})}),e.jsx(j,{id:"name",value:a.name,onChange:t=>K(t.target.value),placeholder:"Enter applicant name"}),r.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.name}),n.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.name})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"co_signer",className:"text-base font-semibold",children:"Co-signer *"})}),e.jsx(j,{id:"co_signer",value:a.co_signer,onChange:t=>Q(t.target.value),placeholder:"Enter co-signer name"}),r.co_signer&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.co_signer}),n.co_signer&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.co_signer})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"status",className:"text-base font-semibold",children:"Status *"})}),e.jsx(ne,{value:a.status,onValueChange:X,name:"status",options:[{value:"New",label:"New"},{value:"Approved",label:"Approved"},{value:"Undecided",label:"Undecided"},{value:"Rejected",label:"Rejected"},{value:"Pending",label:"Pending"}]}),r.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.status}),n.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.status})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"date",className:"text-base font-semibold",children:"Date"})}),e.jsxs(Z,{open:G,onOpenChange:b,modal:!1,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(S,{variant:"outline",className:`w-full justify-start text-left font-normal ${!a.date&&"text-muted-foreground"}`,children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),a.date?B(z(a.date,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(te,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(se,{mode:"single",selected:a.date?z(a.date,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(d("date",B(t,"yyyy-MM-dd")),b(!1))},initialFocus:!0})})]}),r.date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.date})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"stage_in_progress",className:"text-base font-semibold",children:"Stage in Progress"})}),e.jsx(j,{id:"stage_in_progress",value:a.stage_in_progress,onChange:t=>d("stage_in_progress",t.target.value),placeholder:"e.g., Document Review, Background Check, etc."}),r.stage_in_progress&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.stage_in_progress})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-red-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"notes",className:"text-base font-semibold",children:"Notes"})}),e.jsx("textarea",{id:"notes",className:"resize-vertical min-h-[100px] w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none",value:a.notes,onChange:t=>d("notes",t.target.value),placeholder:"Add any additional notes...",rows:4}),r.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.notes})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-yellow-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(c,{htmlFor:"attachment",className:"text-base font-semibold",children:"Attachment"})}),e.jsx(j,{id:"attachment",type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:t=>d("attachment",t.target.files?.[0]||null),ref:m,className:"cursor-pointer file:cursor-pointer file:border-0 file:bg-transparent file:text-sm file:font-medium"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Accepted formats: PDF, Word documents, and images (max 10MB)"}),r.attachment&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.attachment})]})]})}),e.jsx(le,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{type:"button",variant:"outline",onClick:U,disabled:_,children:"Cancel"}),e.jsx(S,{type:"submit",onClick:M,disabled:_,children:_?"Creating...":"Create Application"})]})})]})})})}export{Se as default};
