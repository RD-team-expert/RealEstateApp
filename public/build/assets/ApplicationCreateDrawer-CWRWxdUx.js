import{r as s,b as q,j as r}from"./app-p7g_f0wo.js";import{B as A}from"./button-CgWb-OwV.js";import{D as G,a as H,b as J}from"./drawer-BG8f08dK.js";import{CityPropertyUnitSelector as K}from"./CityPropertyUnitSelector-DLfFpd5U.js";import{ApplicantInformationSection as L}from"./ApplicantInformationSection-DEctrwQJ.js";import{StatusAndDateSection as M}from"./StatusAndDateSection-C6NCGzAd.js";import{AdditionalDetailsSection as Q}from"./AdditionalDetailsSection-u6bJDL28.js";import"./app-D9ss4c-j.js";import"./index-6lgmZUbB.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-C9RY0Fne.js";import"./index-H5dANVBP.js";import"./index-DkhO7hde.js";import"./index-soOnB7Xl.js";import"./index-CiElmmUH.js";import"./index-DqXNBRMy.js";import"./x-CLgUf5rt.js";import"./createLucideIcon-DCkjgf37.js";import"./label-DYy2JzQ2.js";import"./select-CfH1ySLB.js";import"./index-Dc_FVRD7.js";import"./index-BxQHv4UU.js";import"./index-DBAs5r5h.js";import"./index-DbQ0MNsB.js";import"./index-BFObTlUk.js";import"./index-BAfRhOcu.js";import"./chevron-down-QjJMMFQo.js";import"./check-Cfkty5Qk.js";import"./chevron-up-DNYJO-3s.js";import"./input-DiaYLKYe.js";import"./application-CnwOiERd.js";import"./calendar-BbyHMKLt.js";import"./format-PYUiRpxY.js";import"./chevron-left-DEQB7mOe.js";import"./chevron-right-DVrPLLPg.js";import"./popover-B4-HGuiv.js";import"./radioGroup-Dy3ozKpR.js";import"./calendar-C5PdxC03.js";import"./file-text-CmxpgnvI.js";function Ut({cities:P,properties:C,units:b,open:d,onOpenChange:v,onSuccess:D}){const l=s.useRef(null),[f,o]=s.useState({}),[x,h]=s.useState(null),[y,m]=s.useState(null),[N,c]=s.useState([]),[w,p]=s.useState([]),{data:i,setData:n,post:E,processing:g,errors:u,reset:_,clearErrors:S}=q({unit_id:null,name:"",co_signer:"",status:"New",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]});s.useEffect(()=>{d||(_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""))},[d]);const F=t=>{const e=parseInt(t);h(e),m(null),n("unit_id",null),o(a=>({...a,city:void 0,property:void 0,unit:void 0})),C[e]?c(C[e]):c([]),p([])},U=t=>{const e=parseInt(t);m(e),n("unit_id",null),o(a=>({...a,property:void 0,unit:void 0})),b[e]?p(b[e]):p([])},R=t=>{const e=parseInt(t);n("unit_id",e),o(a=>({...a,unit:void 0}))},V=t=>{n("name",t),o(e=>({...e,name:void 0}))},k=t=>{n("co_signer",t)},B=t=>{n("applicant_applied_from",t)},z=t=>{n("status",t),o(e=>({...e,status:void 0}))},j=t=>{t.preventDefault(),o({});let e=!1;const a={};if(x||(a.city="Please select a city before submitting the form.",e=!0),y||(a.property="Please select a property before submitting the form.",e=!0),i.unit_id||(a.unit="Please select a unit before submitting the form.",e=!0),(!i.name||i.name.trim()==="")&&(a.name="Please enter a name before submitting the form.",e=!0),(!i.status||i.status.trim()==="")&&(a.status="Please select a status before submitting the form.",e=!0),e){o(a);return}E(route("applications.store"),{onSuccess:()=>{I(),D?.()}})},I=()=>{_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""),v(!1)};return r.jsx(G,{open:d,onOpenChange:v,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Application",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:j,className:"space-y-4",children:[r.jsx(K,{cities:P,selectedCityId:x,selectedPropertyId:y,availableProperties:N,availableUnits:w,unitId:i.unit_id,onCityChange:F,onPropertyChange:U,onUnitChange:R,errors:u,validationErrors:f}),r.jsx(L,{name:i.name,coSigner:i.co_signer,applicantAppliedFrom:i.applicant_applied_from,onNameChange:V,onCoSignerChange:k,onApplicantAppliedFromChange:B,errors:u,validationErrors:f}),r.jsx(M,{status:i.status,date:i.date,onStatusChange:z,onDateChange:t=>n("date",t),errors:u,validationErrors:f}),r.jsx(Q,{stageInProgress:i.stage_in_progress,notes:i.notes,attachments:i.attachments,onStageInProgressChange:t=>n("stage_in_progress",t),onNotesChange:t=>n("notes",t),onAttachmentsChange:t=>n("attachments",t),fileInputRef:l,errors:u})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(A,{type:"button",variant:"outline",onClick:I,disabled:g,children:"Cancel"}),r.jsx(A,{type:"submit",onClick:j,disabled:g,children:g?"Creating...":"Create Application"})]})})]})})})}export{Ut as default};
