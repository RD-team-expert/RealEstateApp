import{r as o,b as Y,j as t}from"./app-XlMZG7vD.js";import{B as k}from"./button-D56PIbu9.js";import{D as q,a as F,b as G}from"./drawer-B7-2XtV2.js";import J from"./LocationSection-DQKk4Gcp.js";import K from"./PersonalInfoSection-BXMIDfcR.js";import O from"./ContactInfoSection-Drr_OMGM.js";import Q from"./PreferencesSection-C0PetkSt.js";import W from"./AssistanceSection-BLUUJTPl.js";import"./app-D9zByHv3.js";import"./index-D09_T-bu.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-CUT4GDty.js";import"./index-C_K36Fy_.js";import"./index-BoN4SSkO.js";import"./index-pZGqFUGS.js";import"./index-DqP218B8.js";import"./index-D2DcuX69.js";import"./x-B-P-7DDz.js";import"./createLucideIcon-BneQKrth.js";import"./label-BKN3erGN.js";import"./popover-DR8Y8CsW.js";import"./index-CTF06pqo.js";import"./command-DGwO2Uw9.js";import"./search-BKBHV1D6.js";import"./chevrons-up-down-CmSv9Nzf.js";import"./check-ZO7ekD6P.js";import"./input-nhBJFe9F.js";import"./radioGroup-DrlpglLG.js";import"./index-D8BBDizX.js";import"./index-DdpYxxi8.js";function Ne({tenant:s,cities:A,properties:_,unitsByProperty:c,open:N,onOpenChange:C,onSuccess:P,currentFilters:h,page:I,perPage:w}){const p=o.useRef(null),u=o.useRef(null),[D,m]=o.useState(""),[U,n]=o.useState(""),[V,d]=o.useState([]),[R,y]=o.useState([]),[b,f]=o.useState(""),{data:i,setData:a,put:L,processing:S,errors:l,transform:H}=Y({unit_id:s.unit_id?.toString()??"",first_name:s.first_name??"",last_name:s.last_name??"",street_address_line:s.street_address_line??"",login_email:s.login_email??"",alternate_email:s.alternate_email??"",mobile:s.mobile??"",emergency_phone:s.emergency_phone??"",cash_or_check:s.cash_or_check??"",has_insurance:s.has_insurance??"",sensitive_communication:s.sensitive_communication??"",has_assistance:s.has_assistance??"",assistance_amount:s.assistance_amount?.toString()??"",assistance_company:s.assistance_company??""}),x=()=>s.property_name?_.find(r=>r.property_name===s.property_name)?.city_id?.toString()??"":"",[g,j]=o.useState(x());o.useEffect(()=>{if(g){const e=_.filter(r=>r.city_id?.toString()===g);y(e)}s.property_name&&(f(s.property_name),c[s.property_name]&&d(c[s.property_name]))},[g,s.property_name,_,c]);const T=e=>{if(j(e),f(""),a("unit_id",""),m(""),n(""),e){const r=_.filter(v=>v.city_id?.toString()===e);y(r)}else y([]);d([])},$=e=>{f(e),a("unit_id",""),m(""),n(""),e&&c&&c[e]?d(c[e]):d([])},z=e=>{a("unit_id",e),n("")},E=e=>{e.preventDefault(),m(""),n("");let r=!1;(!b||b.trim()==="")&&(m("Please select a property before submitting the form."),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.unit_id||i.unit_id.trim()==="")&&(n("Please select a unit before submitting the form."),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),!r&&(H(v=>({...v,search:h?.search??"",city:h?.city??"",property:h?.property??"",unit_name:h?.unitName??"",perPage:w??15,page:I??1})),L(route("tenants.update",s.id),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{m(""),n(""),C(!1),P?.()}}))},M=()=>{a({unit_id:s.unit_id?.toString()??"",first_name:s.first_name??"",last_name:s.last_name??"",street_address_line:s.street_address_line??"",login_email:s.login_email??"",alternate_email:s.alternate_email??"",mobile:s.mobile??"",emergency_phone:s.emergency_phone??"",cash_or_check:s.cash_or_check??"",has_insurance:s.has_insurance??"",sensitive_communication:s.sensitive_communication??"",has_assistance:s.has_assistance??"",assistance_amount:s.assistance_amount?.toString()??"",assistance_company:s.assistance_company??""}),m(""),n(""),j(x()),f(s.property_name??""),C(!1)};return t.jsx(q,{open:N,onOpenChange:C,modal:!1,children:t.jsx(F,{size:"half",title:`Edit ${s.first_name} ${s.last_name}`,children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.jsxs("form",{onSubmit:E,className:"space-y-4",children:[t.jsx(J,{cities:A,selectedCityId:g,onCityChange:T,availableProperties:R,selectedPropertyName:b,onPropertyChange:$,propertyNameRef:p,validationError:D,availableUnits:V,unitId:i.unit_id,onUnitChange:z,unitNumberRef:u,unitValidationError:U,errors:l}),t.jsx(K,{firstName:i.first_name,lastName:i.last_name,streetAddress:i.street_address_line,onFirstNameChange:e=>a("first_name",e),onLastNameChange:e=>a("last_name",e),onStreetAddressChange:e=>a("street_address_line",e),errors:l}),t.jsx(O,{loginEmail:i.login_email,alternateEmail:i.alternate_email,mobile:i.mobile,emergencyPhone:i.emergency_phone,onLoginEmailChange:e=>a("login_email",e),onAlternateEmailChange:e=>a("alternate_email",e),onMobileChange:e=>a("mobile",e),onEmergencyPhoneChange:e=>a("emergency_phone",e),errors:l}),t.jsx(Q,{cashOrCheck:i.cash_or_check,hasInsurance:i.has_insurance,sensitiveCommunication:i.sensitive_communication,hasAssistance:i.has_assistance,onCashOrCheckChange:e=>a("cash_or_check",e),onHasInsuranceChange:e=>a("has_insurance",e),onSensitiveCommunicationChange:e=>a("sensitive_communication",e),onHasAssistanceChange:e=>a("has_assistance",e),errors:l}),i.has_assistance==="Yes"&&t.jsx(W,{assistanceAmount:i.assistance_amount,assistanceCompany:i.assistance_company,onAssistanceAmountChange:e=>a("assistance_amount",e),onAssistanceCompanyChange:e=>a("assistance_company",e),errors:l})]})}),t.jsx(G,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(k,{onClick:E,disabled:S,className:"flex-1",children:S?"Updating...":"Update Tenant"}),t.jsx(k,{variant:"outline",onClick:M,disabled:S,children:"Cancel"})]})})]})})})}export{Ne as default};
