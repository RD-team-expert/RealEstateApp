import{r as n,b as L,j as e}from"./app-CHDKARjb.js";import{D as q,a as B,b as G}from"./drawer-DBQSSrTa.js";import{B as w}from"./button-DVMLQ4Cf.js";import H from"./LocationSection-C9funQqo.js";import J from"./DateFieldsSection-DgHBkC3X.js";import K from"./PropertyDetailsSection-Udv_SJ3j.js";import Q from"./StatusFieldsSection-a-Z-Vul0.js";import"./app-BmbQfT0_.js";import"./index-DH5c0sFq.js";import"./index-Dc_FVRD7.js";import"./index-DzrNkgKa.js";import"./index-BMM8wKPv.js";import"./index-DhGOy-yS.js";import"./index-Bc-3DsyS.js";import"./index-DzT3tnb6.js";import"./index-q1apwmMP.js";import"./index-0tk3grE1.js";import"./index-DfGTd3cq.js";import"./utils-CBfrqCZ4.js";import"./x-DzxxLS5y.js";import"./createLucideIcon-C7c1hvIj.js";import"./FormField-1M8HPfB5.js";import"./label-DcQ_-sMZ.js";import"./SelectField-CnFUzdN9.js";import"./select-DSkJK3rS.js";import"./index-DiN52TcP.js";import"./index-DUM9UyY6.js";import"./index-CwBu8RV2.js";import"./index-qPHptkmt.js";import"./index-vBQwvlXi.js";import"./chevron-down-qX4-vl1q.js";import"./check-Ck6Rqaxz.js";import"./chevron-up-DiltP7zF.js";import"./TextInputField-5ZYHa3NK.js";import"./input-CESuFFYh.js";import"./DatePickerField-CPoSIVDw.js";import"./popover-CqkGk1d9.js";import"./format-PYUiRpxY.js";import"./chevron-right-CzDW8WF4.js";import"./calendar-DnRZTeuR.js";import"./TextAreaField-BHlBTLVt.js";import"./textarea-C_pOFbjp.js";import"./RadioGroupField-DigzCI3b.js";import"./radioGroup-DeMlaPSu.js";function Ot({cities:N,propertiesByCityId:h,unitsByPropertyId:y,open:P,onOpenChange:b,onSuccess:R}){const l=n.useRef(null),u=n.useRef(null),c=n.useRef(null),[k,i]=n.useState({city:"",property:"",unit:""}),[C,g]=n.useState(null),[x,f]=n.useState(null),[v,m]=n.useState(null),[I,_]=n.useState([]),[E,p]=n.useState([]),[U,V]=n.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:a,setData:s,post:F,processing:S,errors:d,reset:M}=L({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",move_out_form:"",utility_type:""}),T=r=>{const t=parseInt(r);g(t),f(null),m(null),s("unit_id",null),i(o=>({...o,city:"",property:"",unit:""})),t&&h[t]?_(h[t]):_([]),p([])},A=r=>{const t=parseInt(r);f(t),m(null),s("unit_id",null),i(o=>({...o,property:"",unit:""})),t&&y[t]?p(y[t]):p([])},O=r=>{const t=parseInt(r);m(t),s("unit_id",t),i(o=>({...o,unit:""}))},z=r=>{V(t=>({...t,[r]:!t[r]}))},j=r=>{r.preventDefault(),i({city:"",property:"",unit:""});let t=!1;C||(i(o=>({...o,city:"Please select a city before submitting the form."})),l.current&&(l.current.focus(),l.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),x||(i(o=>({...o,property:"Please select a property before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),(!v||!a.unit_id)&&(i(o=>({...o,unit:"Please select a unit before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),!t&&F(route("move-out.store"),{onSuccess:()=>{D(),R?.()}})},D=()=>{M(),g(null),f(null),m(null),i({city:"",property:"",unit:""}),_([]),p([]),b(!1)};return e.jsx(q,{open:P,onOpenChange:b,modal:!1,children:e.jsx(B,{size:"half",title:"Create New Move-Out Record",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx(H,{cities:N,availableProperties:I,availableUnits:E,selectedCity:C,selectedProperty:x,selectedUnit:v,validationErrors:k,cityRef:l,propertyRef:u,unitRef:c,onCityChange:T,onPropertyChange:A,onUnitChange:O,tenants:a.tenants,tenantsError:d.tenants,onTenantsChange:r=>s("tenants",r)}),e.jsx(J,{data:a,errors:d,calendarStates:U,onCalendarToggle:z,onDataChange:s}),e.jsx(K,{data:a,errors:d,onDataChange:s}),e.jsx(Q,{data:a,errors:d,onDataChange:s})]})}),e.jsx(G,{children:e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(w,{type:"button",variant:"outline",onClick:D,className:"flex-1",children:"Cancel"}),e.jsx(w,{type:"submit",onClick:j,disabled:S,className:"flex-1",children:S?"Creating...":"Create Move-Out Record"})]})})]})})})}export{Ot as default};
