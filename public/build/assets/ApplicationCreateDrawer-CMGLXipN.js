import{r as s,b as q,j as r}from"./app-BBH7zvDr.js";import{B as A}from"./button-kQLvnJYc.js";import{D as G,a as H,b as J}from"./drawer-vn5In2pd.js";import{CityPropertyUnitSelector as K}from"./CityPropertyUnitSelector-CyP2Kqb_.js";import{ApplicantInformationSection as L}from"./ApplicantInformationSection-CvDnFhwG.js";import{StatusAndDateSection as M}from"./StatusAndDateSection-CanjhKST.js";import{AdditionalDetailsSection as Q}from"./AdditionalDetailsSection-DRh_qzvi.js";import"./app-B1OP9MFD.js";import"./index-B4JvrASg.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-CKW8D5J0.js";import"./index-BWJ0fZlj.js";import"./index-df1YLpcl.js";import"./index-wsGo_tiU.js";import"./index-LvlgiWdi.js";import"./index-D7NAAONM.js";import"./x-CW_SbUiO.js";import"./createLucideIcon-7kSuh4z9.js";import"./label-DwnzeD4h.js";import"./select-IIwc6umI.js";import"./index-Dc_FVRD7.js";import"./index-Uin3X5ek.js";import"./index-CnOa-MOf.js";import"./index-5ce13En_.js";import"./index-SVWUaHiW.js";import"./chevron-down-DZk5AEb3.js";import"./check-Xlj0_DVN.js";import"./chevron-up-eAQBr70u.js";import"./input-BCr8ZI70.js";import"./application-CnwOiERd.js";import"./calendar-FSzcnI0c.js";import"./format-PYUiRpxY.js";import"./chevron-left-BaC6T1ID.js";import"./chevron-right-pfan_4Jt.js";import"./popover-BEQRNvy0.js";import"./radioGroup-HWuSDrOX.js";import"./calendar-BfOPHJgp.js";import"./file-text-BtoeH6mv.js";function Ft({cities:P,properties:C,units:b,open:d,onOpenChange:v,onSuccess:D}){const l=s.useRef(null),[f,o]=s.useState({}),[x,h]=s.useState(null),[y,m]=s.useState(null),[N,c]=s.useState([]),[w,p]=s.useState([]),{data:i,setData:n,post:E,processing:g,errors:u,reset:_,clearErrors:S}=q({unit_id:null,name:"",co_signer:"",status:"New",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]});s.useEffect(()=>{d||(_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""))},[d]);const F=t=>{const e=parseInt(t);h(e),m(null),n("unit_id",null),o(a=>({...a,city:void 0,property:void 0,unit:void 0})),C[e]?c(C[e]):c([]),p([])},U=t=>{const e=parseInt(t);m(e),n("unit_id",null),o(a=>({...a,property:void 0,unit:void 0})),b[e]?p(b[e]):p([])},R=t=>{const e=parseInt(t);n("unit_id",e),o(a=>({...a,unit:void 0}))},V=t=>{n("name",t),o(e=>({...e,name:void 0}))},k=t=>{n("co_signer",t)},B=t=>{n("applicant_applied_from",t)},z=t=>{n("status",t),o(e=>({...e,status:void 0}))},j=t=>{t.preventDefault(),o({});let e=!1;const a={};if(x||(a.city="Please select a city before submitting the form.",e=!0),y||(a.property="Please select a property before submitting the form.",e=!0),i.unit_id||(a.unit="Please select a unit before submitting the form.",e=!0),(!i.name||i.name.trim()==="")&&(a.name="Please enter a name before submitting the form.",e=!0),(!i.status||i.status.trim()==="")&&(a.status="Please select a status before submitting the form.",e=!0),e){o(a);return}E(route("applications.store"),{onSuccess:()=>{I(),D?.()}})},I=()=>{_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""),v(!1)};return r.jsx(G,{open:d,onOpenChange:v,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Application",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:j,className:"space-y-4",children:[r.jsx(K,{cities:P,selectedCityId:x,selectedPropertyId:y,availableProperties:N,availableUnits:w,unitId:i.unit_id,onCityChange:F,onPropertyChange:U,onUnitChange:R,errors:u,validationErrors:f}),r.jsx(L,{name:i.name,coSigner:i.co_signer,applicantAppliedFrom:i.applicant_applied_from,onNameChange:V,onCoSignerChange:k,onApplicantAppliedFromChange:B,errors:u,validationErrors:f}),r.jsx(M,{status:i.status,date:i.date,onStatusChange:z,onDateChange:t=>n("date",t),errors:u,validationErrors:f}),r.jsx(Q,{stageInProgress:i.stage_in_progress,notes:i.notes,attachments:i.attachments,onStageInProgressChange:t=>n("stage_in_progress",t),onNotesChange:t=>n("notes",t),onAttachmentsChange:t=>n("attachments",t),fileInputRef:l,errors:u})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(A,{type:"button",variant:"outline",onClick:I,disabled:g,children:"Cancel"}),r.jsx(A,{type:"submit",onClick:j,disabled:g,children:g?"Creating...":"Create Application"})]})})]})})})}export{Ft as default};
