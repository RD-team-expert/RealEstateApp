import{r as o,j as e,H as K,a as p}from"./app-DYme-6ST.js";import{A as M}from"./app-layout-H-O_MzQ8.js";import{u as Q}from"./usePermissions-Bu-R0dRn.js";import W from"./PageHeader-BOwGZQvv.js";import X from"./FilterSection-DpCQF-7z.js";import Y from"./PaymentsTable-DjYQSyiB.js";import Z from"./PaginationInfo-6xVD6NOF.js";import B from"./EmptyState-BcpsVpqA.js";import tt from"./PaymentCreateDrawer-B48NQOcg.js";import et from"./PaymentEditDrawer-Cwd8fvpu.js";import{e as rt}from"./PaymentRow-gacvKiaB.js";import"./app-BxoA0TtB.js";import"./index-DAeyJQLn.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./button-DygVteL_.js";import"./index-BPUi24BT.js";import"./index-yvkaECEW.js";import"./index-B3RZid5o.js";import"./index-wTYJRjsu.js";import"./index-Dt2fvjT8.js";import"./index-DRjsfxtL.js";import"./x-xoZkVJyy.js";import"./createLucideIcon-Dwp8kkct.js";import"./index-Dc_FVRD7.js";import"./index-DZXKY85H.js";import"./index-x8Nhs1r4.js";import"./index-DYyhglSa.js";import"./index-B8KHhnfk.js";import"./collapsible-B7rfYKib.js";import"./chevron-right-BQBVxicn.js";import"./index-D6kz9xqy.js";import"./log-out-DTdRteS0.js";import"./chevrons-up-down-BXcz4LdZ.js";import"./app-logo-icon-BPuxn_c6.js";import"./house-DY7ohgBE.js";import"./building-AISeR_4Y.js";import"./users-Ep7o_MFV.js";import"./wrench-CsLNcSZb.js";import"./credit-card-BHCQ6mCU.js";import"./dollar-sign-DvWrdgg7.js";import"./file-text-B7N_rIF4.js";import"./triangle-alert-CPVH4lkN.js";import"./bell-CZGLRIZC.js";import"./card-CWWVdt52.js";import"./download-DZI0PhHC.js";import"./plus-CCWmusQ4.js";import"./FilterDropdown-60DSTyC-.js";import"./input-pR7fOcUW.js";import"./chevron-down-CDnjTFxC.js";import"./StatusFilter-DXsXQTqF.js";import"./PermanentFilter-ljef987g.js";import"./HiddenFilter-B4_LR0rM.js";import"./eye-aSD_-4Al.js";import"./eye-off-Bl5sx1ki.js";import"./search-1yu5M8Yr.js";import"./table-NBJhLnC1.js";import"./drawer-BC2XqbDZ.js";import"./DateField-DKnAVdwU.js";import"./calendar-BWK2M4JP.js";import"./format-PYUiRpxY.js";import"./chevron-left-C0SnhLPd.js";import"./label-Cs5jgoI2.js";import"./popover-iS5_0AtM.js";import"./calendar-Bw6k_ssZ.js";import"./CityField-Bt_yvwVA.js";import"./select-CPtJWUF5.js";import"./index-CadWMiU4.js";import"./check-B5KXzRGR.js";import"./chevron-up-3w0W2Y4A.js";import"./PropertyField-1azfVCMN.js";import"./UnitField-B7vLPrcd.js";import"./FinancialFields-Y74MFPwD.js";import"./AssistanceFields-aC_WMIOh.js";import"./checkbox-DnglLfek.js";import"./PermanentField-DqZQvklt.js";import"./radioGroup-F0AlgpLY.js";import"./HiddenField-6LLYIIZf.js";import"./ReversedPaymentsField-CYBoS0zS.js";import"./NotesField-BtyLez79.js";import"./DebugInfo-CYXqAx35.js";import"./PaymentForm-DTovmHnG.js";import"./CityField-DnO-zVjw.js";import"./PropertyField-DA6JdPHK.js";import"./UnitField-DSLORKa4.js";import"./DateField-DKst-fam.js";import"./OwesField-DQavWrKs.js";import"./PaidField-P1BknjVJ.js";import"./AssistanceField-CI7tl7J1.js";import"./PermanentField-DXKmEQgQ.js";import"./HiddenField-CkJnKyHm.js";import"./ReversedPaymentsField-DIFgv-KS.js";import"./NotesField-B8rDnG62.js";import"./DebugInfo-Z7l3Pl3f.js";import"./PaymentActions-CjUTrsst.js";import"./square-pen-CNjEA8WW.js";import"./trash-2-Dk2iLsYn.js";import"./StatusBadge-CvZeRimA.js";import"./badge-DkU7s25L.js";import"./PermanentBadge-Cw9ZIGkR.js";function We({payments:r,filters:m,units:n,cities:f,properties:x,unitsByCity:h,unitsByProperty:S,propertiesByCity:l,allCities:C,allProperties:I,statistics:b}){const{hasPermission:k,hasAnyPermission:N,hasAllPermissions:g}=Q(),[T,y]=o.useState(!1),[_,E]=o.useState(!1),[q,j]=o.useState(!1),[P,U]=o.useState(null),[d,F]=o.useState(m?.city||""),[c,w]=o.useState(m?.property||""),[u,D]=o.useState(m?.unit||""),[a,v]=o.useState(m?.status||[]),[s,A]=o.useState(m?.permanent||[]),[H,O]=o.useState(m?.is_hidden||!1),V=t=>{t.preventDefault();const i={};d&&(i.city=d),c&&(i.property=c),u&&(i.unit=u),a&&a.length>0&&(i.status=a.join(",")),s&&s.length>0&&(i.permanent=s.join(",")),H&&(i.is_hidden="true"),p.get(route("payments.index"),i,{preserveState:!0,preserveScroll:!0})},$=()=>{F(""),w(""),D(""),v([]),A([]),O(!1),p.get(route("payments.index"),{},{preserveState:!0,preserveScroll:!0})},L=t=>{confirm("Are you sure you want to delete this payment?")&&p.delete(route("payments.destroy",t.id))},R=t=>{confirm("Are you sure you want to hide this payment?")&&p.post(route("payments.hide",t.id),{})},z=t=>{U(t),j(!0)},G=()=>{p.reload()},J=()=>{if(!r||!r.data||r.data.length===0){alert("No data to export");return}y(!0);try{console.log("Exporting payments data:",r.data);const t=`payments-${new Date().toISOString().split("T")[0]}.csv`;rt(r.data,t),console.log("Export completed successfully")}catch(t){console.error("Export failed:",t),alert(`Export failed: ${t instanceof Error?t.message:"Unknown error"}. Please check the console for details.`)}finally{y(!1)}};return e.jsxs(M,{children:[e.jsx(K,{title:"Payments"}),e.jsx("div",{className:"min-h-screen bg-background py-12 text-foreground transition-colors",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsx(W,{onExport:J,onAddPayment:()=>E(!0),isExporting:T,hasData:r?.data&&r.data.length>0,canCreate:g(["payments.create","payments.store"]),statistics:b}),e.jsx(X,{cityFilter:d,propertyFilter:c,unitFilter:u,statusFilter:a,permanentFilter:s,isHiddenFilter:H,setCityFilter:F,setPropertyFilter:w,setUnitFilter:D,setStatusFilter:v,setPermanentFilter:A,setIsHiddenFilter:O,uniqueCities:C,uniqueProperties:I,units:n,propertiesByCity:l,onSearch:V,onClear:$}),r.data.length===0?e.jsx(B,{}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{payments:r.data,onEdit:z,onDelete:L,onHide:R,hasAnyPermission:N,hasAllPermissions:g,hasPermission:k}),e.jsx(Z,{meta:r.meta})]})]})}),e.jsx(tt,{open:_,onOpenChange:E,units:n,cities:f,properties:x,unitsByCity:h,unitsByProperty:S,propertiesByCity:l}),P&&e.jsx(et,{payment:P,units:n,cities:f,properties:x,unitsByCity:h,unitsByProperty:S,propertiesByCity:l,open:q,onOpenChange:j,onSuccess:G})]})}export{We as default};
