import{r as _,b as J,j as e}from"./app-nUSYw4ai.js";import{B as u}from"./createLucideIcon-C5GD6QeA.js";import{P as h,a as p,p as i,b as j,C as y}from"./popover-CMnBhXYh.js";import{D as Q,a as W,b as X}from"./drawer-ikeMES7v.js";import{I as Z}from"./input-OhVo65AQ.js";import{L as r}from"./label-DtPmPEai.js";import{S as P,a as D,b as F,c as k,d as O}from"./select-PjIVfLW0.js";import{R as N}from"./radioGroup-BdD1VW6H.js";import{C as b}from"./calendar-C-0kt65W.js";import{f as o}from"./format-PYUiRpxY.js";import"./app-oDNfBSri.js";import"./chevron-right-uK37_yne.js";import"./chevron-up-BHOYq5G1.js";import"./index-nh9QAngE.js";import"./index-CedKduyQ.js";import"./index-5YpAK82Y.js";import"./index-UYkM-lg7.js";import"./index-DbaH1TRh.js";import"./index-DGbRjXgX.js";import"./index-BKS2-tOY.js";import"./index-mn3Hv6wy.js";function ge({hierarchicalData:V,open:I,onOpenChange:R,onSuccess:$}){const w=_.useRef(null),C=_.useRef(null),S=_.useRef(null),M=_.useRef(null),[c,m]=_.useState({}),[x,U]=_.useState({date_sent_offer:!1,date_of_acceptance:!1,last_notice_sent:!1,date_sent_lease:!1,date_signed:!1,last_notice_sent_2:!1}),d=(t,n)=>{U(f=>({...f,[t]:n}))},{data:s,setData:l,post:T,processing:E,errors:a,reset:z}=J({tenant_id:"",city_id:"",property_id:"",unit_id:"",date_sent_offer:"",status:"",date_of_acceptance:"",last_notice_sent:"",notice_kind:"",lease_sent:"",date_sent_lease:"",lease_signed:"",date_signed:"",last_notice_sent_2:"",notice_kind_2:"",notes:"",how_many_days_left:""}),g=_.useMemo(()=>{if(!s.city_id)return[];const t=V.find(n=>n.id.toString()===s.city_id);return t?t.properties:[]},[V,s.city_id]),v=_.useMemo(()=>{if(!s.property_id)return[];const t=g.find(n=>n.id.toString()===s.property_id);return t?t.units:[]},[g,s.property_id]),A=_.useMemo(()=>{if(!s.unit_id)return[];const t=v.find(n=>n.id.toString()===s.unit_id);return t?t.tenants:[]},[v,s.unit_id]),B=t=>{l({...s,city_id:t,property_id:"",unit_id:"",tenant_id:""}),m(n=>({...n,city:void 0}))},K=t=>{l({...s,property_id:t,unit_id:"",tenant_id:""}),m(n=>({...n,property:void 0}))},Y=t=>{l({...s,unit_id:t,tenant_id:""}),m(n=>({...n,unit:void 0}))},G=t=>{l("tenant_id",t),m(n=>({...n,tenant:void 0}))},H=t=>{l("date_sent_offer",t),m(n=>({...n,date_sent_offer:void 0}))},L=t=>{t.preventDefault(),m({});let n=!1;const f={};if((!s.city_id||s.city_id.trim()==="")&&(f.city="Please select a city before submitting the form.",w.current&&(w.current.focus(),w.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!s.property_id||s.property_id.trim()==="")&&(f.property="Please select a property before submitting the form.",C.current&&!n&&(C.current.focus(),C.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!s.unit_id||s.unit_id.trim()==="")&&(f.unit="Please select a unit before submitting the form.",S.current&&!n&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!s.tenant_id||s.tenant_id.trim()==="")&&(f.tenant="Please select a tenant before submitting the form.",M.current&&!n&&(M.current.focus(),M.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!s.date_sent_offer||s.date_sent_offer.trim()==="")&&(f.date_sent_offer="Please select a date sent offer before submitting the form.",n=!0),n){m(f);return}T(route("offers_and_renewals.store"),{onSuccess:()=>{z(),m({}),R(!1),$?.()}})},q=()=>{z(),m({}),R(!1)};return e.jsx(Q,{open:I,onOpenChange:R,modal:!1,children:e.jsx(W,{size:"half",title:"Create New Offer/Renewal",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"city",className:"text-base font-semibold",children:"City *"})}),e.jsxs(P,{onValueChange:B,value:s.city_id,children:[e.jsx(D,{ref:w,children:e.jsx(F,{placeholder:"Select city"})}),e.jsx(k,{children:V.map(t=>e.jsx(O,{value:t.id.toString(),children:t.name},t.id))})]}),a.city_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.city_id}),c.city&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.city})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"property",className:"text-base font-semibold",children:"Property *"})}),e.jsxs(P,{onValueChange:K,value:s.property_id,disabled:!s.city_id||g.length===0,children:[e.jsx(D,{ref:C,children:e.jsx(F,{placeholder:s.city_id?g.length===0?"No properties available":"Select property":"Select city first"})}),e.jsx(k,{children:g.map(t=>e.jsx(O,{value:t.id.toString(),children:t.name},t.id))})]}),a.property_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.property_id}),c.property&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.property})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"unit",className:"text-base font-semibold",children:"Unit *"})}),e.jsxs(P,{onValueChange:Y,value:s.unit_id,disabled:!s.property_id||v.length===0,children:[e.jsx(D,{ref:S,children:e.jsx(F,{placeholder:s.property_id?v.length===0?"No units available":"Select unit":"Select property first"})}),e.jsx(k,{children:v.map(t=>e.jsx(O,{value:t.id.toString(),children:t.name},t.id))})]}),a.unit_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.unit_id}),c.unit&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.unit})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-purple-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"tenant",className:"text-base font-semibold",children:"Tenant *"})}),e.jsxs(P,{onValueChange:G,value:s.tenant_id,disabled:!s.unit_id||A.length===0,children:[e.jsx(D,{ref:M,children:e.jsx(F,{placeholder:s.unit_id?A.length===0?"No tenants available":"Select tenant":"Select unit first"})}),e.jsx(k,{children:A.map(t=>e.jsx(O,{value:t.id.toString(),children:t.name},t.id))})]}),a.tenant_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.tenant_id}),c.tenant&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.tenant})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"date_sent_offer",className:"text-base font-semibold",children:"Date Sent Offer *"})}),e.jsxs(h,{open:x.date_sent_offer,onOpenChange:t=>d("date_sent_offer",t),modal:!1,children:[e.jsx(p,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.date_sent_offer&&"text-muted-foreground"}`,children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),s.date_sent_offer?o(i(s.date_sent_offer,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(j,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:s.date_sent_offer?i(s.date_sent_offer,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(H(o(t,"yyyy-MM-dd")),d("date_sent_offer",!1))},initialFocus:!0})})]}),a.date_sent_offer&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.date_sent_offer}),c.date_sent_offer&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.date_sent_offer})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"status",className:"text-base font-semibold",children:"Status"})}),e.jsx(N,{value:s.status,onValueChange:t=>l("status",t),name:"status",options:[{value:"Accepted",label:"Accepted"},{value:"Didn't Accept",label:"Didn't Accept"},{value:"Didn't respond",label:"Didn't respond"}]}),a.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.status})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"date_of_acceptance",className:"text-base font-semibold",children:"Date of Acceptance"})}),e.jsxs(h,{open:x.date_of_acceptance,onOpenChange:t=>d("date_of_acceptance",t),modal:!1,children:[e.jsx(p,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.date_of_acceptance&&"text-muted-foreground"}`,children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),s.date_of_acceptance?o(i(s.date_of_acceptance,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(j,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:s.date_of_acceptance?i(s.date_of_acceptance,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(l("date_of_acceptance",o(t,"yyyy-MM-dd")),d("date_of_acceptance",!1))},initialFocus:!0})})]}),a.date_of_acceptance&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.date_of_acceptance})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"last_notice_sent",className:"text-base font-semibold",children:"Offer Last Notice Sent"})}),e.jsxs(h,{open:x.last_notice_sent,onOpenChange:t=>d("last_notice_sent",t),modal:!1,children:[e.jsx(p,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.last_notice_sent&&"text-muted-foreground"}`,children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),s.last_notice_sent?o(i(s.last_notice_sent,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(j,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:s.last_notice_sent?i(s.last_notice_sent,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(l("last_notice_sent",o(t,"yyyy-MM-dd")),d("last_notice_sent",!1))},initialFocus:!0})})]}),a.last_notice_sent&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.last_notice_sent})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"notice_kind",className:"text-base font-semibold",children:"Offer Notice Kind"})}),e.jsx(N,{value:s.notice_kind,onValueChange:t=>l("notice_kind",t),name:"notice_kind",options:[{value:"Email",label:"Email"},{value:"Call",label:"Call"}]}),a.notice_kind&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.notice_kind})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-red-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"lease_sent",className:"text-base font-semibold",children:"Lease Sent?"})}),e.jsx(N,{value:s.lease_sent,onValueChange:t=>l("lease_sent",t),name:"lease_sent",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}]}),a.lease_sent&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.lease_sent})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-yellow-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"date_sent_lease",className:"text-base font-semibold",children:"Date Sent Lease"})}),e.jsxs(h,{open:x.date_sent_lease,onOpenChange:t=>d("date_sent_lease",t),modal:!1,children:[e.jsx(p,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.date_sent_lease&&"text-muted-foreground"}`,children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),s.date_sent_lease?o(i(s.date_sent_lease,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(j,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:s.date_sent_lease?i(s.date_sent_lease,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(l("date_sent_lease",o(t,"yyyy-MM-dd")),d("date_sent_lease",!1))},initialFocus:!0})})]}),a.date_sent_lease&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.date_sent_lease})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-cyan-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"lease_signed",className:"text-base font-semibold",children:"Lease Signed?"})}),e.jsx(N,{value:s.lease_signed,onValueChange:t=>l("lease_signed",t),name:"lease_signed",options:[{value:"Signed",label:"Signed"},{value:"Unsigned",label:"Unsigned"}]}),a.lease_signed&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.lease_signed})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-violet-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"date_signed",className:"text-base font-semibold",children:"Date Signed"})}),e.jsxs(h,{open:x.date_signed,onOpenChange:t=>d("date_signed",t),modal:!1,children:[e.jsx(p,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.date_signed&&"text-muted-foreground"}`,children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),s.date_signed?o(i(s.date_signed,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(j,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:s.date_signed?i(s.date_signed,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(l("date_signed",o(t,"yyyy-MM-dd")),d("date_signed",!1))},initialFocus:!0})})]}),a.date_signed&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.date_signed})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-rose-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"last_notice_sent_2",className:"text-base font-semibold",children:"Renewal Last Notice Sent"})}),e.jsxs(h,{open:x.last_notice_sent_2,onOpenChange:t=>d("last_notice_sent_2",t),modal:!1,children:[e.jsx(p,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.last_notice_sent_2&&"text-muted-foreground"}`,children:[e.jsx(b,{className:"mr-2 h-4 w-4"}),s.last_notice_sent_2?o(i(s.last_notice_sent_2,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(j,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:s.last_notice_sent_2?i(s.last_notice_sent_2,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(l("last_notice_sent_2",o(t,"yyyy-MM-dd")),d("last_notice_sent_2",!1))},initialFocus:!0})})]}),a.last_notice_sent_2&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.last_notice_sent_2})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-amber-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"notice_kind_2",className:"text-base font-semibold",children:"Renewal Notice Kind"})}),e.jsx(N,{value:s.notice_kind_2,onValueChange:t=>l("notice_kind_2",t),name:"notice_kind_2",options:[{value:"Email",label:"Email"},{value:"Call",label:"Call"}]}),a.notice_kind_2&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.notice_kind_2})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-lime-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"how_many_days_left",className:"text-base font-semibold",children:"How Many Days Left"})}),e.jsx(Z,{id:"how_many_days_left",type:"number",step:1,value:s.how_many_days_left??"",onChange:t=>l("how_many_days_left",t.target.value),placeholder:"Enter number of days"}),a.how_many_days_left&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.how_many_days_left})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-slate-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(r,{htmlFor:"notes",className:"text-base font-semibold",children:"Notes"})}),e.jsx("textarea",{id:"notes",value:s.notes??"",onChange:t=>l("notes",t.target.value),rows:3,placeholder:"Enter any notes...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent min-h-[100px] resize-vertical"}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.notes})]})]})}),e.jsx(X,{children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(u,{type:"button",variant:"outline",onClick:q,children:"Cancel"}),e.jsx(u,{type:"submit",onClick:L,disabled:E,children:E?"Creating...":"Create Offer/Renewal"})]})})]})})})}export{ge as default};
