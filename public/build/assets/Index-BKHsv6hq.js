import{r as o,j as e,H as K,a as p}from"./app-mUrH0ynJ.js";import{A as M}from"./app-layout-CXK9X9au.js";import{u as Q}from"./usePermissions-BawB_cjI.js";import W from"./PageHeader-Bf1NI6mO.js";import X from"./FilterSection-7Lnr5ENr.js";import Y from"./PaymentsTable-BhbY4VGY.js";import Z from"./PaginationInfo-Ct0AUtPR.js";import B from"./EmptyState-DWMaIj6U.js";import tt from"./PaymentCreateDrawer-BkmNVxvj.js";import et from"./PaymentEditDrawer-uudu-orW.js";import{e as rt}from"./PaymentRow-D8Ar4EV2.js";import"./app-BxoA0TtB.js";import"./index-Co1yv0YL.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./button-BFBNYzQ-.js";import"./index-CQgkcMAl.js";import"./index-CgzaaCP9.js";import"./index-Do303mGv.js";import"./index-D9BBn6e9.js";import"./index-bRwiAiPA.js";import"./index-kDRJ7vWo.js";import"./x-BVVw4O5L.js";import"./createLucideIcon-DUXn48BB.js";import"./index-Dc_FVRD7.js";import"./index-CXBw7cFo.js";import"./index-DEcWu7_s.js";import"./index-5IheD20q.js";import"./index-I5U3wwZt.js";import"./collapsible-DR70Hr7v.js";import"./chevron-right-o746ehSI.js";import"./index-DK4fbPLM.js";import"./log-out-CXDwqi9T.js";import"./chevrons-up-down-FHN_82j5.js";import"./app-logo-icon-afD3Sqey.js";import"./house-Bx2Ik4FM.js";import"./building-uSWxfBdk.js";import"./users-C2kYwBw2.js";import"./wrench-Cq_dpeQy.js";import"./credit-card-Bcb_2PMm.js";import"./dollar-sign-BB476t67.js";import"./file-text-CjfNfFxM.js";import"./triangle-alert-Dr9RWMLY.js";import"./bell-ch4AgGU_.js";import"./card-D_RIkHPn.js";import"./download-tURfbWWG.js";import"./plus-Vhp6TgB7.js";import"./FilterDropdown-1N9D013X.js";import"./input-Bo52L6_R.js";import"./chevron-down-CcniYHCH.js";import"./StatusFilter-GP5skV8G.js";import"./PermanentFilter-B3orxc9B.js";import"./HiddenFilter-BolTFI8Z.js";import"./eye-sD0tKuKR.js";import"./eye-off-pG3-IeAB.js";import"./search-BHqZNlG5.js";import"./table-DpihfFkM.js";import"./drawer-B7FkQmZP.js";import"./DateField-mwox7LGi.js";import"./calendar-DAc8iCNl.js";import"./format-PYUiRpxY.js";import"./chevron-left-Bx0Sy0a0.js";import"./label-DmNL2-zA.js";import"./popover-B07j7TfD.js";import"./calendar-e6qKYHCo.js";import"./CityField-CE4MqbZl.js";import"./select-NL-VGbzo.js";import"./index-p6YNWFgp.js";import"./check-nxBTAIc9.js";import"./chevron-up-Cls6AU_3.js";import"./PropertyField-D0fpEw_K.js";import"./UnitField-CGe6ssSg.js";import"./FinancialFields-CYAiOcV6.js";import"./AssistanceFields-D6lSzGoc.js";import"./checkbox-DRw3b_WF.js";import"./PermanentField-r68i4nby.js";import"./radioGroup-DvkZrWpP.js";import"./HiddenField-5CH3rNhp.js";import"./ReversedPaymentsField-BN51duLy.js";import"./NotesField-iSCf1xOY.js";import"./DebugInfo-CZ2sVshg.js";import"./PaymentForm-C6bD7d1S.js";import"./CityField-DQWJmCGi.js";import"./PropertyField-DdkRO6eC.js";import"./UnitField-BE6cVlpH.js";import"./DateField-D-8MPFu7.js";import"./OwesField-BCnzwAdt.js";import"./PaidField-DKXSqLpm.js";import"./AssistanceField-CVLHCCc2.js";import"./PermanentField-B78lGLzp.js";import"./HiddenField-OSorEYOy.js";import"./ReversedPaymentsField-Boah89Da.js";import"./NotesField-gjrqf5k_.js";import"./DebugInfo-DQ4bkBDd.js";import"./PaymentActions-BrGRYHhR.js";import"./square-pen-3gz5SX3m.js";import"./trash-2-PUmSVtRb.js";import"./StatusBadge-7cbUAKcP.js";import"./badge-CXaZ35ua.js";import"./PermanentBadge-CpRR3PRi.js";function We({payments:r,filters:m,units:n,cities:f,properties:x,unitsByCity:h,unitsByProperty:S,propertiesByCity:l,allCities:C,allProperties:I,statistics:b}){const{hasPermission:k,hasAnyPermission:N,hasAllPermissions:g}=Q(),[T,y]=o.useState(!1),[_,E]=o.useState(!1),[q,j]=o.useState(!1),[P,U]=o.useState(null),[d,F]=o.useState(m?.city||""),[c,w]=o.useState(m?.property||""),[u,D]=o.useState(m?.unit||""),[a,v]=o.useState(m?.status||[]),[s,A]=o.useState(m?.permanent||[]),[H,O]=o.useState(m?.is_hidden||!1),V=t=>{t.preventDefault();const i={};d&&(i.city=d),c&&(i.property=c),u&&(i.unit=u),a&&a.length>0&&(i.status=a.join(",")),s&&s.length>0&&(i.permanent=s.join(",")),H&&(i.is_hidden="true"),p.get(route("payments.index"),i,{preserveState:!0,preserveScroll:!0})},$=()=>{F(""),w(""),D(""),v([]),A([]),O(!1),p.get(route("payments.index"),{},{preserveState:!0,preserveScroll:!0})},L=t=>{confirm("Are you sure you want to delete this payment?")&&p.delete(route("payments.destroy",t.id))},R=t=>{confirm("Are you sure you want to hide this payment?")&&p.post(route("payments.hide",t.id),{})},z=t=>{U(t),j(!0)},G=()=>{p.reload()},J=()=>{if(!r||!r.data||r.data.length===0){alert("No data to export");return}y(!0);try{console.log("Exporting payments data:",r.data);const t=`payments-${new Date().toISOString().split("T")[0]}.csv`;rt(r.data,t),console.log("Export completed successfully")}catch(t){console.error("Export failed:",t),alert(`Export failed: ${t instanceof Error?t.message:"Unknown error"}. Please check the console for details.`)}finally{y(!1)}};return e.jsxs(M,{children:[e.jsx(K,{title:"Payments"}),e.jsx("div",{className:"min-h-screen bg-background py-12 text-foreground transition-colors",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsx(W,{onExport:J,onAddPayment:()=>E(!0),isExporting:T,hasData:r?.data&&r.data.length>0,canCreate:g(["payments.create","payments.store"]),statistics:b}),e.jsx(X,{cityFilter:d,propertyFilter:c,unitFilter:u,statusFilter:a,permanentFilter:s,isHiddenFilter:H,setCityFilter:F,setPropertyFilter:w,setUnitFilter:D,setStatusFilter:v,setPermanentFilter:A,setIsHiddenFilter:O,uniqueCities:C,uniqueProperties:I,units:n,propertiesByCity:l,onSearch:V,onClear:$}),r.data.length===0?e.jsx(B,{}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{payments:r.data,onEdit:z,onDelete:L,onHide:R,hasAnyPermission:N,hasAllPermissions:g,hasPermission:k}),e.jsx(Z,{meta:r.meta})]})]})}),e.jsx(tt,{open:_,onOpenChange:E,units:n,cities:f,properties:x,unitsByCity:h,unitsByProperty:S,propertiesByCity:l}),P&&e.jsx(et,{payment:P,units:n,cities:f,properties:x,unitsByCity:h,unitsByProperty:S,propertiesByCity:l,open:q,onOpenChange:j,onSuccess:G})]})}export{We as default};
