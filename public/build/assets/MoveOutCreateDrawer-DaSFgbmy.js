import{r as i,b as B,j as r}from"./app-XlMZG7vD.js";import{D as G,a as H,b as J}from"./drawer-B7-2XtV2.js";import{B as P}from"./button-D56PIbu9.js";import K from"./LocationSection-BAYMqDDS.js";import Q from"./DateFieldsSection-DailPrFx.js";import W from"./PropertyDetailsSection-DUQt3cUW.js";import X from"./StatusFieldsSection-pC57H8GK.js";import"./app-D9zByHv3.js";import"./index-CUT4GDty.js";import"./index-D09_T-bu.js";import"./index-C_K36Fy_.js";import"./index-BoN4SSkO.js";import"./index-pZGqFUGS.js";import"./index-DqP218B8.js";import"./index-D2DcuX69.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-B-P-7DDz.js";import"./createLucideIcon-BneQKrth.js";import"./FormField-BqMlDDiJ.js";import"./label-BKN3erGN.js";import"./TextInputField-9sJ7o5dg.js";import"./input-nhBJFe9F.js";import"./popover-DR8Y8CsW.js";import"./index-CTF06pqo.js";import"./command-DGwO2Uw9.js";import"./search-BKBHV1D6.js";import"./chevrons-up-down-CmSv9Nzf.js";import"./check-ZO7ekD6P.js";import"./DatePickerField-Dk1CVkBb.js";import"./calendar-D02iCkay.js";import"./format-PYUiRpxY.js";import"./chevron-left-DiIjHAK0.js";import"./chevron-right-By2R6jNh.js";import"./chevron-down-Dqt3V4Kg.js";import"./calendar-CGMbx-hL.js";import"./RadioGroupField-u_0Rr9F5.js";import"./radioGroup-DrlpglLG.js";import"./index-D8BBDizX.js";import"./index-DdpYxxi8.js";import"./TextAreaField-DBS4BfUL.js";import"./textarea-DWy2J22q.js";function Oe({cities:N,propertiesByCityId:y,unitsByPropertyId:g,open:R,onOpenChange:b,onSuccess:k,redirectContext:l}){const u=i.useRef(null),c=i.useRef(null),p=i.useRef(null),[I,o]=i.useState({city:"",property:"",unit:""}),[v,S]=i.useState(null),[C,f]=i.useState(null),[x,m]=i.useState(null),[E,h]=i.useState([]),[U,_]=i.useState([]),[V,F]=i.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:s,setData:a,post:M,processing:j,errors:d,reset:T,transform:A}=B({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",all_the_devices_are_off:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",renter:"",move_out_form:"",utility_type:""}),O=n=>{const e=parseInt(n);S(e),f(null),m(null),a("unit_id",null),o(t=>({...t,city:"",property:"",unit:""})),e&&y[e]?h(y[e]):h([]),_([])},z=n=>{const e=parseInt(n);f(e),m(null),a("unit_id",null),o(t=>({...t,property:"",unit:""})),e&&g[e]?_(g[e]):_([])},L=n=>{const e=parseInt(n);m(e),a("unit_id",e),o(t=>({...t,unit:""}))},q=n=>{F(e=>({...e,[n]:!e[n]}))},D=n=>{n.preventDefault(),o({city:"",property:"",unit:""});let e=!1;v||(o(t=>({...t,city:"Please select a city before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),C||(o(t=>({...t,property:"Please select a property before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),(!x||!s.unit_id)&&(o(t=>({...t,unit:"Please select a unit before submitting the form."})),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),!e&&(A(t=>({...t,move_out_date:t.move_out_date?.trim()?t.move_out_date:null,date_lease_ending_on_buildium:t.date_lease_ending_on_buildium?.trim()?t.date_lease_ending_on_buildium:null,date_utility_put_under_our_name:t.date_utility_put_under_our_name?.trim()?t.date_utility_put_under_our_name:null,redirect_city:l?.city??null,redirect_property:l?.property??null,redirect_unit:l?.unit??null,redirect_page:l?.page??null,redirect_perPage:l?.perPage??null})),M(route("move-out.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{w(),k?.()}}))},w=()=>{T(),S(null),f(null),m(null),o({city:"",property:"",unit:""}),h([]),_([]),b(!1)};return r.jsx(G,{open:R,onOpenChange:b,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Move-Out Record",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsx(K,{cities:N,availableProperties:E,availableUnits:U,selectedCity:v,selectedProperty:C,selectedUnit:x,validationErrors:I,cityRef:u,propertyRef:c,unitRef:p,onCityChange:O,onPropertyChange:z,onUnitChange:L,tenants:s.tenants,tenantsError:d.tenants,onTenantsChange:n=>a("tenants",n)}),r.jsx(Q,{data:s,errors:d,calendarStates:V,onCalendarToggle:q,onDataChange:a}),r.jsx(W,{data:s,errors:d,onDataChange:a}),r.jsx(X,{data:s,errors:d,onDataChange:a})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex gap-2 w-full",children:[r.jsx(P,{type:"button",variant:"outline",onClick:w,className:"flex-1",children:"Cancel"}),r.jsx(P,{type:"submit",onClick:D,disabled:j,className:"flex-1",children:j?"Creating...":"Create Move-Out Record"})]})})]})})})}export{Oe as default};
