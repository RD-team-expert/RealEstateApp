import{r as i,b as O,j as a}from"./app-DfhMz46N.js";import{B as v}from"./button-D70ZdTAE.js";import{D as T,a as A,b as z}from"./drawer-DfcxSr7r.js";import $ from"./CityPropertySelector-B4b_VO0x.js";import q from"./UnitDetailsFields-C6MLIjeh.js";import G from"./LeaseInformationFields--jsfuqDi.js";import H from"./FinancialFields-BoblzxPn.js";import J from"./UtilitiesFields-vcrM8oEa.js";import K from"./InsuranceFields-CD_zW2KG.js";import Q from"./CalculatedValuesDisplay-BVCbMk4c.js";import{i as S,f as W}from"./format-PYUiRpxY.js";import{p as X}from"./calendar-MDrvGB0M.js";import"./app-B7C1jyr3.js";import"./index-DCi-Xv1e.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-BQKCx-PJ.js";import"./index-CBYZjZBF.js";import"./index-Be_qgOKl.js";import"./index-Bd9tPrb_.js";import"./index-DV6UInPh.js";import"./index-BTxfuEuk.js";import"./x-DZ3FO5Wj.js";import"./createLucideIcon-DgVEEFYv.js";import"./label-DcH_3_W8.js";import"./select-CjXVIajk.js";import"./index-Dc_FVRD7.js";import"./index-PkKgVJHn.js";import"./index-Ct5EcCoK.js";import"./index-CubYnoId.js";import"./index-DbgZyH5A.js";import"./chevron-down-VWfm6OW2.js";import"./check-CordmqsZ.js";import"./chevron-up-dLBEGKat.js";import"./FormSection-2pv1eVyc.js";import"./input-BxpY_ptm.js";import"./radioGroup-D6vUyOHk.js";import"./DatePickerField-WAMwzJ5A.js";import"./popover-CAZC23Eq.js";import"./calendar-Rkx4ksc5.js";import"./chevron-left-DiUZGSRN.js";import"./chevron-right-BW9owo_I.js";const Y=e=>{if(!(!e||e.trim()===""))try{const c=X(e,"yyyy-MM-dd",new Date);if(S(c))return c;const l=new Date(e);return S(l)?l:void 0}catch(c){console.warn("Date parsing error:",c);return}},u=e=>{if(!e||e.trim()==="")return"";const c=Y(e);return c&&S(c)?W(c,"yyyy-MM-dd"):""};function Ae({unit:e,cities:c,properties:l,open:h,onOpenChange:b,onSuccess:I}){const p=i.useRef(null),m=i.useRef(null),[U,f]=i.useState(""),[V,_]=i.useState(""),[w,d]=i.useState(""),[P,j]=i.useState([]),[y,D]=i.useState(""),[g,x]=i.useState({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),E=(t,o)=>{x(M=>({...M,[t]:o}))},{data:r,setData:n,put:F,processing:C,errors:s}=O({property_id:e.property_id?.toString()||"",unit_name:e.unit_name||"",tenants:e.tenants||"",lease_start:u(e.lease_start),lease_end:u(e.lease_end),count_beds:e.count_beds?.toString()||"",count_baths:e.count_baths?.toString()||"",lease_status:e.lease_status||"",monthly_rent:e.monthly_rent?.toString()||"",recurring_transaction:e.recurring_transaction||"",utility_status:e.utility_status||"",account_number:e.account_number||"",insurance:e.insurance||"",insurance_expiration_date:u(e.insurance_expiration_date)});i.useEffect(()=>{if(h&&e.property_id&&l){const t=l.find(o=>o.id===e.property_id);t&&t.city_id&&D(t.city_id.toString())}},[h,e.property_id,l]),i.useEffect(()=>{if(y&&l){const t=l.filter(o=>o.city_id?.toString()===y);j(t),r.property_id&&!t.find(o=>o.id.toString()===r.property_id)&&n("property_id","")}else j([])},[y,l]),i.useEffect(()=>{e&&n({property_id:e.property_id?.toString()||"",unit_name:e.unit_name||"",tenants:e.tenants||"",lease_start:u(e.lease_start),lease_end:u(e.lease_end),count_beds:e.count_beds?.toString()||"",count_baths:e.count_baths?.toString()||"",lease_status:e.lease_status||"",monthly_rent:e.monthly_rent?.toString()||"",recurring_transaction:e.recurring_transaction||"",utility_status:e.utility_status||"",account_number:e.account_number||"",insurance:e.insurance||"",insurance_expiration_date:u(e.insurance_expiration_date)})},[e]);const R=t=>{D(t),f(""),_("")},B=t=>{n("property_id",t),_("")},L=t=>{n("unit_name",t.target.value),d("")},N=t=>{t.preventDefault(),f(""),_(""),d("");let o=!1;(!r.property_id||r.property_id.trim()==="")&&(_("Please select a property before submitting the form."),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),o=!0),(!r.unit_name||r.unit_name.trim()==="")&&(d("Please enter a unit name before submitting the form."),m.current&&(m.current.focus(),m.current.scrollIntoView({behavior:"smooth",block:"center"})),o=!0),!o&&F(route("units.update",e.id),{onSuccess:()=>{f(""),_(""),d(""),x({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),b(!1),I?.()}})},k=()=>{n({property_id:e.property_id?.toString()||"",unit_name:e.unit_name||"",tenants:e.tenants||"",lease_start:u(e.lease_start),lease_end:u(e.lease_end),count_beds:e.count_beds?.toString()||"",count_baths:e.count_baths?.toString()||"",lease_status:e.lease_status||"",monthly_rent:e.monthly_rent?.toString()||"",recurring_transaction:e.recurring_transaction||"",utility_status:e.utility_status||"",account_number:e.account_number||"",insurance:e.insurance||"",insurance_expiration_date:u(e.insurance_expiration_date)}),f(""),_(""),d(""),x({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),b(!1)};return a.jsx(T,{open:h,onOpenChange:b,modal:!1,children:a.jsx(A,{size:"half",title:`Edit Unit - ${e.unit_name}`,children:a.jsxs("div",{className:"flex h-full flex-col",children:[a.jsx("div",{className:"flex-1 overflow-auto p-6",children:a.jsxs("form",{onSubmit:N,className:"space-y-4",children:[a.jsx("div",{className:"mb-6 p-4 bg-secondary border border-border rounded-lg",children:a.jsxs("p",{className:"text-sm text-secondary-foreground",children:[a.jsx("strong",{children:"Note:"})," Vacant, Listed, and Total Applications are automatically calculated based on your inputs."]})}),a.jsx($,{cities:c,selectedCityId:y,onCityChange:R,availableProperties:P,propertyId:r.property_id,onPropertyChange:B,propertyRef:p,validationError:U,propertyValidationError:V,propertyError:s.property_id}),a.jsx(q,{unitName:r.unit_name,onUnitNameChange:L,unitNameRef:m,unitNameError:s.unit_name,unitNameValidationError:w,tenants:r.tenants,onTenantsChange:t=>n("tenants",t),tenantsError:s.tenants}),a.jsx(G,{leaseStart:r.lease_start,onLeaseStartChange:t=>n("lease_start",t),leaseStartOpen:g.lease_start,onLeaseStartOpenChange:t=>E("lease_start",t),leaseStartError:s.lease_start,leaseEnd:r.lease_end,onLeaseEndChange:t=>n("lease_end",t),leaseEndOpen:g.lease_end,onLeaseEndOpenChange:t=>E("lease_end",t),leaseEndError:s.lease_end,countBeds:r.count_beds,onCountBedsChange:t=>n("count_beds",t),countBedsError:s.count_beds,countBaths:r.count_baths,onCountBathsChange:t=>n("count_baths",t),countBathsError:s.count_baths,leaseStatus:r.lease_status,onLeaseStatusChange:t=>n("lease_status",t),leaseStatusError:s.lease_status}),a.jsx(H,{monthlyRent:r.monthly_rent,onMonthlyRentChange:t=>n("monthly_rent",t),monthlyRentError:s.monthly_rent,recurringTransaction:r.recurring_transaction,onRecurringTransactionChange:t=>n("recurring_transaction",t),recurringTransactionError:s.recurring_transaction}),a.jsx(J,{utilityStatus:r.utility_status,onUtilityStatusChange:t=>n("utility_status",t),utilityStatusError:s.utility_status,accountNumber:r.account_number,onAccountNumberChange:t=>n("account_number",t),accountNumberError:s.account_number}),a.jsx(K,{insurance:r.insurance,onInsuranceChange:t=>n("insurance",t),insuranceError:s.insurance,insuranceExpirationDate:r.insurance_expiration_date,onInsuranceExpirationDateChange:t=>n("insurance_expiration_date",t),insuranceExpirationOpen:g.insurance_expiration_date,onInsuranceExpirationOpenChange:t=>E("insurance_expiration_date",t),insuranceExpirationDateError:s.insurance_expiration_date}),a.jsx(Q,{unit:e})]})}),a.jsx(z,{className:"border-t bg-background",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(v,{type:"submit",onClick:N,disabled:C,className:"flex-1",children:C?"Updating...":"Update Unit"}),a.jsx(v,{type:"button",variant:"outline",onClick:k,disabled:C,className:"flex-1",children:"Cancel"})]})})]})})})}export{Ae as default};
