import{r as s,b as se,j as t}from"./app-CHDKARjb.js";import{B as N}from"./button-DVMLQ4Cf.js";import{D as ne,a as ie,b as oe}from"./drawer-DBQSSrTa.js";import re from"./CitySection-DSX8oWyt.js";import ae from"./PropertySection-Bf3Fqkif.js";import de from"./UnitSection-7ChMLZ6c.js";import le from"./VendorSection-CHqz6pqd.js";import ce from"./TaskSubmissionDateSection-DbCjn2rk.js";import ue from"./ScheduledVisitsSection-BA0Cj62O.js";import me from"./TaskEndingDateSection-Nppy0syl.js";import fe from"./AssignedTasksSection-PpbZoU3j.js";import _e from"./NotesSection-9-bwzeO3.js";import pe from"./StatusSection-B94d4cOf.js";import he from"./UrgencySection-Bfyv0Lo3.js";import"./app-BmbQfT0_.js";import"./index-DzrNkgKa.js";import"./utils-CBfrqCZ4.js";import"./index-DH5c0sFq.js";import"./index-Dc_FVRD7.js";import"./index-BMM8wKPv.js";import"./index-DhGOy-yS.js";import"./index-Bc-3DsyS.js";import"./index-DzT3tnb6.js";import"./index-q1apwmMP.js";import"./index-0tk3grE1.js";import"./index-DfGTd3cq.js";import"./x-DzxxLS5y.js";import"./createLucideIcon-C7c1hvIj.js";import"./label-DcQ_-sMZ.js";import"./select-DSkJK3rS.js";import"./index-DiN52TcP.js";import"./index-DUM9UyY6.js";import"./index-CwBu8RV2.js";import"./index-qPHptkmt.js";import"./index-vBQwvlXi.js";import"./chevron-down-qX4-vl1q.js";import"./check-Ck6Rqaxz.js";import"./chevron-up-DiltP7zF.js";import"./input-CESuFFYh.js";import"./popover-CqkGk1d9.js";import"./format-PYUiRpxY.js";import"./chevron-right-CzDW8WF4.js";import"./calendar-DnRZTeuR.js";import"./radioGroup-DeMlaPSu.js";function at({cities:F,vendors:z,propertiesByCity:R,unitsByProperty:j,open:q,onOpenChange:E,onSuccess:G}){const g=s.useRef(null),k=s.useRef(null),b=s.useRef(null),S=s.useRef(null),v=s.useRef(null),[H,c]=s.useState(""),[J,d]=s.useState(""),[K,l]=s.useState(""),[L,u]=s.useState(""),[M,m]=s.useState(""),[y,f]=s.useState([]),[Q,_]=s.useState([]),[P,C]=s.useState([]),[D,W]=s.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),T=(e,i)=>{W(h=>({...h,[e]:i}))},{data:n,setData:o,post:X,processing:U,errors:r,reset:A}=se({vendor_id:"",unit_id:"",task_submission_date:"",assigned_tasks:"",any_scheduled_visits:"",notes:"",task_ending_date:"",status:"",urgent:"No"}),[a,w]=s.useState(""),[O,x]=s.useState(""),[,p]=s.useState(""),[,V]=s.useState(""),Y=e=>{w(e),x(""),p(""),V(""),o("unit_id",""),o("vendor_id",""),c(""),d(""),l(""),e?(R[e]?_(R[e]):_([]),C(z)):(_([]),C([])),f([])},Z=e=>{x(e),p(""),o("unit_id",""),d(""),a&&e&&j[a]&&j[a][e]?f(j[a][e]):f([])},$=e=>{const i=y.find(h=>h.id.toString()===e);i&&(p(i.unit_name),o("unit_id",e),d(""))},B=e=>{const i=P.find(h=>h.id.toString()===e);i&&(V(i.vendor_name),o("vendor_id",e),l(""))},ee=e=>{o("assigned_tasks",e.target.value),m("")},I=e=>{e.preventDefault(),c(""),d(""),l(""),u(""),m("");let i=!1;(!a||a.trim()==="")&&(c("Please select a city before submitting the form."),g.current&&(g.current.focus(),g.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.unit_id||n.unit_id.trim()==="")&&(d("Please select a unit before submitting the form."),k.current&&(k.current.focus(),k.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.vendor_id||n.vendor_id.trim()==="")&&(l("Please select a vendor before submitting the form."),b.current&&(b.current.focus(),b.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.task_submission_date||n.task_submission_date.trim()==="")&&(u("Please select a task submission date before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.assigned_tasks||n.assigned_tasks.trim()==="")&&(m("Please enter assigned tasks before submitting the form."),v.current&&(v.current.focus(),v.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),!i&&X(route("vendor-task-tracker.store"),{onSuccess:()=>{A(),w(""),x(""),p(""),V(""),c(""),d(""),l(""),u(""),m(""),f([]),_([]),C([]),E(!1),G?.()}})},te=()=>{A(),w(""),x(""),p(""),V(""),c(""),d(""),l(""),u(""),m(""),f([]),_([]),C([]),E(!1)};return t.jsx(ne,{open:q,onOpenChange:E,modal:!1,children:t.jsx(ie,{size:"half",title:"Create New Vendor Task",children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.jsxs("form",{onSubmit:I,className:"space-y-4",children:[t.jsx(re,{cities:F,selectedCity:a,onCityChange:Y,cityRef:g,errors:r,validationError:H}),t.jsx(ae,{availableProperties:Q,selectedProperty:O,selectedCity:a,onPropertyChange:Z}),t.jsx(de,{availableUnits:y,selectedProperty:O,unitId:n.unit_id,onUnitChange:$,unitRef:k,errors:r,validationError:J}),t.jsx(le,{availableVendors:P,selectedCity:a,vendorId:n.vendor_id,onVendorChange:B,vendorRef:b,errors:r,validationError:K}),t.jsx(ce,{taskSubmissionDate:n.task_submission_date,calendarOpen:D.task_submission_date,onCalendarOpenChange:e=>T("task_submission_date",e),onDateChange:e=>{o("task_submission_date",e),u("")},taskSubmissionDateRef:S,errors:r,validationError:L}),t.jsx(ue,{scheduledVisits:n.any_scheduled_visits,calendarOpen:D.any_scheduled_visits,onCalendarOpenChange:e=>T("any_scheduled_visits",e),onDateChange:e=>o("any_scheduled_visits",e),errors:r}),t.jsx(me,{taskEndingDate:n.task_ending_date,calendarOpen:D.task_ending_date,onCalendarOpenChange:e=>T("task_ending_date",e),onDateChange:e=>o("task_ending_date",e),errors:r}),t.jsx(fe,{assignedTasks:n.assigned_tasks,onAssignedTasksChange:ee,assignedTasksRef:v,errors:r,validationError:M}),t.jsx(_e,{notes:n.notes,onNotesChange:e=>o("notes",e.target.value),errors:r}),t.jsx(pe,{status:n.status,onStatusChange:e=>o("status",e),errors:r}),t.jsx(he,{urgent:n.urgent,onUrgentChange:e=>o("urgent",e),errors:r})]})}),t.jsx(oe,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(N,{type:"button",variant:"outline",onClick:te,className:"flex-1",children:"Cancel"}),t.jsx(N,{type:"submit",onClick:I,disabled:U,className:"flex-1",children:U?"Creating...":"Create Task"})]})})]})})})}export{at as default};
