import{r,b as Q,j as o}from"./app-mUrH0ynJ.js";import{D as W,a as X,b as Y}from"./drawer-B7FkQmZP.js";import{B as _}from"./button-BFBNYzQ-.js";import Z from"./LocationTenantSelection-Cn13ChFP.js";import $ from"./PaymentPlanDetails-DrPZXSLP.js";import B from"./NotesSection-DZxnu4C4.js";import"./app-BxoA0TtB.js";import"./index-CQgkcMAl.js";import"./index-Co1yv0YL.js";import"./index-CgzaaCP9.js";import"./index-Do303mGv.js";import"./index-D9BBn6e9.js";import"./index-bRwiAiPA.js";import"./index-kDRJ7vWo.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-BVVw4O5L.js";import"./createLucideIcon-DUXn48BB.js";import"./label-DmNL2-zA.js";import"./select-NL-VGbzo.js";import"./index-Dc_FVRD7.js";import"./index-DK4fbPLM.js";import"./index-CXBw7cFo.js";import"./index-DEcWu7_s.js";import"./index-5IheD20q.js";import"./index-p6YNWFgp.js";import"./chevron-down-CcniYHCH.js";import"./check-nxBTAIc9.js";import"./chevron-up-Cls6AU_3.js";import"./calendar-DAc8iCNl.js";import"./format-PYUiRpxY.js";import"./chevron-left-Bx0Sy0a0.js";import"./chevron-right-o746ehSI.js";import"./input-Bo52L6_R.js";import"./popover-B07j7TfD.js";import"./calendar-e6qKYHCo.js";import"./textarea-_9m8vmUo.js";function At({cities:E,propertiesByCityId:g,unitsByPropertyId:P,tenantsByUnitId:v,open:U,onOpenChange:S,onSuccess:A}){const[j,w]=r.useState(null),[N,b]=r.useState(null),[D,u]=r.useState(null),[I,i]=r.useState(null),[F,y]=r.useState([]),[z,m]=r.useState([]),[R,l]=r.useState([]),[L,a]=r.useState({city:"",property:"",unit:"",tenant:""}),p=r.useRef(null),f=r.useRef(null),d=r.useRef(null),h=r.useRef(null),{data:c,setData:s,post:q,processing:T,errors:C,reset:G}=Q({tenant_id:null,amount:0,dates:"",paid:0,notes:""}),H=e=>{const t=parseInt(e);w(t),b(null),u(null),i(null),s("tenant_id",null),a(n=>({...n,city:"",property:"",unit:"",tenant:""})),t&&g[t]?y(g[t]):y([]),m([]),l([])},J=e=>{const t=parseInt(e);b(t),u(null),i(null),s("tenant_id",null),a(n=>({...n,property:"",unit:"",tenant:""})),t&&P[t]?m(P[t]):m([]),l([])},K=e=>{const t=parseInt(e);u(t),i(null),s("tenant_id",null),a(n=>({...n,unit:"",tenant:""})),t&&v[t]?l(v[t]):l([])},M=e=>{const t=parseInt(e),n=R.find(x=>x.id===t);n&&(i(t),s("tenant_id",n.id),a(x=>({...x,tenant:""})))},k=e=>{e.preventDefault(),a({city:"",property:"",unit:"",tenant:""});let t=!1;j||(a(n=>({...n,city:"Please select a city before submitting the form."})),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),N||(a(n=>({...n,property:"Please select a property before submitting the form."})),f.current&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),D||(a(n=>({...n,unit:"Please select a unit before submitting the form."})),d.current&&(d.current.focus(),d.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),(!I||!c.tenant_id)&&(a(n=>({...n,tenant:"Please select a tenant before submitting the form."})),h.current&&(h.current.focus(),h.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),!t&&q(route("payment-plans.store"),{onSuccess:()=>{V(),A?.()}})},V=()=>{G(),w(null),b(null),u(null),i(null),a({city:"",property:"",unit:"",tenant:""}),y([]),m([]),l([]),S(!1)};return o.jsx(W,{open:U,onOpenChange:S,modal:!1,children:o.jsx(X,{size:"half",title:"Create Payment Plan",children:o.jsxs("div",{className:"flex h-full flex-col",children:[o.jsx("div",{className:"flex-1 overflow-auto p-6",children:o.jsxs("form",{onSubmit:k,className:"space-y-4",children:[o.jsx(Z,{cities:E,availableProperties:F,availableUnits:z,availableTenants:R,selectedCity:j,selectedProperty:N,selectedUnit:D,selectedTenant:I,validationErrors:L,errors:C,onCityChange:H,onPropertyChange:J,onUnitChange:K,onTenantChange:M,cityRef:p,propertyRef:f,unitRef:d,tenantRef:h}),o.jsx($,{dates:c.dates,amount:c.amount,paid:c.paid,errors:C,onDatesChange:e=>s("dates",e),onAmountChange:e=>s("amount",e),onPaidChange:e=>s("paid",e)}),o.jsx(B,{notes:c.notes,errors:C,onNotesChange:e=>s("notes",e)})]})}),o.jsx(Y,{children:o.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[o.jsx(_,{type:"button",variant:"outline",onClick:V,children:"Cancel"}),o.jsx(_,{type:"submit",onClick:k,disabled:T,children:T?"Creating...":"Create Payment Plan"})]})})]})})})}export{At as default};
