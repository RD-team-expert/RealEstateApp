import{r as o,b as ee,j as e}from"./app-CHDKARjb.js";import{B as j}from"./button-DVMLQ4Cf.js";import{P as D,a as E,b as V,C as k,p as te}from"./popover-CqkGk1d9.js";import{D as se,a as ae,b as re}from"./drawer-DBQSSrTa.js";import{I as c}from"./input-CESuFFYh.js";import{L as i}from"./label-DcQ_-sMZ.js";import{S as O,a as z,b as B,c as Y,d as G}from"./select-DSkJK3rS.js";import{R as q}from"./radioGroup-DeMlaPSu.js";import{C as I}from"./calendar-DnRZTeuR.js";import{f as u,i as b}from"./format-PYUiRpxY.js";import"./app-BmbQfT0_.js";import"./index-DzrNkgKa.js";import"./utils-CBfrqCZ4.js";import"./createLucideIcon-C7c1hvIj.js";import"./chevron-right-CzDW8WF4.js";import"./chevron-down-qX4-vl1q.js";import"./index-BMM8wKPv.js";import"./index-DzT3tnb6.js";import"./index-q1apwmMP.js";import"./index-0tk3grE1.js";import"./index-DhGOy-yS.js";import"./index-CwBu8RV2.js";import"./index-qPHptkmt.js";import"./index-DH5c0sFq.js";import"./index-Dc_FVRD7.js";import"./index-Bc-3DsyS.js";import"./index-DfGTd3cq.js";import"./x-DzxxLS5y.js";import"./index-DiN52TcP.js";import"./index-DUM9UyY6.js";import"./index-vBQwvlXi.js";import"./check-Ck6Rqaxz.js";import"./chevron-up-DiltP7zF.js";function Le({unit:s,cities:H,properties:x,open:C,onOpenChange:S,onSuccess:J}){const g=o.useRef(null),y=o.useRef(null),[M,N]=o.useState(""),[A,p]=o.useState(""),[R,f]=o.useState(""),[U,L]=o.useState([]),[_,T]=o.useState(""),[F,P]=o.useState({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),h=(t,n)=>{P(v=>({...v,[t]:n}))},m=t=>{if(!(!t||t.trim()===""))try{const n=te(t,"yyyy-MM-dd",new Date);if(b(n))return n;const v=new Date(t);return b(v)?v:void 0}catch(n){console.warn("Date parsing error:",n);return}},d=t=>{if(!t||t.trim()==="")return"";const n=m(t);return n&&b(n)?u(n,"yyyy-MM-dd"):""},{data:a,setData:l,put:K,processing:w,errors:r}=ee({property_id:s.property_id?.toString()||"",unit_name:s.unit_name||"",tenants:s.tenants||"",lease_start:d(s.lease_start),lease_end:d(s.lease_end),count_beds:s.count_beds?.toString()||"",count_baths:s.count_baths?.toString()||"",lease_status:s.lease_status||"",monthly_rent:s.monthly_rent?.toString()||"",recurring_transaction:s.recurring_transaction||"",utility_status:s.utility_status||"",account_number:s.account_number||"",insurance:s.insurance||"",insurance_expiration_date:d(s.insurance_expiration_date)});o.useEffect(()=>{if(C&&s.property_id&&x){const t=x.find(n=>n.id===s.property_id);t&&t.city_id&&T(t.city_id.toString())}},[C,s.property_id,x]),o.useEffect(()=>{if(_&&x){const t=x.filter(n=>n.city_id?.toString()===_);L(t),a.property_id&&!t.find(n=>n.id.toString()===a.property_id)&&l("property_id","")}else L([])},[_,x]),o.useEffect(()=>{s&&l({property_id:s.property_id?.toString()||"",unit_name:s.unit_name||"",tenants:s.tenants||"",lease_start:d(s.lease_start),lease_end:d(s.lease_end),count_beds:s.count_beds?.toString()||"",count_baths:s.count_baths?.toString()||"",lease_status:s.lease_status||"",monthly_rent:s.monthly_rent?.toString()||"",recurring_transaction:s.recurring_transaction||"",utility_status:s.utility_status||"",account_number:s.account_number||"",insurance:s.insurance||"",insurance_expiration_date:d(s.insurance_expiration_date)})},[s]);const Q=t=>{T(t),N(""),p("")},W=t=>{l("property_id",t),p("")},X=t=>{l("unit_name",t.target.value),f("")},$=t=>{t.preventDefault(),N(""),p(""),f("");let n=!1;(!a.property_id||a.property_id.trim()==="")&&(p("Please select a property before submitting the form."),g.current&&(g.current.focus(),g.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),(!a.unit_name||a.unit_name.trim()==="")&&(f("Please enter a unit name before submitting the form."),y.current&&(y.current.focus(),y.current.scrollIntoView({behavior:"smooth",block:"center"})),n=!0),!n&&K(route("units.update",s.id),{onSuccess:()=>{N(""),p(""),f(""),P({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),S(!1),J?.()}})},Z=()=>{l({property_id:s.property_id?.toString()||"",unit_name:s.unit_name||"",tenants:s.tenants||"",lease_start:d(s.lease_start),lease_end:d(s.lease_end),count_beds:s.count_beds?.toString()||"",count_baths:s.count_baths?.toString()||"",lease_status:s.lease_status||"",monthly_rent:s.monthly_rent?.toString()||"",recurring_transaction:s.recurring_transaction||"",utility_status:s.utility_status||"",account_number:s.account_number||"",insurance:s.insurance||"",insurance_expiration_date:d(s.insurance_expiration_date)}),N(""),p(""),f(""),P({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),S(!1)};return e.jsx(se,{open:C,onOpenChange:S,modal:!1,children:e.jsx(ae,{size:"half",title:`Edit Unit - ${s.unit_name}`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsx("div",{className:"mb-6 p-4 bg-secondary border border-border rounded-lg",children:e.jsxs("p",{className:"text-sm text-secondary-foreground",children:[e.jsx("strong",{children:"Note:"})," Vacant, Listed, and Total Applications are automatically calculated based on your inputs."]})}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"city",className:"text-base font-semibold",children:"City *"})}),e.jsxs(O,{onValueChange:Q,value:_,children:[e.jsx(z,{children:e.jsx(B,{placeholder:"Select a city"})}),e.jsx(Y,{children:H?.map(t=>e.jsx(G,{value:t.id.toString(),children:t.city},t.id))||[]})]}),M&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:M})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"property_id",className:"text-base font-semibold",children:"Property *"})}),e.jsxs(O,{onValueChange:W,value:a.property_id,disabled:!_||U.length===0,children:[e.jsx(z,{ref:g,children:e.jsx(B,{placeholder:_?"Select property":"Select city first"})}),e.jsx(Y,{children:U?.map(t=>e.jsx(G,{value:t.id.toString(),children:t.property_name},t.id))||[]})]}),r.property_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.property_id}),A&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:A})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-purple-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"unit_name",className:"text-base font-semibold",children:"Unit Name *"})}),e.jsx(c,{id:"unit_name",ref:y,value:a.unit_name,onChange:X,placeholder:"Enter unit name"}),r.unit_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.unit_name}),R&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:R})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"tenants",className:"text-base font-semibold",children:"Tenants"})}),e.jsx(c,{id:"tenants",value:a.tenants,onChange:t=>l("tenants",t.target.value),placeholder:"Enter tenant names"}),r.tenants&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.tenants})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"lease_start",className:"text-base font-semibold",children:"Lease Start"})}),e.jsxs(D,{open:F.lease_start,onOpenChange:t=>h("lease_start",t),modal:!1,children:[e.jsx(E,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:`w-full justify-start text-left font-normal ${!a.lease_start&&"text-muted-foreground"}`,children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),a.lease_start&&a.lease_start.trim()!==""?(()=>{const t=m(a.lease_start);return t?u(t,"PPP"):"Pick a date"})():"Pick a date"]})}),e.jsx(V,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(k,{mode:"single",selected:m(a.lease_start),onSelect:t=>{t&&b(t)&&(l("lease_start",u(t,"yyyy-MM-dd")),h("lease_start",!1))},initialFocus:!0})})]}),r.lease_start&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.lease_start})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"lease_end",className:"text-base font-semibold",children:"Lease End"})}),e.jsxs(D,{open:F.lease_end,onOpenChange:t=>h("lease_end",t),modal:!1,children:[e.jsx(E,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:`w-full justify-start text-left font-normal ${!a.lease_end&&"text-muted-foreground"}`,children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),a.lease_end&&a.lease_end.trim()!==""?(()=>{const t=m(a.lease_end);return t?u(t,"PPP"):"Pick a date"})():"Pick a date"]})}),e.jsx(V,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(k,{mode:"single",selected:m(a.lease_end),onSelect:t=>{t&&b(t)&&(l("lease_end",u(t,"yyyy-MM-dd")),h("lease_end",!1))},initialFocus:!0})})]}),r.lease_end&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.lease_end})]}),e.jsx("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"count_beds",className:"text-base font-semibold",children:"Count Beds"}),e.jsx(c,{id:"count_beds",type:"number",step:"0.5",min:"0",value:a.count_beds,onChange:t=>l("count_beds",t.target.value),placeholder:"Number of beds"}),r.count_beds&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.count_beds})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"count_baths",className:"text-base font-semibold",children:"Count Baths"}),e.jsx(c,{id:"count_baths",type:"number",step:"0.5",min:"0",value:a.count_baths,onChange:t=>l("count_baths",t.target.value),placeholder:"Number of baths"}),r.count_baths&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.count_baths})]})]})}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"lease_status",className:"text-base font-semibold",children:"Lease Status"})}),e.jsx(q,{value:a.lease_status,onValueChange:t=>l("lease_status",t),name:"lease_status",options:[{value:"Fixed",label:"Fixed"},{value:"Fixed with roll over",label:"Fixed with roll over"},{value:"At will",label:"At will"}]}),r.lease_status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.lease_status})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-red-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"monthly_rent",className:"text-base font-semibold",children:"Monthly Rent"})}),e.jsx(c,{id:"monthly_rent",type:"number",step:"0.01",min:"0",value:a.monthly_rent,onChange:t=>l("monthly_rent",t.target.value),placeholder:"0.00"}),r.monthly_rent&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.monthly_rent})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-yellow-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"recurring_transaction",className:"text-base font-semibold",children:"Recurring Transaction"})}),e.jsx(c,{id:"recurring_transaction",value:a.recurring_transaction,onChange:t=>l("recurring_transaction",t.target.value),placeholder:"Transaction details"}),r.recurring_transaction&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.recurring_transaction})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-cyan-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"utility_status",className:"text-base font-semibold",children:"Utility Status"})}),e.jsx(c,{id:"utility_status",value:a.utility_status,onChange:t=>l("utility_status",t.target.value),placeholder:"e.g., Included, Tenant Responsible"}),r.utility_status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.utility_status})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-gray-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"account_number",className:"text-base font-semibold",children:"Account Number"})}),e.jsx(c,{id:"account_number",value:a.account_number,onChange:t=>l("account_number",t.target.value),placeholder:"Account or reference number"}),r.account_number&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.account_number})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-violet-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"insurance",className:"text-base font-semibold",children:"Insurance"})}),e.jsx(q,{value:a.insurance,onValueChange:t=>l("insurance",t),name:"insurance",options:[{value:"Yes",label:"Yes"},{value:"No",label:"No"}]}),r.insurance&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.insurance})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-rose-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(i,{htmlFor:"insurance_expiration_date",className:"text-base font-semibold",children:"Insurance Expiration Date"})}),e.jsxs(D,{open:F.insurance_expiration_date,onOpenChange:t=>h("insurance_expiration_date",t),modal:!1,children:[e.jsx(E,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:`w-full justify-start text-left font-normal ${!a.insurance_expiration_date&&"text-muted-foreground"}`,children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),a.insurance_expiration_date&&a.insurance_expiration_date.trim()!==""?(()=>{const t=m(a.insurance_expiration_date);return t?u(t,"PPP"):"Pick a date"})():"Pick a date"]})}),e.jsx(V,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(k,{mode:"single",selected:m(a.insurance_expiration_date),onSelect:t=>{t&&b(t)&&(l("insurance_expiration_date",u(t,"yyyy-MM-dd")),h("insurance_expiration_date",!1))},initialFocus:!0})})]}),r.insurance_expiration_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.insurance_expiration_date})]}),e.jsxs("div",{className:"p-4 bg-muted border border-border rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Current Calculated Values:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Vacant:"}),e.jsx("span",{className:`ml-2 px-2 py-1 text-xs font-semibold rounded-full ${s.vacant==="Yes"?"bg-destructive text-destructive-foreground":"bg-chart-1 text-primary-foreground"}`,children:s.vacant})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Listed:"}),e.jsx("span",{className:`ml-2 px-2 py-1 text-xs font-semibold rounded-full ${s.listed==="Yes"?"bg-chart-1 text-primary-foreground":"bg-muted text-muted-foreground"}`,children:s.listed})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Applications:"}),e.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-semibold rounded-full bg-chart-2 text-primary-foreground",children:s.total_applications||0})]})]})]})]})}),e.jsx(re,{className:"border-t bg-background",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{type:"submit",onClick:$,disabled:w,className:"flex-1",children:w?"Updating...":"Update Unit"}),e.jsx(j,{type:"button",variant:"outline",onClick:Z,disabled:w,className:"flex-1",children:"Cancel"})]})})]})})})}export{Le as default};
