import{r as i,b as B,j as r}from"./app-B8FMPvUf.js";import{D as G,a as H,b as J}from"./drawer-By-qy253.js";import{B as P}from"./button-DIZZiQM7.js";import K from"./LocationSection-DHX-CKJ9.js";import Q from"./DateFieldsSection-CH9KHAfm.js";import W from"./PropertyDetailsSection-KU-UA0tr.js";import X from"./StatusFieldsSection-bVw1BU4v.js";import"./app-BrEbHAEe.js";import"./index-fZywndxp.js";import"./index-C_zQ9kkn.js";import"./index-CA_GOVUL.js";import"./index-Ci8SDCQb.js";import"./index-beSbUtJq.js";import"./index-CAMxjZm0.js";import"./index-3cnTBEqV.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-krc9GB28.js";import"./createLucideIcon-C8-5KvOO.js";import"./FormField-BB_QbiaX.js";import"./label-mSIjHkAE.js";import"./TextInputField-FD8BVRQT.js";import"./input-DGLwPUn8.js";import"./popover-BMQC-RgO.js";import"./index-9ieSGg2S.js";import"./command-Byz7UfAg.js";import"./search-CLz9Z_Gu.js";import"./chevrons-up-down-BYxCyuCA.js";import"./check-BVaiT64F.js";import"./DatePickerField-BIygKQ9Q.js";import"./calendar-CzDWs5lf.js";import"./format-PYUiRpxY.js";import"./chevron-left-nbVEm8OA.js";import"./chevron-right-Ccb_WXJ_.js";import"./chevron-down-C7VOkDBv.js";import"./calendar-DesMu7qT.js";import"./RadioGroupField-D963LPsH.js";import"./radioGroup-CuIQOkQ9.js";import"./index-CguEkJq1.js";import"./index-BlkGWg27.js";import"./TextAreaField--R4tWc5y.js";import"./textarea-fJ4locy1.js";function Oe({cities:N,propertiesByCityId:y,unitsByPropertyId:g,open:R,onOpenChange:b,onSuccess:k,redirectContext:l}){const u=i.useRef(null),c=i.useRef(null),p=i.useRef(null),[I,o]=i.useState({city:"",property:"",unit:""}),[v,S]=i.useState(null),[C,f]=i.useState(null),[x,m]=i.useState(null),[E,h]=i.useState([]),[U,_]=i.useState([]),[V,F]=i.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:s,setData:a,post:M,processing:j,errors:d,reset:T,transform:A}=B({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",all_the_devices_are_off:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",renter:"",move_out_form:"",utility_type:""}),O=n=>{const e=parseInt(n);S(e),f(null),m(null),a("unit_id",null),o(t=>({...t,city:"",property:"",unit:""})),e&&y[e]?h(y[e]):h([]),_([])},z=n=>{const e=parseInt(n);f(e),m(null),a("unit_id",null),o(t=>({...t,property:"",unit:""})),e&&g[e]?_(g[e]):_([])},L=n=>{const e=parseInt(n);m(e),a("unit_id",e),o(t=>({...t,unit:""}))},q=n=>{F(e=>({...e,[n]:!e[n]}))},D=n=>{n.preventDefault(),o({city:"",property:"",unit:""});let e=!1;v||(o(t=>({...t,city:"Please select a city before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),C||(o(t=>({...t,property:"Please select a property before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),(!x||!s.unit_id)&&(o(t=>({...t,unit:"Please select a unit before submitting the form."})),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),!e&&(A(t=>({...t,move_out_date:t.move_out_date?.trim()?t.move_out_date:null,date_lease_ending_on_buildium:t.date_lease_ending_on_buildium?.trim()?t.date_lease_ending_on_buildium:null,date_utility_put_under_our_name:t.date_utility_put_under_our_name?.trim()?t.date_utility_put_under_our_name:null,redirect_city:l?.city??null,redirect_property:l?.property??null,redirect_unit:l?.unit??null,redirect_page:l?.page??null,redirect_perPage:l?.perPage??null})),M(route("move-out.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{w(),k?.()}}))},w=()=>{T(),S(null),f(null),m(null),o({city:"",property:"",unit:""}),h([]),_([]),b(!1)};return r.jsx(G,{open:R,onOpenChange:b,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Move-Out Record",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsx(K,{cities:N,availableProperties:E,availableUnits:U,selectedCity:v,selectedProperty:C,selectedUnit:x,validationErrors:I,cityRef:u,propertyRef:c,unitRef:p,onCityChange:O,onPropertyChange:z,onUnitChange:L,tenants:s.tenants,tenantsError:d.tenants,onTenantsChange:n=>a("tenants",n)}),r.jsx(Q,{data:s,errors:d,calendarStates:V,onCalendarToggle:q,onDataChange:a}),r.jsx(W,{data:s,errors:d,onDataChange:a}),r.jsx(X,{data:s,errors:d,onDataChange:a})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex gap-2 w-full",children:[r.jsx(P,{type:"button",variant:"outline",onClick:w,className:"flex-1",children:"Cancel"}),r.jsx(P,{type:"submit",onClick:D,disabled:j,className:"flex-1",children:j?"Creating...":"Create Move-Out Record"})]})})]})})})}export{Oe as default};
