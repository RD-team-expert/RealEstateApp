import{r as n,b as de,j as s}from"./app-DYme-6ST.js";import{B as $}from"./button-DygVteL_.js";import{D as le,a as ce,b as ue}from"./drawer-BC2XqbDZ.js";import me from"./CitySelector-B6DdW-WC.js";import _e from"./PropertySelector-CkmDSWma.js";import fe from"./UnitSelector-N89YSnFI.js";import pe from"./VendorSelector-JX9ouVyX.js";import A from"./DatePickerField-BhuJTKOg.js";import H from"./TextAreaField-Cmqse_Zu.js";import be from"./StatusRadioGroup-DMSAGQdp.js";import ge from"./UrgencyRadioGroup-D2Ry0Qms.js";import"./app-BxoA0TtB.js";import"./index-DAeyJQLn.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-BPUi24BT.js";import"./index-yvkaECEW.js";import"./index-B3RZid5o.js";import"./index-wTYJRjsu.js";import"./index-Dt2fvjT8.js";import"./index-DRjsfxtL.js";import"./x-xoZkVJyy.js";import"./createLucideIcon-Dwp8kkct.js";import"./select-CPtJWUF5.js";import"./index-Dc_FVRD7.js";import"./index-D6kz9xqy.js";import"./index-DZXKY85H.js";import"./index-x8Nhs1r4.js";import"./index-DYyhglSa.js";import"./index-CadWMiU4.js";import"./chevron-down-CDnjTFxC.js";import"./check-B5KXzRGR.js";import"./chevron-up-3w0W2Y4A.js";import"./FormSection-CAb8WspG.js";import"./label-Cs5jgoI2.js";import"./input-pR7fOcUW.js";import"./calendar-BWK2M4JP.js";import"./format-PYUiRpxY.js";import"./chevron-left-C0SnhLPd.js";import"./chevron-right-BQBVxicn.js";import"./popover-iS5_0AtM.js";import"./calendar-Bw6k_ssZ.js";import"./radioGroup-F0AlgpLY.js";function at({task:t,cities:J,units:K,vendors:v,unitsByCity:y,propertiesByCity:p,unitsByProperty:c,open:L,onOpenChange:R,onSuccess:M}){const S=n.useRef(null),x=n.useRef(null),C=n.useRef(null),V=n.useRef(null),j=n.useRef(null),[Q,b]=n.useState(""),[W,u]=n.useState(""),[X,_]=n.useState(""),[Y,g]=n.useState(""),[Z,h]=n.useState(""),[I,m]=n.useState([]),[B,f]=n.useState([]),[O,E]=n.useState([]),[d,P]=n.useState(t.city||""),[N,D]=n.useState(t.property_name||""),[,k]=n.useState(t.unit_name||""),[,T]=n.useState(t.vendor_name||""),[U,ee]=n.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),w=(e,r)=>{ee(l=>({...l,[e]:r}))},F=e=>{const r=v.find(l=>l.vendor_name===e);return r?r.id.toString():""},q=e=>{const r=K.find(l=>l.unit_name===e);return r?r.id.toString():""},{data:i,setData:o,put:te,processing:G,errors:a}=de({vendor_id:F(t.vendor_name||""),unit_id:q(t.unit_name||""),task_submission_date:t.task_submission_date??"",assigned_tasks:t.assigned_tasks??"",any_scheduled_visits:t.any_scheduled_visits??"",notes:t.notes??"",task_ending_date:t.task_ending_date??"",status:t.status??"",urgent:t.urgent??"No"});n.useEffect(()=>{t.city?(p[t.city]?f(p[t.city]):f([]),E(v),t.property_name&&c[t.city]&&c[t.city][t.property_name]?m(c[t.city][t.property_name]):y[t.city]?m(y[t.city]):m([])):(f([]),E([]),m([]))},[t.city,t.property_name,y,p,c,v]);const re=e=>{P(e),D(""),k(""),T(""),o("unit_id",""),o("vendor_id",""),b(""),u(""),_(""),e?(p[e]?f(p[e]):f([]),E(v)):(f([]),E([])),m([])},se=e=>{D(e),k(""),o("unit_id",""),u(""),d&&e&&c[d]&&c[d][e]?m(c[d][e]):m([])},ne=e=>{const r=I.find(l=>l.id.toString()===e);r&&(k(r.unit_name),o("unit_id",e),u(""))},ie=e=>{const r=O.find(l=>l.id.toString()===e);r&&(T(r.vendor_name),o("vendor_id",e),_(""))},oe=e=>{o("assigned_tasks",e.target.value),h("")},z=e=>{e.preventDefault(),b(""),u(""),_(""),g(""),h("");let r=!1;(!d||d.trim()==="")&&(b("Please select a city before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.unit_id||i.unit_id.trim()==="")&&(u("Please select a unit before submitting the form."),x.current&&(x.current.focus(),x.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.vendor_id||i.vendor_id.trim()==="")&&(_("Please select a vendor before submitting the form."),C.current&&(C.current.focus(),C.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.task_submission_date||i.task_submission_date.trim()==="")&&(g("Please select a task submission date before submitting the form."),V.current&&(V.current.focus(),V.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.assigned_tasks||i.assigned_tasks.trim()==="")&&(h("Please enter assigned tasks before submitting the form."),j.current&&(j.current.focus(),j.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),!r&&te(route("vendor-task-tracker.update",t.id),{onSuccess:()=>{b(""),u(""),_(""),g(""),h(""),R(!1),M?.()}})},ae=()=>{o({vendor_id:F(t.vendor_name||""),unit_id:q(t.unit_name||""),task_submission_date:t.task_submission_date??"",assigned_tasks:t.assigned_tasks??"",any_scheduled_visits:t.any_scheduled_visits??"",notes:t.notes??"",task_ending_date:t.task_ending_date??"",status:t.status??"",urgent:t.urgent??"No"}),P(t.city||""),D(t.property_name||""),k(t.unit_name||""),T(t.vendor_name||""),b(""),u(""),_(""),g(""),h(""),R(!1)};return s.jsx(le,{open:L,onOpenChange:R,modal:!1,children:s.jsx(ce,{size:"half",title:`Edit Vendor Task #${t.id}`,children:s.jsxs("div",{className:"flex h-full flex-col",children:[s.jsx("div",{className:"flex-1 overflow-auto p-6",children:s.jsxs("form",{onSubmit:z,className:"space-y-4",children:[s.jsx(me,{cities:J,selectedCity:d,onCityChange:re,cityRef:S,error:a.city,validationError:Q}),s.jsx(_e,{properties:B,selectedProperty:N,onPropertyChange:se,disabled:!d}),s.jsx(fe,{units:I,selectedUnitId:i.unit_id,onUnitChange:ne,unitRef:x,disabled:!N,error:a.unit_id,validationError:W}),s.jsx(pe,{vendors:O,selectedVendorId:i.vendor_id,onVendorChange:ie,vendorRef:C,disabled:!d,error:a.vendor_id,validationError:X}),s.jsx(A,{label:"Task Submission Date",required:!0,borderColor:"border-l-orange-500",value:i.task_submission_date,onChange:e=>{o("task_submission_date",e),g("")},dateRef:V,error:a.task_submission_date,validationError:Y,calendarOpen:U.task_submission_date,onCalendarOpenChange:e=>w("task_submission_date",e)}),s.jsx(A,{label:"Any Scheduled Visits",borderColor:"border-l-emerald-500",value:i.any_scheduled_visits,onChange:e=>o("any_scheduled_visits",e),error:a.any_scheduled_visits,calendarOpen:U.any_scheduled_visits,onCalendarOpenChange:e=>w("any_scheduled_visits",e)}),s.jsx(A,{label:"Task Ending Date",borderColor:"border-l-teal-500",value:i.task_ending_date,onChange:e=>o("task_ending_date",e),error:a.task_ending_date,calendarOpen:U.task_ending_date,onCalendarOpenChange:e=>w("task_ending_date",e)}),s.jsx(H,{label:"Assigned Tasks",required:!0,borderColor:"border-l-indigo-500",value:i.assigned_tasks,onChange:oe,textAreaRef:j,placeholder:"Describe the assigned tasks...",rows:3,error:a.assigned_tasks,validationError:Z}),s.jsx(H,{label:"Notes",borderColor:"border-l-pink-500",value:i.notes,onChange:e=>o("notes",e.target.value),placeholder:"Enter any additional notes...",rows:3,error:a.notes}),s.jsx(be,{value:i.status,onChange:e=>o("status",e),error:a.status}),s.jsx(ge,{value:i.urgent,onChange:e=>o("urgent",e),error:a.urgent})]})}),s.jsx(ue,{children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx($,{type:"button",variant:"outline",onClick:ae,className:"flex-1",children:"Cancel"}),s.jsx($,{type:"submit",onClick:z,disabled:G,className:"flex-1",children:G?"Updatingâ€¦":"Update Task"})]})})]})})})}export{at as default};
