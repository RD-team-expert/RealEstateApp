import{r as s,b as q,j as r}from"./app-IncGAUEB.js";import{B as A}from"./button-BZreYh_c.js";import{D as G,a as H,b as J}from"./drawer-BabOL_dj.js";import{CityPropertyUnitSelector as K}from"./CityPropertyUnitSelector-KHsLBnLH.js";import{ApplicantInformationSection as L}from"./ApplicantInformationSection-TQOxy_XM.js";import{StatusAndDateSection as M}from"./StatusAndDateSection-DEVyzZyv.js";import{AdditionalDetailsSection as Q}from"./AdditionalDetailsSection-CBVcdNCP.js";import"./app-DgqXL21p.js";import"./index-bCzQdt7o.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-CfKQ6yNG.js";import"./index-BWcAjI1y.js";import"./index-D0fQOWIr.js";import"./index-yZxLUvKN.js";import"./index-iNsZkCT-.js";import"./index-6KC1G_4u.js";import"./x-B_qSqN6z.js";import"./createLucideIcon-Ci0S1m_Z.js";import"./label-BhALl-XJ.js";import"./select-BqJlafxu.js";import"./index-Dc_FVRD7.js";import"./index-X0Rqfk2m.js";import"./index-DfV2_jol.js";import"./index-DfBxMdWp.js";import"./index-DizBXXCV.js";import"./chevron-down-uas8HWR-.js";import"./check-gd2_wZBq.js";import"./chevron-up-DtKhYrlV.js";import"./input-BKi6rfRv.js";import"./application-CnwOiERd.js";import"./calendar-UFpA7cIJ.js";import"./format-PYUiRpxY.js";import"./chevron-left-WEUqp8UO.js";import"./chevron-right-Dv0ELFzT.js";import"./popover-D0q3r5CP.js";import"./radioGroup-BhgCKDH3.js";import"./calendar-CBsjNrh9.js";import"./file-text-D45rT7Bs.js";function Ft({cities:P,properties:C,units:b,open:d,onOpenChange:v,onSuccess:D}){const l=s.useRef(null),[f,o]=s.useState({}),[x,h]=s.useState(null),[y,m]=s.useState(null),[N,c]=s.useState([]),[w,p]=s.useState([]),{data:i,setData:n,post:E,processing:g,errors:u,reset:_,clearErrors:S}=q({unit_id:null,name:"",co_signer:"",status:"New",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]});s.useEffect(()=>{d||(_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""))},[d]);const F=t=>{const e=parseInt(t);h(e),m(null),n("unit_id",null),o(a=>({...a,city:void 0,property:void 0,unit:void 0})),C[e]?c(C[e]):c([]),p([])},U=t=>{const e=parseInt(t);m(e),n("unit_id",null),o(a=>({...a,property:void 0,unit:void 0})),b[e]?p(b[e]):p([])},R=t=>{const e=parseInt(t);n("unit_id",e),o(a=>({...a,unit:void 0}))},V=t=>{n("name",t),o(e=>({...e,name:void 0}))},k=t=>{n("co_signer",t)},B=t=>{n("applicant_applied_from",t)},z=t=>{n("status",t),o(e=>({...e,status:void 0}))},j=t=>{t.preventDefault(),o({});let e=!1;const a={};if(x||(a.city="Please select a city before submitting the form.",e=!0),y||(a.property="Please select a property before submitting the form.",e=!0),i.unit_id||(a.unit="Please select a unit before submitting the form.",e=!0),(!i.name||i.name.trim()==="")&&(a.name="Please enter a name before submitting the form.",e=!0),(!i.status||i.status.trim()==="")&&(a.status="Please select a status before submitting the form.",e=!0),e){o(a);return}E(route("applications.store"),{onSuccess:()=>{I(),D?.()}})},I=()=>{_(),S(),o({}),h(null),m(null),c([]),p([]),l.current&&(l.current.value=""),v(!1)};return r.jsx(G,{open:d,onOpenChange:v,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Application",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:j,className:"space-y-4",children:[r.jsx(K,{cities:P,selectedCityId:x,selectedPropertyId:y,availableProperties:N,availableUnits:w,unitId:i.unit_id,onCityChange:F,onPropertyChange:U,onUnitChange:R,errors:u,validationErrors:f}),r.jsx(L,{name:i.name,coSigner:i.co_signer,applicantAppliedFrom:i.applicant_applied_from,onNameChange:V,onCoSignerChange:k,onApplicantAppliedFromChange:B,errors:u,validationErrors:f}),r.jsx(M,{status:i.status,date:i.date,onStatusChange:z,onDateChange:t=>n("date",t),errors:u,validationErrors:f}),r.jsx(Q,{stageInProgress:i.stage_in_progress,notes:i.notes,attachments:i.attachments,onStageInProgressChange:t=>n("stage_in_progress",t),onNotesChange:t=>n("notes",t),onAttachmentsChange:t=>n("attachments",t),fileInputRef:l,errors:u})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(A,{type:"button",variant:"outline",onClick:I,disabled:g,children:"Cancel"}),r.jsx(A,{type:"submit",onClick:j,disabled:g,children:g?"Creating...":"Create Application"})]})})]})})})}export{Ft as default};
