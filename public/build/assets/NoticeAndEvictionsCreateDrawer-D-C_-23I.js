import{r as c,b as de,j as e}from"./app-C79wt3tX.js";import{B as N}from"./createLucideIcon-C1z_f29J.js";import{P as T,a as U,f as _,p as y,b as k,C as A}from"./popover-EABh-nYt.js";import{D as oe,a as ce,b as me}from"./drawer-wgoO6h1K.js";import{I as xe}from"./input-BS89LrTW.js";import{L as l}from"./label-CArU7ATR.js";import{R as g}from"./radioGroup-4V0hsG5D.js";import{S,a as C,b as w,c as P,d as F}from"./select-4_arDXlR.js";import{C as O}from"./calendar-DZOiGQZc.js";import"./app-Do7cDRzv.js";import"./chevron-right-CkaRxpST.js";import"./index-DMpLQi-Z.js";import"./index-ChhieIKn.js";import"./index-DkjncacZ.js";import"./index-CkXl1I8e.js";import"./index-DLJGb8q0.js";import"./index-BUbw163t.js";function Ee({cities:$,properties:W,units:q,tenants:J,notices:K,open:I,onOpenChange:M,onSuccess:Q}){const[m,o]=c.useState({}),[x,D]=c.useState(null),[h,b]=c.useState(null),[u,p]=c.useState(null),[z,E]=c.useState([]),[L,v]=c.useState([]),[R,f]=c.useState([]),[V,X]=c.useState({date:!1,hearing_dates:!1,writ_date:!1}),j=(t,a)=>{X(i=>({...i,[t]:a}))},{data:s,setData:r,post:Y,processing:B,errors:n,reset:H}=de({tenant_id:null,status:"",date:"",type_of_notice:"",have_an_exception:"",note:"",evictions:"",sent_to_atorney:"",hearing_dates:"",evected_or_payment_plan:"",if_left:"",writ_date:""}),Z=t=>{const a=parseInt(t);D(a),b(null),p(null),r("tenant_id",null);const i=W.filter(d=>d.city_id===a);E(i),v([]),f([]),o(d=>({...d,city:"",property:"",unit:"",tenant:""}))},ee=t=>{const a=parseInt(t);b(a),p(null),r("tenant_id",null);const i=q.filter(d=>d.property_id===a);v(i),f([]),o(d=>({...d,property:"",unit:"",tenant:""}))},te=t=>{const a=parseInt(t);p(a),r("tenant_id",null);const i=J.filter(d=>d.unit_id===a);f(i),o(d=>({...d,unit:"",tenant:""}))},se=t=>{const a=parseInt(t);r("tenant_id",a),o(i=>({...i,tenant:""}))};c.useEffect(()=>{I&&(D(null),b(null),p(null),E([]),v([]),f([]),o({}))},[I]);const G=t=>{t.preventDefault(),o({});let a=!1;const i={};if(x||(i.city="Please select a city before submitting the form.",a=!0),h||(i.property="Please select a property before submitting the form.",a=!0),u||(i.unit="Please select a unit before submitting the form.",a=!0),s.tenant_id||(i.tenant="Please select a tenant before submitting the form.",a=!0),a){o(i);return}Y("/notice_and_evictions",{onSuccess:()=>{H(),D(null),b(null),p(null),E([]),v([]),f([]),o({}),M(!1),Q?.()},onError:d=>{console.log("Form submission errors:",d)}})},ae=()=>{H(),D(null),b(null),p(null),E([]),v([]),f([]),o({}),M(!1)},ne=()=>$.find(a=>a.id===x)?.city||"",le=()=>z.find(a=>a.id===h)?.property_name||"",re=()=>L.find(a=>a.id===u)?.unit_name||"",ie=()=>{const t=R.find(a=>a.id===s.tenant_id);return t?`${t.first_name} ${t.last_name}`:""};return e.jsx(oe,{open:I,onOpenChange:M,modal:!1,children:e.jsx(ce,{size:"half",title:"Create New Notice & Eviction",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"city",className:"text-base font-semibold",children:"City *"})}),e.jsxs(S,{onValueChange:Z,value:x?.toString()||"",children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select city"})}),e.jsx(P,{children:$.map(t=>e.jsx(F,{value:t.id.toString(),children:t.city},t.id))})]}),m.city&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.city})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"property",className:"text-base font-semibold",children:"Property *"})}),e.jsxs(S,{onValueChange:ee,value:h?.toString()||"",disabled:!x,children:[e.jsx(C,{className:x?"":"opacity-50",children:e.jsx(w,{placeholder:x?"Select property":"Select city first"})}),e.jsx(P,{children:z.map(t=>e.jsx(F,{value:t.id.toString(),children:t.property_name},t.id))})]}),m.property&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.property})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"unit",className:"text-base font-semibold",children:"Unit *"})}),e.jsxs(S,{onValueChange:te,value:u?.toString()||"",disabled:!h,children:[e.jsx(C,{className:h?"":"opacity-50",children:e.jsx(w,{placeholder:h?"Select unit":"Select property first"})}),e.jsx(P,{children:L.map(t=>e.jsx(F,{value:t.id.toString(),children:t.unit_name},t.id))})]}),m.unit&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.unit})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"tenant",className:"text-base font-semibold",children:"Tenant *"})}),e.jsxs(S,{onValueChange:se,value:s.tenant_id?.toString()||"",disabled:!u,children:[e.jsx(C,{className:u?"":"opacity-50",children:e.jsx(w,{placeholder:u?"Select tenant":"Select unit first"})}),e.jsx(P,{children:R.map(t=>e.jsxs(F,{value:t.id.toString(),children:[t.first_name," ",t.last_name]},t.id))})]}),n.tenant_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.tenant_id}),m.tenant&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.tenant})]}),(x||h||u||s.tenant_id)&&e.jsxs("div",{className:"rounded-lg border-l-4 border-l-gray-500 bg-gray-50 p-4",children:[e.jsx(l,{className:"text-base font-semibold text-gray-700",children:"Selection Summary"}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm text-gray-600",children:[x&&e.jsxs("p",{children:[e.jsx("strong",{children:"City:"})," ",ne()]}),h&&e.jsxs("p",{children:[e.jsx("strong",{children:"Property:"})," ",le()]}),u&&e.jsxs("p",{children:[e.jsx("strong",{children:"Unit:"})," ",re()]}),s.tenant_id&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tenant:"})," ",ie()]})]})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-purple-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"status",className:"text-base font-semibold",children:"Status"})}),e.jsx(g,{value:s.status,onValueChange:t=>r("status",t),name:"status",options:[{value:"Posted",label:"Posted"},{value:"Sent to representative",label:"Sent to representative"}]}),n.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.status})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"date",className:"text-base font-semibold",children:"Date"})}),e.jsxs(T,{open:V.date,onOpenChange:t=>j("date",t),modal:!1,children:[e.jsx(U,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.date&&"text-muted-foreground"}`,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),s.date?_(y(s.date,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(k,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(A,{mode:"single",selected:s.date?y(s.date,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(r("date",_(t,"yyyy-MM-dd")),j("date",!1))},initialFocus:!0})})]}),n.date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.date})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"type_of_notice",className:"text-base font-semibold",children:"Type of Notice"})}),e.jsxs(S,{onValueChange:t=>r("type_of_notice",t),value:s.type_of_notice,children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select type"})}),e.jsx(P,{children:K.map(t=>e.jsx(F,{value:t.notice_name,children:t.notice_name},t.id))})]}),n.type_of_notice&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.type_of_notice})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"have_an_exception",className:"text-base font-semibold",children:"Have An Exception?"})}),e.jsx(g,{value:s.have_an_exception,onValueChange:t=>r("have_an_exception",t),name:"have_an_exception"}),n.have_an_exception&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.have_an_exception})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"note",className:"text-base font-semibold",children:"Note"})}),e.jsx("textarea",{id:"note",value:s.note||"",onChange:t=>r("note",t.target.value),rows:3,placeholder:"Enter any notes...",className:"resize-vertical min-h-[100px] w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"}),n.note&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.note})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"evictions",className:"text-base font-semibold",children:"Evictions"})}),e.jsx(xe,{id:"evictions",value:s.evictions||"",onChange:t=>r("evictions",t.target.value),placeholder:"Enter evictions information"}),n.evictions&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.evictions})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-red-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"sent_to_atorney",className:"text-base font-semibold",children:"Sent to Attorney"})}),e.jsx(g,{value:s.sent_to_atorney,onValueChange:t=>r("sent_to_atorney",t),name:"sent_to_atorney"}),n.sent_to_atorney&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.sent_to_atorney})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-yellow-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"hearing_dates",className:"text-base font-semibold",children:"Hearing Dates"})}),e.jsxs(T,{open:V.hearing_dates,onOpenChange:t=>j("hearing_dates",t),modal:!1,children:[e.jsx(U,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.hearing_dates&&"text-muted-foreground"}`,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),s.hearing_dates?_(y(s.hearing_dates,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(k,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(A,{mode:"single",selected:s.hearing_dates?y(s.hearing_dates,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(r("hearing_dates",_(t,"yyyy-MM-dd")),j("hearing_dates",!1))},initialFocus:!0})})]}),n.hearing_dates&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.hearing_dates})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-cyan-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"evected_or_payment_plan",className:"text-base font-semibold",children:"Evected Or Payment Plan"})}),e.jsx(g,{value:s.evected_or_payment_plan,onValueChange:t=>r("evected_or_payment_plan",t),name:"evected_or_payment_plan",options:[{value:"Evected",label:"Evected"},{value:"Payment Plan",label:"Payment Plan"}]}),n.evected_or_payment_plan&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.evected_or_payment_plan})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-violet-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"if_left",className:"text-base font-semibold",children:"If Left?"})}),e.jsx(g,{value:s.if_left,onValueChange:t=>r("if_left",t),name:"if_left"}),n.if_left&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.if_left})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-slate-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(l,{htmlFor:"writ_date",className:"text-base font-semibold",children:"Writ Date"})}),e.jsxs(T,{open:V.writ_date,onOpenChange:t=>j("writ_date",t),modal:!1,children:[e.jsx(U,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:`w-full justify-start text-left font-normal ${!s.writ_date&&"text-muted-foreground"}`,children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),s.writ_date?_(y(s.writ_date,"yyyy-MM-dd",new Date),"PPP"):"Pick a date"]})}),e.jsx(k,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(A,{mode:"single",selected:s.writ_date?y(s.writ_date,"yyyy-MM-dd",new Date):void 0,onSelect:t=>{t&&(r("writ_date",_(t,"yyyy-MM-dd")),j("writ_date",!1))},initialFocus:!0})})]}),n.writ_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.writ_date})]})]})}),e.jsx(me,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{type:"button",variant:"outline",onClick:ae,className:"flex-1",children:"Cancel"}),e.jsx(N,{type:"submit",onClick:G,disabled:B,className:"flex-1",children:B?"Creating...":"Create Notice & Eviction"})]})})]})})})}export{Ee as default};
