import{r as n,b as de,j as s}from"./app-B8ebXpyL.js";import{B as $}from"./button-CPgLtvIU.js";import{D as le,a as ce,b as ue}from"./drawer-BGYUKi-8.js";import me from"./CitySelector-CKiEiq18.js";import _e from"./PropertySelector-Br-52IdR.js";import fe from"./UnitSelector-BRUsD8O2.js";import be from"./VendorSelector-BHOl6WZT.js";import A from"./DatePickerField-uk-QdtFD.js";import H from"./TextAreaField-D4AHl1Rd.js";import pe from"./StatusRadioGroup-MKCb5TOj.js";import ge from"./UrgencyRadioGroup-TOOXvd_1.js";import"./app-DzAncQ8Z.js";import"./index-BvTxALZe.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-D1eOqOTZ.js";import"./index-DAWwAdgX.js";import"./index-D-HIh1V3.js";import"./index-D14oVES4.js";import"./index-B1T6AYU9.js";import"./index-Ck7g32ef.js";import"./x-DoFGuxfS.js";import"./createLucideIcon-B4WReUhf.js";import"./select-B8s2DExj.js";import"./index-Dc_FVRD7.js";import"./index-B2KxWlhD.js";import"./index-7ugTB-P5.js";import"./index-Z2oIQlZU.js";import"./index-BCMuVr1f.js";import"./chevron-down-CWVENDnU.js";import"./check-BsIcLAQ3.js";import"./chevron-up-LAfsrV3l.js";import"./FormSection-3gGKRYuh.js";import"./label-nhRupGpP.js";import"./input-C70n0jI8.js";import"./calendar-2G-LkQ2N.js";import"./format-PYUiRpxY.js";import"./chevron-left-DmipREnY.js";import"./chevron-right-g-fM4TgC.js";import"./popover-B8Dlw1xh.js";import"./calendar-4DeXn0g1.js";import"./radioGroup-Bu6NMix8.js";function ot({task:t,cities:J,units:K,vendors:v,unitsByCity:y,propertiesByCity:b,unitsByProperty:c,open:L,onOpenChange:R,onSuccess:M}){const S=n.useRef(null),x=n.useRef(null),C=n.useRef(null),V=n.useRef(null),j=n.useRef(null),[Q,p]=n.useState(""),[W,u]=n.useState(""),[X,_]=n.useState(""),[Y,g]=n.useState(""),[Z,h]=n.useState(""),[I,m]=n.useState([]),[B,f]=n.useState([]),[O,E]=n.useState([]),[d,P]=n.useState(t.city||""),[N,D]=n.useState(t.property_name||""),[,k]=n.useState(t.unit_name||""),[,T]=n.useState(t.vendor_name||""),[U,ee]=n.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),w=(e,r)=>{ee(l=>({...l,[e]:r}))},F=e=>{const r=v.find(l=>l.vendor_name===e);return r?r.id.toString():""},q=e=>{const r=K.find(l=>l.unit_name===e);return r?r.id.toString():""},{data:i,setData:o,put:te,processing:G,errors:a}=de({vendor_id:F(t.vendor_name||""),unit_id:q(t.unit_name||""),task_submission_date:t.task_submission_date??"",assigned_tasks:t.assigned_tasks??"",any_scheduled_visits:t.any_scheduled_visits??"",notes:t.notes??"",task_ending_date:t.task_ending_date??"",status:t.status??"",urgent:t.urgent??"No"});n.useEffect(()=>{t.city?(b[t.city]?f(b[t.city]):f([]),E(v),t.property_name&&c[t.city]&&c[t.city][t.property_name]?m(c[t.city][t.property_name]):y[t.city]?m(y[t.city]):m([])):(f([]),E([]),m([]))},[t.city,t.property_name,y,b,c,v]);const re=e=>{P(e),D(""),k(""),T(""),o("unit_id",""),o("vendor_id",""),p(""),u(""),_(""),e?(b[e]?f(b[e]):f([]),E(v)):(f([]),E([])),m([])},se=e=>{D(e),k(""),o("unit_id",""),u(""),d&&e&&c[d]&&c[d][e]?m(c[d][e]):m([])},ne=e=>{const r=I.find(l=>l.id.toString()===e);r&&(k(r.unit_name),o("unit_id",e),u(""))},ie=e=>{const r=O.find(l=>l.id.toString()===e);r&&(T(r.vendor_name),o("vendor_id",e),_(""))},oe=e=>{o("assigned_tasks",e.target.value),h("")},z=e=>{e.preventDefault(),p(""),u(""),_(""),g(""),h("");let r=!1;(!d||d.trim()==="")&&(p("Please select a city before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.unit_id||i.unit_id.trim()==="")&&(u("Please select a unit before submitting the form."),x.current&&(x.current.focus(),x.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.vendor_id||i.vendor_id.trim()==="")&&(_("Please select a vendor before submitting the form."),C.current&&(C.current.focus(),C.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.task_submission_date||i.task_submission_date.trim()==="")&&(g("Please select a task submission date before submitting the form."),V.current&&(V.current.focus(),V.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!i.assigned_tasks||i.assigned_tasks.trim()==="")&&(h("Please enter assigned tasks before submitting the form."),j.current&&(j.current.focus(),j.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),!r&&te(route("vendor-task-tracker.update",t.id),{onSuccess:()=>{p(""),u(""),_(""),g(""),h(""),R(!1),M?.()}})},ae=()=>{o({vendor_id:F(t.vendor_name||""),unit_id:q(t.unit_name||""),task_submission_date:t.task_submission_date??"",assigned_tasks:t.assigned_tasks??"",any_scheduled_visits:t.any_scheduled_visits??"",notes:t.notes??"",task_ending_date:t.task_ending_date??"",status:t.status??"",urgent:t.urgent??"No"}),P(t.city||""),D(t.property_name||""),k(t.unit_name||""),T(t.vendor_name||""),p(""),u(""),_(""),g(""),h(""),R(!1)};return s.jsx(le,{open:L,onOpenChange:R,modal:!1,children:s.jsx(ce,{size:"half",title:`Edit Vendor Task #${t.id}`,children:s.jsxs("div",{className:"flex h-full flex-col",children:[s.jsx("div",{className:"flex-1 overflow-auto p-6",children:s.jsxs("form",{onSubmit:z,className:"space-y-4",children:[s.jsx(me,{cities:J,selectedCity:d,onCityChange:re,cityRef:S,error:a.city,validationError:Q}),s.jsx(_e,{properties:B,selectedProperty:N,onPropertyChange:se,disabled:!d}),s.jsx(fe,{units:I,selectedUnitId:i.unit_id,onUnitChange:ne,unitRef:x,disabled:!N,error:a.unit_id,validationError:W}),s.jsx(be,{vendors:O,selectedVendorId:i.vendor_id,onVendorChange:ie,vendorRef:C,disabled:!d,error:a.vendor_id,validationError:X}),s.jsx(A,{label:"Task Submission Date",required:!0,borderColor:"border-l-orange-500",value:i.task_submission_date,onChange:e=>{o("task_submission_date",e),g("")},dateRef:V,error:a.task_submission_date,validationError:Y,calendarOpen:U.task_submission_date,onCalendarOpenChange:e=>w("task_submission_date",e)}),s.jsx(A,{label:"Any Scheduled Visits",borderColor:"border-l-emerald-500",value:i.any_scheduled_visits,onChange:e=>o("any_scheduled_visits",e),error:a.any_scheduled_visits,calendarOpen:U.any_scheduled_visits,onCalendarOpenChange:e=>w("any_scheduled_visits",e)}),s.jsx(A,{label:"Task Ending Date",borderColor:"border-l-teal-500",value:i.task_ending_date,onChange:e=>o("task_ending_date",e),error:a.task_ending_date,calendarOpen:U.task_ending_date,onCalendarOpenChange:e=>w("task_ending_date",e)}),s.jsx(H,{label:"Assigned Tasks",required:!0,borderColor:"border-l-indigo-500",value:i.assigned_tasks,onChange:oe,textAreaRef:j,placeholder:"Describe the assigned tasks...",rows:3,error:a.assigned_tasks,validationError:Z}),s.jsx(H,{label:"Notes",borderColor:"border-l-pink-500",value:i.notes,onChange:e=>o("notes",e.target.value),placeholder:"Enter any additional notes...",rows:3,error:a.notes}),s.jsx(pe,{value:i.status,onChange:e=>o("status",e),error:a.status}),s.jsx(ge,{value:i.urgent,onChange:e=>o("urgent",e),error:a.urgent})]})}),s.jsx(ue,{children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx($,{type:"button",variant:"outline",onClick:ae,className:"flex-1",children:"Cancel"}),s.jsx($,{type:"submit",onClick:z,disabled:G,className:"flex-1",children:G?"Updatingâ€¦":"Update Task"})]})})]})})})}export{ot as default};
