import{r as S,a as L,j as e,H as $,L as g,b as f}from"./app-BM6QPhCs.js";import{u as I,A as D}from"./app-layout-CFtgqb2g.js";import{B as x}from"./app-logo-icon-_BgUcEZ_.js";import{I as j}from"./input-DxItmhPy.js";import{C as i,c as d,a as T,b as _}from"./card-CBl_kNDF.js";import{P as H,T as R,a as O,b as V,c as n,d as k,e as c,f as z}from"./table-BtCT9Bdr.js";import{D as B}from"./download-DPRof4Hp.js";import{E as F}from"./eye-pC2j2P_R.js";import{S as U}from"./square-pen-DMp9Pa9u.js";import"./app-EMhG3jeb.js";import"./index-_PhYekxG.js";import"./index-DSqKqkft.js";const W=(b,t="vendors.csv")=>{const p=[["ID","City","Vendor Name","Number","Email","Service Type"].join(","),...b.map(a=>[a.id,`"${a.city}"`,`"${a.vendor_name}"`,`"${a.number||""}"`,`"${a.email||""}"`,`"${a.service_type}"`].join(","))].join(`
`),v=new Blob([p],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),m=URL.createObjectURL(v);r.setAttribute("href",m),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(m)};function re({auth:b,vendors:t,statistics:l,filters:p,cities:v}){const[r,m]=S.useState(p),[a,N]=S.useState(!1),{flash:h}=L().props,{hasPermission:y,hasAnyPermission:C,hasAllPermissions:w}=I(),u=(s,o)=>{const E={...r,[s]:o};m(E),f.get(route("vendors.index"),E,{preserveState:!0,preserveScroll:!0})},P=s=>{confirm("Are you sure you want to delete this vendor?")&&f.delete(route("vendors.destroy",s.id))},A=()=>{if(t.data.length===0){alert("No data to export");return}N(!0);try{const s=`vendors-${new Date().toISOString().split("T")[0]}.csv`;W(t.data,s)}catch(s){console.error("Export failed:",s),alert("Export failed. Please try again.")}finally{N(!1)}};return e.jsxs(D,{children:[e.jsx($,{title:"Vendors"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[h?.success&&e.jsx("div",{className:"mb-4 bg-chart-1/20 border border-chart-1 text-chart-1 px-4 py-3 rounded",children:h.success}),h?.error&&e.jsx("div",{className:"mb-4 bg-destructive/20 border border-destructive text-destructive px-4 py-3 rounded",children:h.error}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsx(i,{children:e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Total Vendors"}),e.jsx("p",{className:"text-3xl font-bold text-primary",children:l.total})]})}),e.jsx(i,{children:e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"With Email"}),e.jsx("p",{className:"text-3xl font-bold text-chart-1",children:l.with_email})]})}),e.jsx(i,{children:e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"With Phone"}),e.jsx("p",{className:"text-3xl font-bold text-chart-2",children:l.with_number})]})}),e.jsx(i,{children:e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Cities"}),e.jsx("p",{className:"text-3xl font-bold text-chart-3",children:Object.keys(l.city_counts).length})]})}),e.jsxs(i,{children:[e.jsx(T,{children:e.jsx(_,{className:"text-lg",children:"Vendors by City"})}),e.jsx(d,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:Object.entries(l.city_counts).map(([s,o])=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:s}),e.jsx("p",{className:"text-xl font-bold text-primary",children:o})]},s))})})]})]}),e.jsxs(i,{className:"mt-6",children:[e.jsxs(T,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(_,{className:"text-2xl",children:"Vendors List"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:A,disabled:a||t.data.length===0,className:"flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),a?"Exporting...":"Export CSV"]}),w(["vendors.create","vendors.store"])&&e.jsx(g,{href:route("vendors.create"),children:e.jsxs(x,{children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Vendor"]})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(j,{type:"text",placeholder:"City",value:r.city||"",onChange:s=>u("city",s.target.value)}),e.jsx(j,{type:"text",placeholder:"Vendor Name",value:r.vendor_name||"",onChange:s=>u("vendor_name",s.target.value)}),e.jsx(j,{type:"text",placeholder:"Number",value:r.number||"",onChange:s=>u("number",s.target.value)}),e.jsx(j,{type:"email",placeholder:"Email",value:r.email||"",onChange:s=>u("email",s.target.value)})]})})]}),e.jsxs(d,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(R,{children:[e.jsx(O,{children:e.jsxs(V,{children:[e.jsx(n,{children:"City"}),e.jsx(n,{children:"Vendor Name"}),e.jsx(n,{children:"Number"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Service Type"}),C(["vendors.edit","vendors.show","vendors.update","vendors.destroy"])&&e.jsx(n,{children:"Actions"})]})}),e.jsx(k,{children:t.data.map(s=>e.jsxs(V,{className:"hover:bg-muted/50",children:[e.jsx(c,{className:"font-medium",children:s.city}),e.jsx(c,{children:s.vendor_name}),e.jsx(c,{children:s.number||"-"}),e.jsx(c,{children:s.email?e.jsx("a",{href:`mailto:${s.email}`,className:"text-primary hover:text-primary/80",children:s.email}):"-"}),e.jsx(c,{children:s.service_type}),C(["vendors.edit","vendors.show","vendors.update","vendors.destroy"])&&e.jsx(c,{children:e.jsxs("div",{className:"flex gap-1",children:[y("vendors.show")&&e.jsx(g,{href:route("vendors.show",s.id),children:e.jsx(x,{variant:"outline",size:"sm",children:e.jsx(F,{className:"h-4 w-4"})})}),w(["vendors.edit","vendors.update"])&&e.jsx(g,{href:route("vendors.edit",s.id),children:e.jsx(x,{variant:"outline",size:"sm",children:e.jsx(U,{className:"h-4 w-4"})})}),y("vendors.destroy")&&e.jsx(x,{variant:"outline",size:"sm",onClick:()=>P(s),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:e.jsx(z,{className:"h-4 w-4"})})]})})]},s.id))})]})}),t.data.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-lg",children:"No vendors found."}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search filters."})]}),t.last_page>1&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("nav",{className:"flex space-x-2",children:t.links.map((s,o)=>e.jsx("button",{onClick:()=>s.url&&f.get(s.url),disabled:!s.url,className:`px-3 py-2 text-sm rounded ${s.active?"bg-primary text-primary-foreground":s.url?"bg-muted text-foreground hover:bg-accent":"bg-muted text-muted-foreground cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},o))})}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground text-center",children:["Showing ",t.from||0," to ",t.to||0," of ",t.total||0," vendors"]})]})]})]})})]})}export{re as default};
