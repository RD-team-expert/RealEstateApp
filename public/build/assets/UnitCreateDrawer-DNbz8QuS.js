import{r as s,b as A,j as r}from"./app-B8ebXpyL.js";import{B as E}from"./button-CPgLtvIU.js";import{D as O,a as z,b as M}from"./drawer-BGYUKi-8.js";import q from"./CitySelection-BZaIV2Vk.js";import G from"./PropertySelection-C9XVJTWp.js";import H from"./UnitDetails-la9_m4c_.js";import J from"./TenantDetails-BdC5qW1L.js";import K from"./LeaseDates-z6oIAbcf.js";import Q from"./UnitSpecifications-CW1TNI2z.js";import W from"./LeaseStatus-D2P1OLzh.js";import X from"./FinancialInformation-VLEQrtIR.js";import Y from"./UtilityInformation-3O7yQDab.js";import Z from"./InsuranceInformation-nMEZgril.js";import $ from"./NewLease-D9crHJYf.js";import"./app-DzAncQ8Z.js";import"./index-BvTxALZe.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-D1eOqOTZ.js";import"./index-DAWwAdgX.js";import"./index-D-HIh1V3.js";import"./index-D14oVES4.js";import"./index-B1T6AYU9.js";import"./index-Ck7g32ef.js";import"./x-DoFGuxfS.js";import"./createLucideIcon-B4WReUhf.js";import"./label-nhRupGpP.js";import"./popover-B8Dlw1xh.js";import"./index-Z2oIQlZU.js";import"./command-Cbn40CgF.js";import"./search-B07AvWR6.js";import"./chevrons-up-down-CIZQ0EQ8.js";import"./check-BsIcLAQ3.js";import"./input-C70n0jI8.js";import"./calendar-2G-LkQ2N.js";import"./format-PYUiRpxY.js";import"./chevron-left-DmipREnY.js";import"./chevron-right-g-fM4TgC.js";import"./chevron-down-CWVENDnU.js";import"./calendar-4DeXn0g1.js";import"./radioGroup-Bu6NMix8.js";import"./index-B2KxWlhD.js";import"./index-BCMuVr1f.js";function qe({cities:v,properties:d,open:w,onOpenChange:f,onSuccess:D,redirectState:h}){const u=s.useRef(null),p=s.useRef(null),[I,m]=s.useState(""),[U,o]=s.useState(""),[P,l]=s.useState(""),[L,_]=s.useState([]),[c,x]=s.useState(""),[b,C]=s.useState({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),y=(e,i)=>{C(g=>({...g,[e]:i}))},{data:t,setData:a,post:R,processing:S,errors:n,reset:j,transform:V}=A({property_id:"",unit_name:"",tenants:"",lease_start:"",lease_end:"",count_beds:"",count_baths:"",lease_status:"",is_new_lease:"",monthly_rent:"",recurring_transaction:"",utility_status:"",account_number:"",insurance:"",insurance_expiration_date:""});s.useEffect(()=>{if(c&&d){const e=d.filter(i=>i.city_id?.toString()===c);_(e),t.property_id&&!e.find(i=>i.id.toString()===t.property_id)&&a("property_id","")}else _([]),a("property_id","")},[c,d]);const B=e=>{x(e),m(""),o("")},k=e=>{a("property_id",e),o("")},T=e=>{a("unit_name",e.target.value),l("")};s.useEffect(()=>{t.insurance==="No"&&(a("insurance_expiration_date",""),y("insurance_expiration_date",!1))},[t.insurance]);const N=e=>{e.preventDefault(),m(""),o(""),l("");let i=!1;(!t.property_id||t.property_id.trim()==="")&&(o("Please select a property before submitting the form."),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!t.unit_name||t.unit_name.trim()==="")&&(l("Please enter a unit name before submitting the form."),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),!i&&(t.insurance==="No"&&t.insurance_expiration_date!==""&&a("insurance_expiration_date",""),V(g=>({...g,redirect:{filters:h.filters,per_page:h.per_page,page:h.page}})),R(route("units.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{j(),m(""),o(""),l(""),_([]),x(""),C({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),f(!1),D?.()}}))},F=()=>{j(),m(""),o(""),l(""),_([]),x(""),C({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),f(!1)};return r.jsx(O,{open:w,onOpenChange:f,modal:!1,children:r.jsx(z,{size:"half",title:"Create New Unit",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:N,className:"space-y-4",children:[r.jsx(q,{cities:v,selectedCityId:c,onCityChange:B,validationError:I}),r.jsx(G,{ref:u,availableProperties:L,selectedCityId:c,propertyId:t.property_id,onPropertyChange:k,error:n.property_id,validationError:U}),r.jsx(H,{ref:p,unitName:t.unit_name,onUnitNameChange:T,error:n.unit_name,validationError:P}),r.jsx(J,{tenants:t.tenants,onTenantsChange:e=>a("tenants",e),error:n.tenants}),r.jsx(K,{leaseStart:t.lease_start,leaseEnd:t.lease_end,calendarStates:b,onLeaseStartChange:e=>a("lease_start",e),onLeaseEndChange:e=>a("lease_end",e),onCalendarOpenChange:y,errors:n}),r.jsx(Q,{countBeds:t.count_beds,countBaths:t.count_baths,onCountBedsChange:e=>a("count_beds",e),onCountBathsChange:e=>a("count_baths",e),errors:n}),r.jsx(W,{leaseStatus:t.lease_status,onLeaseStatusChange:e=>a("lease_status",e),error:n.lease_status}),r.jsx($,{isNewLease:t.is_new_lease,onIsNewLeaseChange:e=>a("is_new_lease",e),error:n.is_new_lease}),r.jsx(X,{monthlyRent:t.monthly_rent,recurringTransaction:t.recurring_transaction,onMonthlyRentChange:e=>a("monthly_rent",e),onRecurringTransactionChange:e=>a("recurring_transaction",e),errors:n}),r.jsx(Y,{utilityStatus:t.utility_status,accountNumber:t.account_number,onUtilityStatusChange:e=>a("utility_status",e),onAccountNumberChange:e=>a("account_number",e),errors:n}),r.jsx(Z,{insurance:t.insurance,insuranceExpirationDate:t.insurance_expiration_date,calendarOpen:b.insurance_expiration_date,onInsuranceChange:e=>a("insurance",e),onInsuranceExpirationDateChange:e=>a("insurance_expiration_date",e),onCalendarOpenChange:e=>y("insurance_expiration_date",e),errors:n})]})}),r.jsx(M,{children:r.jsxs("div",{className:"flex gap-2 w-full",children:[r.jsx(E,{type:"button",variant:"outline",onClick:F,className:"flex-1",children:"Cancel"}),r.jsx(E,{type:"submit",onClick:N,disabled:S,className:"flex-1",children:S?"Creating...":"Create Unit"})]})})]})})})}export{qe as default};
