import{r as s,b as M,j as i}from"./app-BSOlzI_M.js";import{B as j}from"./button-D2rKFPK1.js";import{D as Q,a as T,b as W}from"./drawer-B6ZRXvIZ.js";import{CityPropertyUnitSelector as X}from"./CityPropertyUnitSelector-DgvYsdON.js";import{ApplicantInformationSection as Y}from"./ApplicantInformationSection-Cg-X4rMD.js";import{StatusAndDateSection as Z}from"./StatusAndDateSection-O11kkBng.js";import{AdditionalDetailsSection as $}from"./AdditionalDetailsSection-CFIhAVje.js";import"./app-D9zByHv3.js";import"./index-ByB7CnZO.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-09CEhTtY.js";import"./index-BK07_5Wa.js";import"./index-C5g_kYK6.js";import"./index-DIXGfQsU.js";import"./index-BLt4aHaa.js";import"./index-Eh5rTZKr.js";import"./x-V2a7Zg3Q.js";import"./createLucideIcon-BGWKpKjb.js";import"./label-ku6Bo0xE.js";import"./popover-CKsI89_0.js";import"./index-C4PIvpnm.js";import"./command-CBR154ui.js";import"./search-BcNZ_u8M.js";import"./chevrons-up-down-D-iRWSMZ.js";import"./check-BE4k6INO.js";import"./input-DWv8_Yxn.js";import"./select-Ckv1zRlQ.js";import"./index-Dc_FVRD7.js";import"./index-p7EaCzMM.js";import"./index-CJ72cHre.js";import"./index-C4dPa-2_.js";import"./chevron-down--Oeingn_.js";import"./chevron-up-RzjEL1k0.js";import"./application-CnwOiERd.js";import"./calendar-Di5dbzoO.js";import"./format-PYUiRpxY.js";import"./chevron-left-CVo-4b8C.js";import"./chevron-right-DU-yjHU5.js";import"./radioGroup-DqEJ_5sj.js";import"./calendar-CthI5zTo.js";import"./file-text-XuiuEW0Z.js";function Ht({cities:I,properties:_,units:C,open:A,onOpenChange:c,onSuccess:P,currentFilters:l,perPage:D,page:N}){const d=s.useRef(null),[u,n]=s.useState({}),[y,b]=s.useState(null),[v,f]=s.useState(null),[w,h]=s.useState([]),[E,p]=s.useState([]),{data:a,setData:r,post:U,processing:g,errors:m,reset:R,clearErrors:V,transform:k}=M({unit_id:null,name:"",co_signer:"",status:"",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]}),S=()=>{R(),V(),n({}),b(null),f(null),h([]),p([]),r({unit_id:null,name:"",co_signer:"",status:"",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]}),d.current&&(d.current.value="")},B=t=>{const e=parseInt(t);b(e),f(null),r("unit_id",null),n(o=>({...o,city:void 0,property:void 0,unit:void 0})),_[e]?h(_[e]):h([]),p([])},F=t=>{const e=parseInt(t);f(e),r("unit_id",null),n(o=>({...o,property:void 0,unit:void 0})),C[e]?p(C[e]):p([])},z=t=>{const e=parseInt(t);r("unit_id",e),n(o=>({...o,unit:void 0}))},q=t=>{r("name",t),n(e=>({...e,name:void 0}))},G=t=>{r("co_signer",t)},H=t=>{r("applicant_applied_from",t)},J=t=>{r("status",t),n(e=>({...e,status:void 0}))},x=t=>{t.preventDefault(),n({});let e=!1;const o={};if(y||(o.city="Please select a city before submitting the form.",e=!0),v||(o.property="Please select a property before submitting the form.",e=!0),a.unit_id||(o.unit="Please select a unit before submitting the form.",e=!0),(!a.name||a.name.trim()==="")&&(o.name="Please enter a name before submitting the form.",e=!0),(!a.status||a.status.trim()==="")&&(o.status="Please select a status before submitting the form.",e=!0),e){n(o);return}k(L=>({...L,filter_city:l.city||"",filter_property:l.property||"",filter_unit:l.unit||"",filter_name:l.name||"",filter_applicant_applied_from:l.applicant_applied_from||"",per_page:D,page:N})),U(route("applications.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{S(),c(!1),P?.()}})},K=()=>{S(),c(!1)};return i.jsx(Q,{open:A,onOpenChange:c,modal:!1,children:i.jsx(T,{size:"half",title:"Create New Application",children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsx(X,{cities:I,selectedCityId:y,selectedPropertyId:v,availableProperties:w,availableUnits:E,unitId:a.unit_id,onCityChange:B,onPropertyChange:F,onUnitChange:z,errors:m,validationErrors:u}),i.jsx(Y,{name:a.name,coSigner:a.co_signer,applicantAppliedFrom:a.applicant_applied_from,onNameChange:q,onCoSignerChange:G,onApplicantAppliedFromChange:H,errors:m,validationErrors:u}),i.jsx(Z,{status:a.status,date:a.date,onStatusChange:J,onDateChange:t=>r("date",t),errors:m,validationErrors:u}),i.jsx($,{stageInProgress:a.stage_in_progress,notes:a.notes,attachments:a.attachments,onStageInProgressChange:t=>r("stage_in_progress",t),onNotesChange:t=>r("notes",t),onAttachmentsChange:t=>r("attachments",t),fileInputRef:d,errors:m})]})}),i.jsx(W,{children:i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(j,{type:"button",variant:"outline",onClick:K,disabled:g,children:"Cancel"}),i.jsx(j,{type:"submit",onClick:x,disabled:g,children:g?"Creating...":"Create Application"})]})})]})})})}export{Ht as default};
