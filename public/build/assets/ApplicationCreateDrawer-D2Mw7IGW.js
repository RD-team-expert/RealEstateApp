import{r as s,b as M,j as i}from"./app-XlMZG7vD.js";import{B as j}from"./button-D56PIbu9.js";import{D as Q,a as T,b as W}from"./drawer-B7-2XtV2.js";import{CityPropertyUnitSelector as X}from"./CityPropertyUnitSelector-CbqTrucw.js";import{ApplicantInformationSection as Y}from"./ApplicantInformationSection-BcHs1kVI.js";import{StatusAndDateSection as Z}from"./StatusAndDateSection-CoaPVmfz.js";import{AdditionalDetailsSection as $}from"./AdditionalDetailsSection-Dfm1ehOE.js";import"./app-D9zByHv3.js";import"./index-D09_T-bu.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-CUT4GDty.js";import"./index-C_K36Fy_.js";import"./index-BoN4SSkO.js";import"./index-pZGqFUGS.js";import"./index-DqP218B8.js";import"./index-D2DcuX69.js";import"./x-B-P-7DDz.js";import"./createLucideIcon-BneQKrth.js";import"./label-BKN3erGN.js";import"./popover-DR8Y8CsW.js";import"./index-CTF06pqo.js";import"./command-DGwO2Uw9.js";import"./search-BKBHV1D6.js";import"./chevrons-up-down-CmSv9Nzf.js";import"./check-ZO7ekD6P.js";import"./input-nhBJFe9F.js";import"./select-C9mJLkAA.js";import"./index-Dc_FVRD7.js";import"./index-D8BBDizX.js";import"./index-DPt0Oyfm.js";import"./index-DdpYxxi8.js";import"./chevron-down-Dqt3V4Kg.js";import"./chevron-up-COk4jH4h.js";import"./application-CnwOiERd.js";import"./calendar-D02iCkay.js";import"./format-PYUiRpxY.js";import"./chevron-left-DiIjHAK0.js";import"./chevron-right-By2R6jNh.js";import"./radioGroup-DrlpglLG.js";import"./calendar-CGMbx-hL.js";import"./file-text-BMgerFDx.js";function Ht({cities:I,properties:_,units:C,open:A,onOpenChange:c,onSuccess:P,currentFilters:l,perPage:D,page:N}){const d=s.useRef(null),[u,n]=s.useState({}),[y,b]=s.useState(null),[v,f]=s.useState(null),[w,h]=s.useState([]),[E,p]=s.useState([]),{data:a,setData:r,post:U,processing:g,errors:m,reset:R,clearErrors:V,transform:k}=M({unit_id:null,name:"",co_signer:"",status:"",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]}),S=()=>{R(),V(),n({}),b(null),f(null),h([]),p([]),r({unit_id:null,name:"",co_signer:"",status:"",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]}),d.current&&(d.current.value="")},B=t=>{const e=parseInt(t);b(e),f(null),r("unit_id",null),n(o=>({...o,city:void 0,property:void 0,unit:void 0})),_[e]?h(_[e]):h([]),p([])},F=t=>{const e=parseInt(t);f(e),r("unit_id",null),n(o=>({...o,property:void 0,unit:void 0})),C[e]?p(C[e]):p([])},z=t=>{const e=parseInt(t);r("unit_id",e),n(o=>({...o,unit:void 0}))},q=t=>{r("name",t),n(e=>({...e,name:void 0}))},G=t=>{r("co_signer",t)},H=t=>{r("applicant_applied_from",t)},J=t=>{r("status",t),n(e=>({...e,status:void 0}))},x=t=>{t.preventDefault(),n({});let e=!1;const o={};if(y||(o.city="Please select a city before submitting the form.",e=!0),v||(o.property="Please select a property before submitting the form.",e=!0),a.unit_id||(o.unit="Please select a unit before submitting the form.",e=!0),(!a.name||a.name.trim()==="")&&(o.name="Please enter a name before submitting the form.",e=!0),(!a.status||a.status.trim()==="")&&(o.status="Please select a status before submitting the form.",e=!0),e){n(o);return}k(L=>({...L,filter_city:l.city||"",filter_property:l.property||"",filter_unit:l.unit||"",filter_name:l.name||"",filter_applicant_applied_from:l.applicant_applied_from||"",per_page:D,page:N})),U(route("applications.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{S(),c(!1),P?.()}})},K=()=>{S(),c(!1)};return i.jsx(Q,{open:A,onOpenChange:c,modal:!1,children:i.jsx(T,{size:"half",title:"Create New Application",children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsx(X,{cities:I,selectedCityId:y,selectedPropertyId:v,availableProperties:w,availableUnits:E,unitId:a.unit_id,onCityChange:B,onPropertyChange:F,onUnitChange:z,errors:m,validationErrors:u}),i.jsx(Y,{name:a.name,coSigner:a.co_signer,applicantAppliedFrom:a.applicant_applied_from,onNameChange:q,onCoSignerChange:G,onApplicantAppliedFromChange:H,errors:m,validationErrors:u}),i.jsx(Z,{status:a.status,date:a.date,onStatusChange:J,onDateChange:t=>r("date",t),errors:m,validationErrors:u}),i.jsx($,{stageInProgress:a.stage_in_progress,notes:a.notes,attachments:a.attachments,onStageInProgressChange:t=>r("stage_in_progress",t),onNotesChange:t=>r("notes",t),onAttachmentsChange:t=>r("attachments",t),fileInputRef:d,errors:m})]})}),i.jsx(W,{children:i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(j,{type:"button",variant:"outline",onClick:K,disabled:g,children:"Cancel"}),i.jsx(j,{type:"submit",onClick:x,disabled:g,children:g?"Creating...":"Create Application"})]})})]})})})}export{Ht as default};
