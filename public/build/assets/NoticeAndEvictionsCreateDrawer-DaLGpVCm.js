import{r as m,b as Q,j as i,a as G}from"./app-p7g_f0wo.js";import{D as H,a as J,b as K}from"./drawer-BG8f08dK.js";import{B as P}from"./button-CgWb-OwV.js";import M from"./CascadingSelectionFields-Bf6CODgN.js";import O from"./SelectionSummary-Cj-Z_70n.js";import W from"./NoticeFormFields-BEIUHv6s.js";import"./app-D9ss4c-j.js";import"./index-C9RY0Fne.js";import"./index-6lgmZUbB.js";import"./index-H5dANVBP.js";import"./index-DkhO7hde.js";import"./index-soOnB7Xl.js";import"./index-CiElmmUH.js";import"./index-DqXNBRMy.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-CLgUf5rt.js";import"./createLucideIcon-DCkjgf37.js";import"./label-DYy2JzQ2.js";import"./command-C_MhNOcZ.js";import"./search-BU1dLuL3.js";import"./popover-B4-HGuiv.js";import"./index-DbQ0MNsB.js";import"./index-BFObTlUk.js";import"./chevrons-up-down-KkSb8Z31.js";import"./check-Cfkty5Qk.js";import"./DateField-BxXcXHcx.js";import"./calendar-BbyHMKLt.js";import"./format-PYUiRpxY.js";import"./chevron-left-DEQB7mOe.js";import"./chevron-right-DVrPLLPg.js";import"./chevron-down-QjJMMFQo.js";import"./calendar-C5PdxC03.js";import"./EvectedOrPaymentPlanField-BM9e9Tpq.js";import"./radioGroup-Dy3ozKpR.js";import"./index-BxQHv4UU.js";import"./index-BAfRhOcu.js";import"./EvictionsField-C1v9f4jv.js";import"./input-DiaYLKYe.js";import"./HaveAnExceptionField-DrJlMIMJ.js";import"./HearingDatesField-Bk428Msq.js";import"./IfLeftField-D48K2kk6.js";import"./NoteField-Dlq6M9K9.js";import"./OtherTenantsField-IsSRbGaA.js";import"./SentToAttorneyField-BFuj8QEe.js";import"./StatusField-CLQ3_fwi.js";import"./TypeOfNoticeField-CWQ7HCuH.js";import"./select-CfH1ySLB.js";import"./index-Dc_FVRD7.js";import"./index-DBAs5r5h.js";import"./chevron-up-DNYJO-3s.js";import"./WritDateField-BcYjVN-f.js";function Ot({cities:g,properties:w,units:D,tenants:T,notices:U,open:$,onOpenChange:_,onSuccess:V,queryParams:k={}}){const[q,a]=m.useState({}),[p,N]=m.useState(null),[d,h]=m.useState(null),[c,u]=m.useState(null),[b,C]=m.useState([]),[I,x]=m.useState([]),[S,f]=m.useState([]),{data:l,setData:o,processing:j,errors:v,reset:B}=Q({tenant_id:null,status:"",date:"",type_of_notice:"",have_an_exception:"",note:"",evictions:"",sent_to_atorney:"",hearing_dates:"",evected_or_payment_plan:"",if_left:"",writ_date:"",other_tenants:""}),y={city:n=>{const t=parseInt(n);N(t),h(null),u(null),o("tenant_id",null),o("other_tenants","");const e=w.filter(r=>r.city_id===t);C(e),x([]),f([]),a(r=>({...r,city:"",property:"",unit:"",tenant:""}))},property:n=>{const t=parseInt(n);h(t),u(null),o("tenant_id",null),o("other_tenants","");const e=D.filter(r=>r.property_id===t);x(e),f([]),a(r=>({...r,property:"",unit:"",tenant:""}))},unit:n=>{const t=parseInt(n);u(t),o("tenant_id",null),o("other_tenants","");const e=T.filter(r=>r.unit_id===t);f(e),a(r=>({...r,unit:"",tenant:""}))},tenant:n=>{const t=parseInt(n);o("tenant_id",t),a(e=>({...e,tenant:""}))}},E=()=>{B(),N(null),h(null),u(null),C([]),x([]),f([]),a({})},R=()=>{const n=new URLSearchParams;return Object.entries(k).forEach(([t,e])=>{e!=null&&e!==""&&n.append(t,String(e))}),n.toString()?`?${n.toString()}`:""},F=n=>{n.preventDefault(),a({});let t=!1;const e={};if(p||(e.city="Please select a city before submitting the form.",t=!0),d||(e.property="Please select a property before submitting the form.",t=!0),c||(e.unit="Please select a unit before submitting the form.",t=!0),l.tenant_id||(e.tenant="Please select a tenant before submitting the form.",t=!0),t){a(e);return}const s=`/notice_and_evictions${R()}`;G.post(s,l,{onSuccess:()=>{E(),_(!1),V?.()},onError:L=>{console.log("Form submission errors:",L)}})},z=()=>{E(),_(!1)},A=()=>{const n=g.find(s=>s.id===p),t=b.find(s=>s.id===d),e=I.find(s=>s.id===c),r=S.find(s=>s.id===l.tenant_id);return{cityName:n?.city||"",propertyName:t?.property_name||"",unitName:e?.unit_name||"",tenantName:r?`${r.first_name} ${r.last_name}`:""}};return i.jsx(H,{open:$,onOpenChange:_,modal:!1,children:i.jsx(J,{size:"half",title:"Create New Notice & Eviction",children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:F,className:"space-y-4",children:[i.jsx(M,{cities:g,filteredProperties:b,filteredUnits:I,filteredTenants:S,selectedCityId:p,selectedPropertyId:d,selectedUnitId:c,selectedTenantId:l.tenant_id,onCityChange:y.city,onPropertyChange:y.property,onUnitChange:y.unit,onTenantChange:y.tenant,validationErrors:q,errors:v}),i.jsx(O,{selectedCityId:p,selectedPropertyId:d,selectedUnitId:c,selectedTenantId:l.tenant_id,selectedNames:A()}),i.jsx(W,{data:l,setData:o,errors:v,notices:U,filteredTenants:S,selectedUnitId:c,otherTenantsValue:l.other_tenants,onOtherTenantsChange:n=>o("other_tenants",n)})]})}),i.jsx(K,{children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(P,{type:"button",variant:"outline",onClick:z,className:"flex-1",children:"Cancel"}),i.jsx(P,{type:"submit",onClick:F,disabled:j,className:"flex-1",children:j?"Creating...":"Create Notice & Eviction"})]})})]})})})}export{Ot as default};
