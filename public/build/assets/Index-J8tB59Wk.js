import{r as s,u as T,j as t,H as _,a}from"./app-CHDKARjb.js";import{C as $,b as L}from"./card-C7nNTwWV.js";import{u as R,A as U}from"./app-layout-Cz-niD8H.js";import H from"./VendorCreateDrawer-DaQzVPu4.js";import B from"./VendorEditDrawer-D5-ddPp3.js";import M from"./FlashMessages-FKxaLXbo.js";import q from"./PageHeader-CqY-xUEI.js";import z from"./VendorFilters-CaTfnagH.js";import G from"./VendorTable-CmAxlHbp.js";import J from"./VendorPagination-C5Mg1xKp.js";import"./app-BmbQfT0_.js";import"./utils-CBfrqCZ4.js";import"./index-DzrNkgKa.js";import"./button-DVMLQ4Cf.js";import"./index-DH5c0sFq.js";import"./index-Dc_FVRD7.js";import"./index-BMM8wKPv.js";import"./index-DhGOy-yS.js";import"./index-Bc-3DsyS.js";import"./index-DzT3tnb6.js";import"./index-q1apwmMP.js";import"./index-0tk3grE1.js";import"./index-DfGTd3cq.js";import"./x-DzxxLS5y.js";import"./createLucideIcon-C7c1hvIj.js";import"./index-DUM9UyY6.js";import"./index-CwBu8RV2.js";import"./index-qPHptkmt.js";import"./collapsible-CBxE2yZh.js";import"./chevron-right-CzDW8WF4.js";import"./index-DiN52TcP.js";import"./log-out-Ckm4m212.js";import"./app-logo-icon--P_-c3yX.js";import"./house-R0vSJ-MQ.js";import"./building-mIkOh_fr.js";import"./users-BelIezuD.js";import"./wrench-CSdkG0qX.js";import"./credit-card-3sFCGHNT.js";import"./dollar-sign-C6zNmobC.js";import"./file-text-Ia3zVVV6.js";import"./triangle-alert-DtVQmrkD.js";import"./bell-DGEfdnEl.js";import"./drawer-DBQSSrTa.js";import"./CityField-Bpl2I_uo.js";import"./label-DcQ_-sMZ.js";import"./select-DSkJK3rS.js";import"./index-vBQwvlXi.js";import"./chevron-down-qX4-vl1q.js";import"./check-Ck6Rqaxz.js";import"./chevron-up-DiltP7zF.js";import"./VendorNameField-IM2j6IHK.js";import"./input-CESuFFYh.js";import"./PhoneNumberField-D7lQ0zqi.js";import"./EmailField-KtlRBR91.js";import"./ServiceTypeField-oAFJRRcJ.js";import"./radioGroup-DeMlaPSu.js";import"./CityField-BUggqX_A.js";import"./VendorNameField-DgZLwOgg.js";import"./PhoneNumberField-B52_OUtL.js";import"./EmailField-C4YvuCCM.js";import"./ServiceTypeField-RLJcU9bk.js";import"./download-BkR6JC2L.js";import"./plus-C_kG8f__.js";import"./search-m1-QTzWz.js";import"./table-OH-MIgN2.js";import"./VendorTableRow-DbXX8gky.js";import"./square-pen-FIXyxp3A.js";import"./trash-2-BG_L6yri.js";const K=(i,n="vendors.csv")=>{const m=[["ID","City","Vendor Name","Number","Email","Service Type"].join(","),...i.map(o=>[o.id,`"${o.city?.city||"N/A"}"`,`"${o.vendor_name}"`,`"${o.number||""}"`,`"${o.email||""}"`,`"${o.service_type||""}"`].join(","))].join(`
`),u=new Blob([m],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),l=URL.createObjectURL(u);r.setAttribute("href",l),r.setAttribute("download",n),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(l)};function mt({vendors:i,filters:n,cities:p}){const[,m]=s.useState(n),[u,r]=s.useState(!1),[l,o]=s.useState(!1),[S,x]=s.useState(!1),[g,j]=s.useState(null),{flash:w}=T().props,{hasPermission:y,hasAllPermissions:f}=R(),[v,C]=s.useState({city:n.city||"",vendor_name:n.vendor_name||""}),[E,d]=s.useState(!1),h=(e,c)=>{C(N=>({...N,[e]:c}))},D=e=>{const c=e.target.value;h("city",c),d(c.length>0)},b=e=>{h("city",e.city),d(!1)},V=()=>{const e={...v};m(e),a.get(route("vendors.index"),e,{preserveState:!0,preserveScroll:!0})},F=()=>{const e={city:"",vendor_name:""};C(e),m(e),d(!1),a.get(route("vendors.index"),{},{preserveState:!0,preserveScroll:!0})},P=()=>{if(i.data.length===0){alert("No data to export");return}r(!0);try{const e=`vendors-${new Date().toISOString().split("T")[0]}.csv`;K(i.data,e)}catch(e){console.error("Export failed:",e),alert("Export failed. Please try again.")}finally{r(!1)}},O=e=>{confirm("Are you sure you want to delete this vendor?")&&a.delete(route("vendors.destroy",e.id))},A=()=>{a.reload()},I=e=>{j(e),x(!0)},k=()=>{a.reload()};return t.jsxs(U,{children:[t.jsx(_,{title:"Vendors"}),t.jsx("div",{className:"py-12",children:t.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[t.jsx(M,{flash:w}),t.jsx(q,{hasExportPermission:y("vendor.export"),hasCreatePermissions:f(["vendors.create","vendors.store"]),isExporting:u,onExport:P,onAddVendor:()=>o(!0)}),t.jsx($,{children:t.jsxs(L,{className:"p-6",children:[t.jsx(z,{tempFilters:v,cities:p,showCityDropdown:E,onTempFilterChange:h,onCityInputChange:D,onCitySelect:b,onSearchClick:V,onClearFilters:F,setShowCityDropdown:d}),t.jsx(G,{vendors:i.data,hasEditPermissions:f(["vendors.edit","vendors.update"]),hasDeletePermission:y("vendors.destroy"),onEditVendor:I,onDeleteVendor:O}),t.jsx(J,{links:i.links})]})})]})}),t.jsx(H,{cities:p,open:l,onOpenChange:o,onSuccess:A}),t.jsx(B,{cities:p,open:S,onOpenChange:x,vendor:g,onSuccess:k})]})}export{mt as default};
