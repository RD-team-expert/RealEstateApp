import{r as s,b as K,j as t}from"./app-BSOlzI_M.js";import{B as b}from"./button-D2rKFPK1.js";import{D as L,a as M,b as Q}from"./drawer-B6ZRXvIZ.js";import T from"./CitySelectionSection-Vh-w3uTu.js";import U from"./PropertySelectionSection-B2eXcpev.js";import W from"./InsuranceCompanySection-DLdUDTi0.js";import X from"./AmountPolicySection-D33WWwVC.js";import Y from"./DatesSection-DA9DPxaf.js";import Z from"./NotesSection-B39w3HFM.js";import"./app-D9zByHv3.js";import"./index-ByB7CnZO.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-09CEhTtY.js";import"./index-BK07_5Wa.js";import"./index-C5g_kYK6.js";import"./index-DIXGfQsU.js";import"./index-BLt4aHaa.js";import"./index-Eh5rTZKr.js";import"./x-V2a7Zg3Q.js";import"./createLucideIcon-BGWKpKjb.js";import"./label-ku6Bo0xE.js";import"./popover-CKsI89_0.js";import"./index-C4PIvpnm.js";import"./command-CBR154ui.js";import"./search-BcNZ_u8M.js";import"./map-pin-57um3dcz.js";import"./chevrons-up-down-D-iRWSMZ.js";import"./check-BE4k6INO.js";import"./alert-rYXkK_B5.js";import"./building-2-BzsejGVV.js";import"./circle-alert-CDOkMJ4H.js";import"./input-DWv8_Yxn.js";import"./shield-CtVmy-S8.js";import"./dollar-sign-CX6g00Px.js";import"./file-text-XuiuEW0Z.js";import"./calendar-CthI5zTo.js";import"./textarea-VkyOez7F.js";function ze({open:S,onOpenChange:p,cities:j=[],availableProperties:f=[],currentFilters:D,currentPage:m,currentPerPage:u}){const[i,d]=s.useState(""),[E,l]=s.useState([]),[I,c]=s.useState(""),N={property_id:0,insurance_company_name:"",amount:"",policy_number:"",effective_date:"",expiration_date:"",notes:""},{data:r,setData:o,post:P,processing:y,errors:n,reset:w,clearErrors:_,transform:F}=K(N);s.useEffect(()=>{if(i){const e=f.filter(a=>a.city_id===parseInt(i));l(e)}else l([]);o("property_id",0)},[i,f]);const h=()=>{w(),d(""),l([]),c(""),_()},A=e=>{o("property_id",parseInt(e)),c("")},V=e=>{o("insurance_company_name",e.target.value)},k=e=>{o("amount",e.target.value)},B=e=>{o("policy_number",e.target.value)},z=e=>{o("effective_date",e.target.value)},R=e=>{o("expiration_date",e.target.value)},q=e=>{o("notes",e.target.value)},G=()=>{const e={};u&&(e.filter_per_page=String(u)),m&&m>0&&(e.filter_page=m);const{property_name:a,insurance_company_name:x,policy_number:g,status:v}=D||{};return a&&(e.filter_property_name=a),x&&(e.filter_insurance_company_name=x),g&&(e.filter_policy_number=g),v&&(e.filter_status=v),e},C=e=>{if(e.preventDefault(),!r.property_id||r.property_id===0){c("Please select a property before submitting the form.");return}F(a=>({...a,...G()})),P(route("properties-info.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{h(),p(!1)},onError:()=>{}})},H=()=>{h(),p(!1)},J=e=>{d(e),o("property_id",0),_()};return t.jsx(L,{open:S,onOpenChange:p,modal:!1,children:t.jsx(M,{size:"half",title:"Create New Property Insurance",children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.jsxs("form",{onSubmit:C,className:"space-y-4",children:[t.jsx(T,{selectedCityId:i,cities:j,onCityChange:J}),t.jsx(U,{propertyId:r.property_id,selectedCityId:i,filteredProperties:E,onPropertyChange:A,errors:n,validationError:I}),t.jsx(W,{value:r.insurance_company_name,onChange:V,errors:n}),t.jsx(X,{amount:r.amount,policyNumber:r.policy_number,onAmountChange:k,onPolicyNumberChange:B,errors:n}),t.jsx(Y,{effectiveDate:r.effective_date,expirationDate:r.expiration_date,onEffectiveDateChange:z,onExpirationDateChange:R,errors:n}),t.jsx(Z,{value:r.notes,onChange:q,errors:n})]})}),t.jsxs(Q,{className:"flex-row justify-end gap-2 border-t bg-muted/50 p-4",children:[t.jsx(b,{type:"button",variant:"outline",onClick:H,children:"Cancel"}),t.jsx(b,{type:"submit",onClick:C,disabled:y,children:y?"Creating...":"Create Property"})]})]})})})}export{ze as default};
