import{r as a,b as ne,j as e}from"./app-nUSYw4ai.js";import{B as z}from"./createLucideIcon-C5GD6QeA.js";import{I as c}from"./input-OhVo65AQ.js";import{L as l}from"./label-DtPmPEai.js";import{S as q,a as G,b as H,c as J,d as K}from"./select-PjIVfLW0.js";import{D as ie,a as oe,b as le}from"./drawer-ikeMES7v.js";import{A as ce,a as me}from"./alert-BPCEFgl0.js";import{M as de}from"./map-pin-BrCNp2t0.js";import{B as ue}from"./building-2-rNtBvNrS.js";import{C as pe}from"./circle-alert-CxetrKCW.js";import{S as fe}from"./shield-1XNzmiHl.js";import{D as xe}from"./dollar-sign-DvmVu0rD.js";import{F as he}from"./file-text-B1Xrnfk_.js";import{C as Q}from"./calendar-C-0kt65W.js";import"./app-oDNfBSri.js";import"./index-CedKduyQ.js";import"./index-UYkM-lg7.js";import"./index-nh9QAngE.js";import"./index-DGbRjXgX.js";import"./index-5YpAK82Y.js";import"./index-DbaH1TRh.js";import"./index-BKS2-tOY.js";import"./index-mn3Hv6wy.js";import"./chevron-up-BHOYq5G1.js";function qe({open:h,onOpenChange:b,cities:U=[],availableProperties:S=[],onSuccess:V}){const[o,w]=a.useState(""),[I,j]=a.useState([]),[D,y]=a.useState(""),[P,_]=a.useState(""),[F,N]=a.useState(""),[R,v]=a.useState(""),[k,g]=a.useState(""),[A,C]=a.useState(""),m=a.useRef(null),d=a.useRef(null),u=a.useRef(null),p=a.useRef(null),f=a.useRef(null),x=a.useRef(null),W={property_id:0,insurance_company_name:"",amount:"",policy_number:"",effective_date:"",expiration_date:""},{data:t,setData:i,post:X,processing:B,errors:n,reset:Y,clearErrors:L}=ne(W);a.useEffect(()=>{if(o){const r=S.filter(s=>s.city_id===parseInt(o));j(r)}else j([]);i("property_id",0)},[o,S]),a.useEffect(()=>{h&&E()},[h]);const E=()=>{Y(),w(""),j([]),M(),L()},M=()=>{y(""),_(""),N(""),v(""),g(""),C("")},Z=r=>{i("property_id",parseInt(r)),y("")},$=r=>{i("insurance_company_name",r.target.value),_("")},O=r=>{i("amount",r.target.value),N("")},ee=r=>{i("policy_number",r.target.value),v("")},re=r=>{i("effective_date",r.target.value),g("")},te=r=>{i("expiration_date",r.target.value),C("")},T=r=>{r.preventDefault(),M();let s=!1;(!t.property_id||t.property_id===0)&&(y("Please select a property before submitting the form."),m.current&&(m.current.focus(),m.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.insurance_company_name||t.insurance_company_name.trim()==="")&&(_("Please enter an insurance company name before submitting the form."),d.current&&!s&&(d.current.focus(),d.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.amount||t.amount.trim()==="")&&(N("Please enter an amount before submitting the form."),u.current&&!s&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.policy_number||t.policy_number.trim()==="")&&(v("Please enter a policy number before submitting the form."),p.current&&!s&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.effective_date||t.effective_date.trim()==="")&&(g("Please select an effective date before submitting the form."),f.current&&!s&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),(!t.expiration_date||t.expiration_date.trim()==="")&&(C("Please select an expiration date before submitting the form."),x.current&&!s&&(x.current.focus(),x.current.scrollIntoView({behavior:"smooth",block:"center"})),s=!0),!s&&X(route("properties-info.store"),{onSuccess:()=>{E(),b(!1),V&&V()},onError:()=>{}})},ae=()=>{E(),b(!1)},se=r=>{w(r),i("property_id",0),L()};return e.jsx(ie,{open:h,onOpenChange:b,modal:!1,children:e.jsx(oe,{size:"half",title:"Create New Property Insurance",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"city_select",className:"text-base font-semibold",children:[e.jsx(de,{className:"h-4 w-4 inline mr-1"}),"Select City"]})}),e.jsxs(q,{value:o,onValueChange:se,children:[e.jsx(G,{className:"w-full",children:e.jsx(H,{placeholder:"Choose a city..."})}),e.jsx(J,{children:U.map(r=>e.jsx(K,{value:r.id.toString(),children:r.city},r.id))})]})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"property_select",className:"text-base font-semibold",children:[e.jsx(ue,{className:"h-4 w-4 inline mr-1"}),"Select Property *"]})}),e.jsxs(q,{value:t.property_id&&t.property_id!==0?t.property_id.toString():"",onValueChange:Z,disabled:!o,children:[e.jsx(G,{className:"w-full",ref:m,children:e.jsx(H,{placeholder:o?"Choose a property...":"Select a city first..."})}),e.jsx(J,{children:I.map(r=>e.jsx(K,{value:r.id.toString(),children:r.property_name},r.id))})]}),n.property_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.property_id}),D&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:D}),o&&I.length===0&&e.jsxs(ce,{className:"mt-2",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx(me,{children:"No properties found for the selected city."})]})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"insurance_company_name",className:"text-base font-semibold",children:[e.jsx(fe,{className:"h-4 w-4 inline mr-1"}),"Insurance Company *"]})}),e.jsx(c,{ref:d,id:"insurance_company_name",value:t.insurance_company_name,onChange:$,placeholder:"Enter insurance company name"}),n.insurance_company_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.insurance_company_name}),P&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:P})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"amount",className:"text-base font-semibold",children:[e.jsx(xe,{className:"h-4 w-4 inline mr-1"}),"Amount *"]})}),e.jsx(c,{ref:u,id:"amount",type:"number",step:"0.01",min:"0",value:t.amount,onChange:O,placeholder:"0.00"}),n.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.amount}),F&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:F})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"policy_number",className:"text-base font-semibold",children:[e.jsx(he,{className:"h-4 w-4 inline mr-1"}),"Policy Number *"]})}),e.jsx(c,{ref:p,id:"policy_number",value:t.policy_number,onChange:ee,placeholder:"Enter policy number"}),n.policy_number&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.policy_number}),R&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:R})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"effective_date",className:"text-base font-semibold",children:[e.jsx(Q,{className:"h-4 w-4 inline mr-1"}),"Effective Date *"]})}),e.jsx(c,{ref:f,id:"effective_date",type:"date",value:t.effective_date,onChange:re}),n.effective_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.effective_date}),k&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:k})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsxs(l,{htmlFor:"expiration_date",className:"text-base font-semibold",children:[e.jsx(Q,{className:"h-4 w-4 inline mr-1"}),"Expiration Date *"]})}),e.jsx(c,{ref:x,id:"expiration_date",type:"date",value:t.expiration_date,onChange:te}),n.expiration_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.expiration_date}),A&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:A})]})]})]})}),e.jsxs(le,{className:"flex-row justify-end gap-2 border-t bg-muted/50 p-4",children:[e.jsx(z,{type:"button",variant:"outline",onClick:ae,children:"Cancel"}),e.jsx(z,{type:"submit",onClick:T,disabled:B,children:B?"Creating...":"Create Property"})]})]})})})}export{qe as default};
