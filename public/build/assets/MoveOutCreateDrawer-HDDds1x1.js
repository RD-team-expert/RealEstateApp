import{r as i,b as B,j as r}from"./app-Y5k3mklr.js";import{D as G,a as H,b as J}from"./drawer-DFF_jVi3.js";import{B as P}from"./button-CQfb3JBO.js";import K from"./LocationSection-dLM-1FrP.js";import Q from"./DateFieldsSection-Cr1Saqld.js";import W from"./PropertyDetailsSection-BkACZEMp.js";import X from"./StatusFieldsSection-CnR8JLSv.js";import"./app-BZFxL5VY.js";import"./index-uindsx95.js";import"./index-DeKsjAJz.js";import"./index-CVo6BqxD.js";import"./index-wwqKUVc_.js";import"./index-DLyAnWAc.js";import"./index-D1TeM0R1.js";import"./index-BwS5tYp4.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-Nz9yRxvI.js";import"./createLucideIcon-BOWbKjUa.js";import"./FormField-B2iT9cFG.js";import"./label-TGf-rOKa.js";import"./TextInputField-Cqn32Zk_.js";import"./input-C9nWuHON.js";import"./popover-DdSV75dE.js";import"./index-ClDX_llA.js";import"./command-DZJD3kpm.js";import"./search-DjaWC1MF.js";import"./chevrons-up-down-Dx5zMBh7.js";import"./check-Dye3JuSq.js";import"./DatePickerField-Ru5QRZBk.js";import"./calendar-BKoT7UuT.js";import"./format-PYUiRpxY.js";import"./chevron-left-C91HQvgE.js";import"./chevron-right-MFcKsrea.js";import"./chevron-down-DPdXkLmR.js";import"./calendar-DEpy9fhW.js";import"./RadioGroupField-BcYPp-ZJ.js";import"./radioGroup-Dspzb7Eh.js";import"./index-vpTsBzNQ.js";import"./index-BHdDvuH_.js";import"./TextAreaField-ga7UP0tH.js";import"./textarea-BYlVDaeF.js";function Oe({cities:N,propertiesByCityId:y,unitsByPropertyId:g,open:R,onOpenChange:b,onSuccess:k,redirectContext:l}){const u=i.useRef(null),c=i.useRef(null),p=i.useRef(null),[I,o]=i.useState({city:"",property:"",unit:""}),[v,S]=i.useState(null),[C,f]=i.useState(null),[x,m]=i.useState(null),[E,h]=i.useState([]),[U,_]=i.useState([]),[V,F]=i.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:s,setData:a,post:M,processing:j,errors:d,reset:T,transform:A}=B({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",all_the_devices_are_off:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",renter:"",move_out_form:"",utility_type:""}),O=n=>{const e=parseInt(n);S(e),f(null),m(null),a("unit_id",null),o(t=>({...t,city:"",property:"",unit:""})),e&&y[e]?h(y[e]):h([]),_([])},z=n=>{const e=parseInt(n);f(e),m(null),a("unit_id",null),o(t=>({...t,property:"",unit:""})),e&&g[e]?_(g[e]):_([])},L=n=>{const e=parseInt(n);m(e),a("unit_id",e),o(t=>({...t,unit:""}))},q=n=>{F(e=>({...e,[n]:!e[n]}))},D=n=>{n.preventDefault(),o({city:"",property:"",unit:""});let e=!1;v||(o(t=>({...t,city:"Please select a city before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),C||(o(t=>({...t,property:"Please select a property before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),(!x||!s.unit_id)&&(o(t=>({...t,unit:"Please select a unit before submitting the form."})),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),!e&&(A(t=>({...t,move_out_date:t.move_out_date?.trim()?t.move_out_date:null,date_lease_ending_on_buildium:t.date_lease_ending_on_buildium?.trim()?t.date_lease_ending_on_buildium:null,date_utility_put_under_our_name:t.date_utility_put_under_our_name?.trim()?t.date_utility_put_under_our_name:null,redirect_city:l?.city??null,redirect_property:l?.property??null,redirect_unit:l?.unit??null,redirect_page:l?.page??null,redirect_perPage:l?.perPage??null})),M(route("move-out.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{w(),k?.()}}))},w=()=>{T(),S(null),f(null),m(null),o({city:"",property:"",unit:""}),h([]),_([]),b(!1)};return r.jsx(G,{open:R,onOpenChange:b,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Move-Out Record",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsx(K,{cities:N,availableProperties:E,availableUnits:U,selectedCity:v,selectedProperty:C,selectedUnit:x,validationErrors:I,cityRef:u,propertyRef:c,unitRef:p,onCityChange:O,onPropertyChange:z,onUnitChange:L,tenants:s.tenants,tenantsError:d.tenants,onTenantsChange:n=>a("tenants",n)}),r.jsx(Q,{data:s,errors:d,calendarStates:V,onCalendarToggle:q,onDataChange:a}),r.jsx(W,{data:s,errors:d,onDataChange:a}),r.jsx(X,{data:s,errors:d,onDataChange:a})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex gap-2 w-full",children:[r.jsx(P,{type:"button",variant:"outline",onClick:w,className:"flex-1",children:"Cancel"}),r.jsx(P,{type:"submit",onClick:D,disabled:j,className:"flex-1",children:j?"Creating...":"Create Move-Out Record"})]})})]})})})}export{Oe as default};
