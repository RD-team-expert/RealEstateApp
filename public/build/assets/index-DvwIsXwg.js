import{r as s,j as x}from"./app-CCzuXckj.js";import{c as y}from"./index-Dc_FVRD7.js";import{P as R,d as U}from"./index-Dt7h0l9k.js";import{u as A}from"./index-ChB7U0Zf.js";import{u as F}from"./index-DODHwusq.js";import{u as z}from"./index-wJbuxyvX.js";var H="DismissableLayer",h="dismissableLayer.update",G="dismissableLayer.pointerDownOutside",M="dismissableLayer.focusOutside",L,T=s.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),q=s.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:u,onInteractOutside:f,onDismiss:d,...E}=e,o=s.useContext(T),[c,I]=s.useState(null),l=c?.ownerDocument??globalThis?.document,[,S]=s.useState({}),W=A(t,n=>I(n)),b=Array.from(o.layers),[N]=[...o.layersWithOutsidePointerEventsDisabled].slice(-1),_=b.indexOf(N),D=c?b.indexOf(c):-1,j=o.layersWithOutsidePointerEventsDisabled.size>0,P=D>=_,k=Y(n=>{const v=n.target,C=[...o.branches].some(m=>m.contains(v));!P||C||(i?.(n),f?.(n),n.defaultPrevented||d?.())},l),O=J(n=>{const v=n.target;[...o.branches].some(m=>m.contains(v))||(u?.(n),f?.(n),n.defaultPrevented||d?.())},l);return z(n=>{D===o.layers.size-1&&(a?.(n),!n.defaultPrevented&&d&&(n.preventDefault(),d()))},l),s.useEffect(()=>{if(c)return r&&(o.layersWithOutsidePointerEventsDisabled.size===0&&(L=l.body.style.pointerEvents,l.body.style.pointerEvents="none"),o.layersWithOutsidePointerEventsDisabled.add(c)),o.layers.add(c),g(),()=>{r&&o.layersWithOutsidePointerEventsDisabled.size===1&&(l.body.style.pointerEvents=L)}},[c,l,r,o]),s.useEffect(()=>()=>{c&&(o.layers.delete(c),o.layersWithOutsidePointerEventsDisabled.delete(c),g())},[c,o]),s.useEffect(()=>{const n=()=>S({});return document.addEventListener(h,n),()=>document.removeEventListener(h,n)},[]),x.jsx(R.div,{...E,ref:W,style:{pointerEvents:j?P?"auto":"none":void 0,...e.style},onFocusCapture:y(e.onFocusCapture,O.onFocusCapture),onBlurCapture:y(e.onBlurCapture,O.onBlurCapture),onPointerDownCapture:y(e.onPointerDownCapture,k.onPointerDownCapture)})});q.displayName=H;var K="DismissableLayerBranch",X=s.forwardRef((e,t)=>{const r=s.useContext(T),a=s.useRef(null),i=A(t,a);return s.useEffect(()=>{const u=a.current;if(u)return r.branches.add(u),()=>{r.branches.delete(u)}},[r.branches]),x.jsx(R.div,{...e,ref:i})});X.displayName=K;function Y(e,t=globalThis?.document){const r=F(e),a=s.useRef(!1),i=s.useRef(()=>{});return s.useEffect(()=>{const u=d=>{if(d.target&&!a.current){let E=function(){B(G,r,o,{discrete:!0})};const o={originalEvent:d};d.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=E,t.addEventListener("click",i.current,{once:!0})):E()}else t.removeEventListener("click",i.current);a.current=!1},f=window.setTimeout(()=>{t.addEventListener("pointerdown",u)},0);return()=>{window.clearTimeout(f),t.removeEventListener("pointerdown",u),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>a.current=!0}}function J(e,t=globalThis?.document){const r=F(e),a=s.useRef(!1);return s.useEffect(()=>{const i=u=>{u.target&&!a.current&&B(M,r,{originalEvent:u},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function g(){const e=new CustomEvent(h);document.dispatchEvent(e)}function B(e,t,r,{discrete:a}){const i=r.originalEvent.target,u=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),a?U(i,u):i.dispatchEvent(u)}var p=0;function ne(){s.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??w()),document.body.insertAdjacentElement("beforeend",e[1]??w()),p++,()=>{p===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),p--}},[])}function w(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}export{q as D,ne as u};
