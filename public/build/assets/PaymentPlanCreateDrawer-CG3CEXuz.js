import{r,b as tt,j as o}from"./app-p7g_f0wo.js";import{D as et,a as nt,b as rt}from"./drawer-BG8f08dK.js";import{B as F}from"./button-CgWb-OwV.js";import ot from"./LocationTenantSelection-lQUer-7Z.js";import at from"./PaymentPlanDetails-BJXVg972.js";import st from"./NotesSection-CiGjTO1o.js";import"./app-D9ss4c-j.js";import"./index-C9RY0Fne.js";import"./index-6lgmZUbB.js";import"./index-H5dANVBP.js";import"./index-DkhO7hde.js";import"./index-soOnB7Xl.js";import"./index-CiElmmUH.js";import"./index-DqXNBRMy.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-CLgUf5rt.js";import"./createLucideIcon-DCkjgf37.js";import"./label-DYy2JzQ2.js";import"./SelectionField-CKvaaxtm.js";import"./command-C_MhNOcZ.js";import"./search-BU1dLuL3.js";import"./popover-B4-HGuiv.js";import"./index-DbQ0MNsB.js";import"./index-BFObTlUk.js";import"./chevrons-up-down-KkSb8Z31.js";import"./check-Cfkty5Qk.js";import"./calendar-BbyHMKLt.js";import"./format-PYUiRpxY.js";import"./chevron-left-DEQB7mOe.js";import"./chevron-right-DVrPLLPg.js";import"./chevron-down-QjJMMFQo.js";import"./input-DiaYLKYe.js";import"./calendar-C5PdxC03.js";import"./textarea-uGnQwSiz.js";function Ht({cities:z,propertiesByCityId:P,unitsByPropertyId:j,tenantsByUnitId:w,open:L,onOpenChange:R,onSuccess:q,search:G,filters:c,perPage:H,currentPage:J}){const[D,I]=r.useState(null),[N,g]=r.useState(null),[k,p]=r.useState(null),[E,i]=r.useState(null),[K,v]=r.useState([]),[M,m]=r.useState([]),[T,u]=r.useState([]),[Q,a]=r.useState({city:"",property:"",unit:"",tenant:""}),d=r.useRef(null),f=r.useRef(null),h=r.useRef(null),y=r.useRef(null),b=r.useRef(null),{data:l,setData:s,post:W,processing:V,errors:C,reset:X,transform:Y}=tt({tenant_id:null,amount:0,dates:"",paid:0,notes:""}),[_,x]=r.useState(""),Z=n=>{const t=parseInt(n);I(t),g(null),p(null),i(null),s("tenant_id",null),a(e=>({...e,city:"",property:"",unit:"",tenant:""})),t&&P[t]?v(P[t]):v([]),m([]),u([])},$=n=>{const t=parseInt(n);g(t),p(null),i(null),s("tenant_id",null),a(e=>({...e,property:"",unit:"",tenant:""})),t&&j[t]?m(j[t]):m([]),u([])},B=n=>{const t=parseInt(n);p(t),i(null),s("tenant_id",null),a(e=>({...e,unit:"",tenant:""})),t&&w[t]?u(w[t]):u([])},O=n=>{const t=parseInt(n),e=T.find(S=>S.id===t);e&&(i(t),s("tenant_id",e.id),a(S=>({...S,tenant:""})))},U=n=>{n.preventDefault(),a({city:"",property:"",unit:"",tenant:""}),x("");let t=!1;D||(a(e=>({...e,city:"Please select a city before submitting the form."})),d.current&&(d.current.focus(),d.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),N||(a(e=>({...e,property:"Please select a property before submitting the form."})),f.current&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),k||(a(e=>({...e,unit:"Please select a unit before submitting the form."})),h.current&&(h.current.focus(),h.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),(!E||!l.tenant_id)&&(a(e=>({...e,tenant:"Please select a tenant before submitting the form."})),y.current&&(y.current.focus(),y.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),(!l.dates||!String(l.dates).trim())&&(x("Please select a payment date."),b.current&&(b.current.focus(),b.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),!t&&(Y(e=>({...e,search:G??null,city:c?.city??null,property:c?.property??null,unit:c?.unit??null,tenant:c?.tenant??null,per_page:H??null,page:J??null})),W(route("payment-plans.store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{A(),q?.()}}))},A=()=>{X(),I(null),g(null),p(null),i(null),a({city:"",property:"",unit:"",tenant:""}),v([]),m([]),u([]),R(!1)};return o.jsx(et,{open:L,onOpenChange:R,modal:!1,children:o.jsx(nt,{size:"half",title:"Create Payment Plan",children:o.jsxs("div",{className:"flex h-full flex-col",children:[o.jsx("div",{className:"flex-1 overflow-auto p-6",children:o.jsxs("form",{onSubmit:U,className:"space-y-4",children:[o.jsx(ot,{cities:z,availableProperties:K,availableUnits:M,availableTenants:T,selectedCity:D,selectedProperty:N,selectedUnit:k,selectedTenant:E,validationErrors:Q,errors:C,onCityChange:Z,onPropertyChange:$,onUnitChange:B,onTenantChange:O,cityRef:d,propertyRef:f,unitRef:h,tenantRef:y}),o.jsx(at,{dates:l.dates,amount:l.amount,paid:l.paid,errors:_?{...C,dates:_}:C,onDatesChange:n=>{s("dates",n),x("")},onAmountChange:n=>s("amount",n),onPaidChange:n=>s("paid",n),dateRef:b}),o.jsx(st,{notes:l.notes,errors:C,onNotesChange:n=>s("notes",n)})]})}),o.jsx(rt,{children:o.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[o.jsx(F,{type:"button",variant:"outline",onClick:A,children:"Cancel"}),o.jsx(F,{type:"submit",onClick:U,disabled:V,children:V?"Creating...":"Create Payment Plan"})]})})]})})})}export{Ht as default};
