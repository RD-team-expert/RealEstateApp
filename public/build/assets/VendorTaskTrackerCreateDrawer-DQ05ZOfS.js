import{r as s,b as ie,j as t}from"./app-IncGAUEB.js";import{B as F}from"./button-BZreYh_c.js";import{D as ae,a as re,b as oe}from"./drawer-BabOL_dj.js";import de from"./CitySection-CNWMi26j.js";import le from"./PropertySection-CYGVAlfu.js";import ce from"./UnitSection-DOgUFviw.js";import ue from"./VendorSection-OQPDgRMV.js";import me from"./TaskSubmissionDateSection-DbWw7bkF.js";import fe from"./ScheduledVisitsSection-CRNnMVzK.js";import _e from"./TaskEndingDateSection-C2BKNsiz.js";import he from"./AssignedTasksSection-CTGBhNyi.js";import pe from"./NotesSection-B-5rN0c9.js";import ge from"./StatusSection-CDk6_fjM.js";import ke from"./UrgencySection-B4tSkYvV.js";import"./app-DgqXL21p.js";import"./index-bCzQdt7o.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-CfKQ6yNG.js";import"./index-BWcAjI1y.js";import"./index-D0fQOWIr.js";import"./index-yZxLUvKN.js";import"./index-iNsZkCT-.js";import"./index-6KC1G_4u.js";import"./x-B_qSqN6z.js";import"./createLucideIcon-Ci0S1m_Z.js";import"./label-BhALl-XJ.js";import"./popover-D0q3r5CP.js";import"./index-DfBxMdWp.js";import"./command-AnX11QHu.js";import"./search-CFDkSiim.js";import"./chevrons-up-down-D4md56fd.js";import"./check-gd2_wZBq.js";import"./calendar-UFpA7cIJ.js";import"./format-PYUiRpxY.js";import"./chevron-left-WEUqp8UO.js";import"./chevron-right-Dv0ELFzT.js";import"./chevron-down-uas8HWR-.js";import"./calendar-CBsjNrh9.js";import"./radioGroup-BhgCKDH3.js";import"./index-X0Rqfk2m.js";import"./index-DizBXXCV.js";function ot({cities:z,vendors:q,propertiesByCity:R,unitsByProperty:j,filters:G,open:H,onOpenChange:E,onSuccess:J}){const g=s.useRef(null),k=s.useRef(null),b=s.useRef(null),v=s.useRef(null),S=s.useRef(null),[K,u]=s.useState(""),[L,d]=s.useState(""),[M,c]=s.useState(""),[Q,m]=s.useState(""),[W,f]=s.useState(""),[P,_]=s.useState([]),[X,h]=s.useState([]),[U,C]=s.useState([]),[D,T]=s.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),y=(e,i)=>{T(l=>({...l,[e]:i}))},{data:n,setData:a,post:Y,processing:A,errors:r,reset:O,transform:Z}=ie({vendor_id:"",unit_id:"",task_submission_date:"",assigned_tasks:"",any_scheduled_visits:"",notes:"",task_ending_date:"",status:"",urgent:"No"}),[o,w]=s.useState(""),[I,x]=s.useState(""),[,p]=s.useState(""),[,V]=s.useState(""),$=e=>{w(e),x(""),p(""),V(""),a("unit_id",""),a("vendor_id",""),u(""),d(""),c(""),e?(R[e]?h(R[e]):h([]),C(q)):(h([]),C([])),_([])},B=e=>{x(e),p(""),a("unit_id",""),d(""),o&&e&&j[o]&&j[o][e]?_(j[o][e]):_([])},ee=e=>{const i=P.find(l=>l.id.toString()===e);i&&(p(i.unit_name),a("unit_id",e),d(""))},te=e=>{const i=U.find(l=>l.id.toString()===e);i&&(V(i.vendor_name),a("vendor_id",e),c(""))},se=e=>{a("assigned_tasks",e.target.value),f("")},N=e=>{e.preventDefault(),u(""),d(""),c(""),m(""),f("");let i=!1;(!o||o.trim()==="")&&(u("Please select a city before submitting the form."),g.current&&(g.current.focus(),g.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.unit_id||n.unit_id.trim()==="")&&(d("Please select a unit before submitting the form."),k.current&&(k.current.focus(),k.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.vendor_id||n.vendor_id.trim()==="")&&(c("Please select a vendor before submitting the form."),b.current&&(b.current.focus(),b.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.task_submission_date||n.task_submission_date.trim()==="")&&(m("Please select a task submission date before submitting the form."),v.current&&(v.current.focus(),v.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!n.assigned_tasks||n.assigned_tasks.trim()==="")&&(f("Please enter assigned tasks before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),!i&&(Z(l=>({...l,redirect_filters:{...G}})),Y(route("vendor-task-tracker.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{O(),w(""),x(""),p(""),V(""),u(""),d(""),c(""),m(""),f(""),_([]),h([]),C([]),T({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),E(!1),J?.()}}))},ne=()=>{O(),w(""),x(""),p(""),V(""),u(""),d(""),c(""),m(""),f(""),_([]),h([]),C([]),T({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),E(!1)};return t.jsx(ae,{open:H,onOpenChange:E,modal:!1,children:t.jsx(re,{size:"half",title:"Create New Vendor Task",children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.jsxs("form",{onSubmit:N,className:"space-y-4",children:[t.jsx(de,{cities:z,selectedCity:o,onCityChange:$,cityRef:g,errors:r,validationError:K}),t.jsx(le,{availableProperties:X,selectedProperty:I,selectedCity:o,onPropertyChange:B}),t.jsx(ce,{availableUnits:P,selectedProperty:I,unitId:n.unit_id,onUnitChange:ee,unitRef:k,errors:r,validationError:L}),t.jsx(ue,{availableVendors:U,selectedCity:o,vendorId:n.vendor_id,onVendorChange:te,vendorRef:b,errors:r,validationError:M}),t.jsx(me,{taskSubmissionDate:n.task_submission_date,calendarOpen:D.task_submission_date,onCalendarOpenChange:e=>y("task_submission_date",e),onDateChange:e=>{a("task_submission_date",e),m("")},taskSubmissionDateRef:v,errors:r,validationError:Q}),t.jsx(fe,{scheduledVisits:n.any_scheduled_visits,calendarOpen:D.any_scheduled_visits,onCalendarOpenChange:e=>y("any_scheduled_visits",e),onDateChange:e=>a("any_scheduled_visits",e),errors:r}),t.jsx(_e,{taskEndingDate:n.task_ending_date,calendarOpen:D.task_ending_date,onCalendarOpenChange:e=>y("task_ending_date",e),onDateChange:e=>a("task_ending_date",e),errors:r}),t.jsx(he,{assignedTasks:n.assigned_tasks,onAssignedTasksChange:se,assignedTasksRef:S,errors:r,validationError:W}),t.jsx(pe,{notes:n.notes,onNotesChange:e=>a("notes",e.target.value),errors:r}),t.jsx(ge,{status:n.status,onStatusChange:e=>a("status",e),errors:r}),t.jsx(ke,{urgent:n.urgent,onUrgentChange:e=>a("urgent",e),errors:r})]})}),t.jsx(oe,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(F,{type:"button",variant:"outline",onClick:ne,className:"flex-1",children:"Cancel"}),t.jsx(F,{type:"submit",onClick:N,disabled:A,className:"flex-1",children:A?"Creating...":"Create Task"})]})})]})})})}export{ot as default};
