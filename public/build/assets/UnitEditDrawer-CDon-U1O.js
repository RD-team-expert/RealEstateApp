import{r as o,b as $,j as n}from"./app-B8FMPvUf.js";import{B as I}from"./button-DIZZiQM7.js";import{D as A,a as z,b as M}from"./drawer-By-qy253.js";import q from"./CityPropertySelector-HWBQ3mqk.js";import G from"./UnitDetailsFields-BuWDX90d.js";import H from"./LeaseInformationFields-B-yKnb99.js";import J from"./FinancialFields-DoVeGFuZ.js";import K from"./UtilitiesFields-IV1XZztV.js";import Q from"./InsuranceFields-cbwVRfwi.js";import W from"./NewLease-BSVlgV6D.js";import X from"./CalculatedValuesDisplay-Dqs8D7u4.js";import"./app-BrEbHAEe.js";import"./index-C_zQ9kkn.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-fZywndxp.js";import"./index-CA_GOVUL.js";import"./index-Ci8SDCQb.js";import"./index-beSbUtJq.js";import"./index-CAMxjZm0.js";import"./index-3cnTBEqV.js";import"./x-krc9GB28.js";import"./createLucideIcon-C8-5KvOO.js";import"./label-mSIjHkAE.js";import"./popover-BMQC-RgO.js";import"./index-9ieSGg2S.js";import"./command-Byz7UfAg.js";import"./search-CLz9Z_Gu.js";import"./FormSection-Bt6Akdi1.js";import"./chevrons-up-down-BYxCyuCA.js";import"./check-BVaiT64F.js";import"./input-DGLwPUn8.js";import"./radioGroup-CuIQOkQ9.js";import"./index-CguEkJq1.js";import"./index-BlkGWg27.js";import"./DatePickerField-Dk---8TM.js";import"./calendar-CzDWs5lf.js";import"./format-PYUiRpxY.js";import"./chevron-left-nbVEm8OA.js";import"./chevron-right-Ccb_WXJ_.js";import"./chevron-down-C7VOkDBv.js";import"./calendar-DesMu7qT.js";const l=e=>{if(!e)return"";const m=e.trim();if(m==="")return"";const c=/^([0-9]{4})-([0-9]{2})-([0-9]{2})/.exec(m);if(!c)return"";const[,u,d,x]=c;return`${u}-${d}-${x}`};function $e({unit:e,cities:m,properties:c,open:u,onOpenChange:d,onSuccess:x,redirectState:E}){const f=o.useRef(null),h=o.useRef(null),[U,y]=o.useState(""),[L,_]=o.useState(""),[P,p]=o.useState(""),[V,w]=o.useState([]),[g,v]=o.useState(""),[S,C]=o.useState({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),b=(t,i)=>{C(j=>({...j,[t]:i}))},{data:r,setData:a,put:F,processing:N,errors:s,transform:R}=$({property_id:e.property_id?.toString()||"",unit_name:e.unit_name||"",tenants:e.tenants||"",lease_start:l(e.lease_start),lease_end:l(e.lease_end),count_beds:e.count_beds?.toString()||"",count_baths:e.count_baths?.toString()||"",lease_status:e.lease_status||"",is_new_lease:e.is_new_lease||"",monthly_rent:e.monthly_rent?.toString()||"",recurring_transaction:e.recurring_transaction||"",utility_status:e.utility_status||"",account_number:e.account_number||"",insurance:e.insurance||"",insurance_expiration_date:l(e.insurance_expiration_date)});o.useEffect(()=>{if(u&&e.property_id&&c){const t=c.find(i=>i.id===e.property_id);t&&t.city_id&&v(t.city_id.toString())}},[u,e.property_id,c]),o.useEffect(()=>{if(g&&c){const t=c.filter(i=>i.city_id?.toString()===g);w(t),r.property_id&&!t.find(i=>i.id.toString()===r.property_id)&&a("property_id","")}else w([])},[g,c]),o.useEffect(()=>{e&&a({property_id:e.property_id?.toString()||"",unit_name:e.unit_name||"",tenants:e.tenants||"",lease_start:l(e.lease_start),lease_end:l(e.lease_end),count_beds:e.count_beds?.toString()||"",count_baths:e.count_baths?.toString()||"",lease_status:e.lease_status||"",is_new_lease:e.is_new_lease||"",monthly_rent:e.monthly_rent?.toString()||"",recurring_transaction:e.recurring_transaction||"",utility_status:e.utility_status||"",account_number:e.account_number||"",insurance:e.insurance||"",insurance_expiration_date:l(e.insurance_expiration_date)})},[e]);const B=t=>{v(t),y(""),_("")},k=t=>{a("property_id",t),_("")},O=t=>{a("unit_name",t.target.value),p("")};o.useEffect(()=>{r.insurance==="No"&&(a("insurance_expiration_date",""),b("insurance_expiration_date",!1))},[r.insurance]);const D=t=>{t.preventDefault(),y(""),_(""),p("");let i=!1;(!r.property_id||r.property_id.trim()==="")&&(_("Please select a property before submitting the form."),f.current&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),(!r.unit_name||r.unit_name.trim()==="")&&(p("Please enter a unit name before submitting the form."),h.current&&(h.current.focus(),h.current.scrollIntoView({behavior:"smooth",block:"center"})),i=!0),!i&&(r.insurance==="No"&&r.insurance_expiration_date!==""&&a("insurance_expiration_date",""),R(j=>({...j,redirect:{filters:E.filters,per_page:E.per_page,page:E.page}})),F(route("units.update",e.id),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{y(""),_(""),p(""),C({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),d(!1),x?.()}}))},T=()=>{a({property_id:e.property_id?.toString()||"",unit_name:e.unit_name||"",tenants:e.tenants||"",lease_start:l(e.lease_start),lease_end:l(e.lease_end),count_beds:e.count_beds?.toString()||"",count_baths:e.count_baths?.toString()||"",lease_status:e.lease_status||"",is_new_lease:e.is_new_lease||"",monthly_rent:e.monthly_rent?.toString()||"",recurring_transaction:e.recurring_transaction||"",utility_status:e.utility_status||"",account_number:e.account_number||"",insurance:e.insurance||"",insurance_expiration_date:l(e.insurance_expiration_date)}),y(""),_(""),p(""),C({lease_start:!1,lease_end:!1,insurance_expiration_date:!1}),d(!1)};return n.jsx(A,{open:u,onOpenChange:d,modal:!1,children:n.jsx(z,{size:"half",title:`Edit Unit - ${e.unit_name}`,children:n.jsxs("div",{className:"flex h-full flex-col",children:[n.jsx("div",{className:"flex-1 overflow-auto p-6",children:n.jsxs("form",{onSubmit:D,className:"space-y-4",children:[n.jsx("div",{className:"mb-6 p-4 bg-secondary border border-border rounded-lg",children:n.jsxs("p",{className:"text-sm text-secondary-foreground",children:[n.jsx("strong",{children:"Note:"})," Vacant, Listed, and Total Applications are automatically calculated based on your inputs."]})}),n.jsx(q,{cities:m,selectedCityId:g,onCityChange:B,availableProperties:V,propertyId:r.property_id,onPropertyChange:k,propertyRef:f,validationError:U,propertyValidationError:L,propertyError:s.property_id}),n.jsx(G,{unitName:r.unit_name,onUnitNameChange:O,unitNameRef:h,unitNameError:s.unit_name,unitNameValidationError:P,tenants:r.tenants,onTenantsChange:t=>a("tenants",t),tenantsError:s.tenants}),n.jsx(H,{leaseStart:r.lease_start,onLeaseStartChange:t=>a("lease_start",t),leaseStartOpen:S.lease_start,onLeaseStartOpenChange:t=>b("lease_start",t),leaseStartError:s.lease_start,leaseEnd:r.lease_end,onLeaseEndChange:t=>a("lease_end",t),leaseEndOpen:S.lease_end,onLeaseEndOpenChange:t=>b("lease_end",t),leaseEndError:s.lease_end,countBeds:r.count_beds,onCountBedsChange:t=>a("count_beds",t),countBedsError:s.count_beds,countBaths:r.count_baths,onCountBathsChange:t=>a("count_baths",t),countBathsError:s.count_baths,leaseStatus:r.lease_status,onLeaseStatusChange:t=>a("lease_status",t),leaseStatusError:s.lease_status}),n.jsx(W,{isNewLease:r.is_new_lease,onIsNewLeaseChange:t=>a("is_new_lease",t),error:s.is_new_lease}),n.jsx(J,{monthlyRent:r.monthly_rent,onMonthlyRentChange:t=>a("monthly_rent",t),monthlyRentError:s.monthly_rent,recurringTransaction:r.recurring_transaction,onRecurringTransactionChange:t=>a("recurring_transaction",t),recurringTransactionError:s.recurring_transaction}),n.jsx(K,{utilityStatus:r.utility_status,onUtilityStatusChange:t=>a("utility_status",t),utilityStatusError:s.utility_status,accountNumber:r.account_number,onAccountNumberChange:t=>a("account_number",t),accountNumberError:s.account_number}),n.jsx(Q,{insurance:r.insurance,onInsuranceChange:t=>a("insurance",t),insuranceError:s.insurance,insuranceExpirationDate:r.insurance_expiration_date,onInsuranceExpirationDateChange:t=>a("insurance_expiration_date",t),insuranceExpirationOpen:S.insurance_expiration_date,onInsuranceExpirationOpenChange:t=>b("insurance_expiration_date",t),insuranceExpirationDateError:s.insurance_expiration_date}),n.jsx(X,{unit:e})]})}),n.jsx(M,{className:"border-t bg-background",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx(I,{type:"submit",onClick:D,disabled:N,className:"flex-1",children:N?"Updating...":"Update Unit"}),n.jsx(I,{type:"button",variant:"outline",onClick:T,disabled:N,className:"flex-1",children:"Cancel"})]})})]})})})}export{$e as default};
