import{r as j,j as e,H as S,L as u,b as f}from"./app-DnZTfT0_.js";import{u as _,A as D}from"./app-layout-NpEgK4_T.js";import{B as o}from"./app-logo-icon-Bc2eyx79.js";import{I as T}from"./input-DQ_wq_vv.js";import{C,a as A,b as L,c as E}from"./card-C4RmjogZ.js";import{P as $,T as U,a as V,b as g,c as a,d as B,e as n,f as P}from"./table-7_H-LZJM.js";import{B as v}from"./badge-CCSbDhbi.js";import{D as I}from"./download-DrHPYDYz.js";import{S as R}from"./search-D1fLgR4z.js";import{E as H}from"./eye-Cf9la-Va.js";import{S as z}from"./square-pen-qd8CnHV4.js";import"./app-8ZSuAH30.js";import"./index-CToc1y-v.js";import"./index-D6oF8zzd.js";const O=(s,m="vendor-tasks.csv")=>{const i=[["ID","City","Submission Date","Vendor Name","Unit Name","Assigned Tasks","Scheduled Visits","Task End Date","Notes","Status","Urgent"].join(","),...s.map(r=>[r.id,`"${r.city}"`,`"${new Date(r.task_submission_date).toLocaleDateString()}"`,`"${r.vendor_name}"`,`"${r.unit_name}"`,`"${(r.assigned_tasks||"").replace(/"/g,'""')}"`,`"${r.any_scheduled_visits?new Date(r.any_scheduled_visits).toLocaleDateString():"N/A"}"`,`"${r.task_ending_date?new Date(r.task_ending_date).toLocaleDateString():"N/A"}"`,`"${(r.notes||"").replace(/"/g,'""')}"`,`"${r.status||""}"`,`"${r.urgent}"`].join(","))].join(`
`),c=new Blob([i],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),l=URL.createObjectURL(c);d.setAttribute("href",l),d.setAttribute("download",m),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(l)};function se({tasks:s,search:m}){const{hasPermission:x,hasAnyPermission:i,hasAllPermissions:c}=_(),[d,l]=j.useState(m||""),[r,h]=j.useState(!1),p=t=>{t.preventDefault(),f.get(route("vendor-task-tracker.index"),{search:d},{preserveState:!0})},N=t=>{confirm("Are you sure you want to delete this task?")&&f.delete(route("vendor-task-tracker.destroy",t.id))},y=()=>{if(s.data.length===0){alert("No data to export");return}h(!0);try{const t=`vendor-tasks-${new Date().toISOString().split("T")[0]}.csv`;O(s.data,t)}catch(t){console.error("Export failed:",t),alert("Export failed. Please try again.")}finally{h(!1)}},b=t=>e.jsx(v,{variant:t==="Yes"?"destructive":"secondary",children:t}),k=t=>{if(!t)return null;const w=t.toLowerCase().includes("completed")?"default":t.toLowerCase().includes("pending")?"secondary":"outline";return e.jsx(v,{variant:w,children:t})};return e.jsxs(D,{children:[e.jsx(S,{title:"Vendor Task Tracker"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs(C,{children:[e.jsxs(A,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(L,{className:"text-2xl text-foreground",children:"Vendor Task Tracker"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex gap-1",children:e.jsxs(o,{variant:"outline",size:"sm",onClick:y,disabled:r||s.data.length===0,className:"flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),r?"Exporting...":"Export CSV"]})}),c(["vendor-task-tracker.create","vendor-task-tracker.store"])&&e.jsx(u,{href:route("vendor-task-tracker.create"),children:e.jsxs(o,{children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Add Task"]})})]})]}),e.jsxs("form",{onSubmit:p,className:"flex gap-2 mt-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(T,{type:"text",placeholder:"Search tasks by city, vendor, unit, or status...",value:d,onChange:t=>l(t.target.value),className:"bg-background text-foreground placeholder:text-muted-foreground"})}),e.jsx(o,{type:"submit",children:e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsxs(E,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(U,{children:[e.jsx(V,{children:e.jsxs(g,{className:"border-border",children:[e.jsx(a,{className:"text-muted-foreground",children:"City"}),e.jsx(a,{className:"text-muted-foreground",children:"Submission Date"}),e.jsx(a,{className:"text-muted-foreground",children:"Vendor Name"}),e.jsx(a,{className:"text-muted-foreground",children:"Unit Name"}),e.jsx(a,{className:"text-muted-foreground",children:"Assigned Tasks"}),e.jsx(a,{className:"text-muted-foreground",children:"Scheduled Visits"}),e.jsx(a,{className:"text-muted-foreground",children:"Task End Date"}),e.jsx(a,{className:"text-muted-foreground",children:"Note"}),e.jsx(a,{className:"text-muted-foreground",children:"Status"}),e.jsx(a,{className:"text-muted-foreground",children:"Urgent"}),i(["vendor-task-tracker.show","vendor-task-tracker.edit","vendor-task-tracker.update","vendor-task-tracker.destroy"])&&e.jsx(a,{className:"text-muted-foreground",children:"Actions"})]})}),e.jsx(B,{children:s.data.map(t=>e.jsxs(g,{className:"hover:bg-muted/50 border-border",children:[e.jsx(n,{className:"font-medium text-foreground",children:t.city}),e.jsx(n,{className:"text-foreground",children:new Date(t.task_submission_date).toLocaleDateString()}),e.jsx(n,{className:"text-foreground",children:t.vendor_name}),e.jsx(n,{className:"text-foreground",children:t.unit_name}),e.jsx(n,{className:"max-w-xs truncate text-foreground",children:t.assigned_tasks}),e.jsx(n,{className:"text-foreground",children:t.any_scheduled_visits?new Date(t.any_scheduled_visits).toLocaleDateString():"N/A"}),e.jsx(n,{className:"text-foreground",children:t.task_ending_date?new Date(t.task_ending_date).toLocaleDateString():"N/A"}),e.jsx(n,{className:"font-medium text-foreground",children:t.notes}),e.jsx(n,{children:k(t.status)}),e.jsx(n,{children:b(t.urgent)}),i(["vendor-task-tracker.show","vendor-task-tracker.edit","vendor-task-tracker.update","vendor-task-tracker.destroy"])&&e.jsx(n,{children:e.jsxs("div",{className:"flex gap-1",children:[x("vendor-task-tracker.show")&&e.jsx(u,{href:route("vendor-task-tracker.show",t.id),children:e.jsx(o,{variant:"outline",size:"sm",children:e.jsx(H,{className:"h-4 w-4"})})}),c(["vendor-task-tracker.edit","vendor-task-tracker.update"])&&e.jsx(u,{href:route("vendor-task-tracker.edit",t.id),children:e.jsx(o,{variant:"outline",size:"sm",children:e.jsx(z,{className:"h-4 w-4"})})}),x("vendor-task-tracker.destroy")&&e.jsx(o,{variant:"outline",size:"sm",onClick:()=>N(t),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:e.jsx(P,{className:"h-4 w-4"})})]})})]},t.id))})]})}),s.data.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-lg",children:"No tasks found."}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search criteria."})]}),s.meta&&e.jsx("div",{className:"mt-6 flex justify-between items-center",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",s.meta.from||0," to ",s.meta.to||0," of ",s.meta.total||0," results"]})})]})]})})})]})}export{se as default};
