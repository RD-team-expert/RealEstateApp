import{r as d,b as oe,j as e}from"./app-BkyZySAt.js";import{B as m}from"./button-DOkiOPMq.js";import{P as v,a as g,b as N,C as y,p as _e}from"./popover-D_YIvH1C.js";import{D as me,a as ce,b as ue}from"./drawer-BQHCt03g.js";import{L as n}from"./label-BCoYkVMj.js";import{R as D}from"./radioGroup-DeV4OTT4.js";import{S as z,a as U,b as L,c as T,d as G}from"./select-RK3poDcU.js";import{C as S}from"./calendar-5wwCpl_0.js";import{f,i as fe}from"./format-PYUiRpxY.js";import"./app-oDNfBSri.js";import"./index-DJP-tLWC.js";import"./utils-CBfrqCZ4.js";import"./createLucideIcon-D3eUMA-Y.js";import"./chevron-right-Dq99BrXh.js";import"./chevron-down-BKwinLVR.js";import"./index-D86DOQfL.js";import"./index-CSRjvr9u.js";import"./index-CEATnq5y.js";import"./index-m091_WFs.js";import"./index-Zsm6T9Ra.js";import"./index-B2wSjM2m.js";import"./index-DCBTnY57.js";import"./index-B_abII33.js";import"./index-Dc_FVRD7.js";import"./index-DBw3aPE3.js";import"./index-DzIcFn8W.js";import"./x-B9Nlqjs5.js";import"./index-DvetPajZ.js";import"./index-DsMWzC3p.js";import"./index-DEy3YO5y.js";import"./check-MTPBeqEd.js";import"./chevron-up-CJrmsHZ1.js";function Je({moveIn:s,units:X,cities:Z,properties:M,unitsByProperty:x,open:I,onOpenChange:Y,onSuccess:B}){const P=d.useRef(null),V=d.useRef(null),k=d.useRef(null),[H,h]=d.useState(""),[K,E]=d.useState(""),[q,C]=d.useState(""),[ee,R]=d.useState([]),[te,A]=d.useState([]),[F,$]=d.useState(""),[w,O]=d.useState(""),c=t=>{if(!(!t||t.trim()===""))try{const l=_e(t,"yyyy-MM-dd",new Date);return fe(l)?l:void 0}catch(l){console.warn("Failed to parse date:",t,l);return}},p=t=>{const l=c(t);if(!l)return"Pick a date";try{return f(l,"PPP")}catch(_){return console.warn("Failed to format date:",t,_),"Pick a date"}},[j,se]=d.useState({lease_signing_date:!1,move_in_date:!1,scheduled_paid_time:!1,move_in_form_sent_date:!1,date_of_move_in_form_filled:!1,date_of_insurance_expiration:!1}),o=(t,l)=>{se(_=>({..._,[t]:l}))},ie=()=>{if(!s.unit_id)return{cityId:"",propertyId:""};const t=X.find(_=>_.id===s.unit_id);if(!t)return{cityId:"",propertyId:""};const l=M.find(_=>_.property_name===t.property_name);return l?{cityId:l.city_id?.toString()||"",propertyId:l.id.toString()}:{cityId:"",propertyId:""}},{cityId:b,propertyId:u}=ie(),{data:i,setData:r,put:ae,processing:J,errors:a}=oe({unit_id:s.unit_id??"",signed_lease:s.signed_lease??"No",lease_signing_date:s.lease_signing_date??"",move_in_date:s.move_in_date??"",paid_security_deposit_first_month_rent:s.paid_security_deposit_first_month_rent??"No",scheduled_paid_time:s.scheduled_paid_time??"",handled_keys:s.handled_keys??"No",move_in_form_sent_date:s.move_in_form_sent_date??"",filled_move_in_form:s.filled_move_in_form??"No",date_of_move_in_form_filled:s.date_of_move_in_form_filled??"",submitted_insurance:s.submitted_insurance??"No",date_of_insurance_expiration:s.date_of_insurance_expiration??""});d.useEffect(()=>{$(b),O(u)},[b,u]),d.useEffect(()=>{if(b){const t=M.filter(l=>l.city_id?.toString()===b);A(t)}u&&x[u]&&R(x[u])},[b,u,M,x]);const Q=()=>{h(""),E(""),C("")},le=t=>{if($(t),O(""),r("unit_id",""),E(""),C(""),h(""),t){const l=M.filter(_=>_.city_id?.toString()===t);A(l)}else A([]);R([])},re=t=>{O(t),r("unit_id",""),C(""),h(""),t&&x&&x[t]?R(x[t]):R([])},ne=t=>{r("unit_id",parseInt(t)),h("")},W=t=>{t.preventDefault(),h(""),E(""),C("");let l=!1;(!F||F.trim()==="")&&(E("Please select a city before submitting the form."),V.current&&(V.current.focus(),V.current.scrollIntoView({behavior:"smooth",block:"center"})),l=!0),(!w||w.trim()==="")&&(C("Please select a property before submitting the form."),k.current&&(k.current.focus(),k.current.scrollIntoView({behavior:"smooth",block:"center"})),l=!0),(!i.unit_id||typeof i.unit_id!="number"||i.unit_id<=0)&&(h("Please select a unit before submitting the form."),P.current&&(P.current.focus(),P.current.scrollIntoView({behavior:"smooth",block:"center"})),l=!0),!l&&ae(route("move-in.update",s.id),{onSuccess:()=>{Q(),Y(!1),B?.()}})},de=()=>{r({unit_id:s.unit_id??"",signed_lease:s.signed_lease??"No",lease_signing_date:s.lease_signing_date??"",move_in_date:s.move_in_date??"",paid_security_deposit_first_month_rent:s.paid_security_deposit_first_month_rent??"No",scheduled_paid_time:s.scheduled_paid_time??"",handled_keys:s.handled_keys??"No",move_in_form_sent_date:s.move_in_form_sent_date??"",filled_move_in_form:s.filled_move_in_form??"No",date_of_move_in_form_filled:s.date_of_move_in_form_filled??"",submitted_insurance:s.submitted_insurance??"No",date_of_insurance_expiration:s.date_of_insurance_expiration??""}),$(b),O(u),Q(),Y(!1)};return e.jsx(me,{open:I,onOpenChange:Y,modal:!1,children:e.jsx(ce,{size:"half",title:`Edit Move-In Record #${s.id}`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-slate-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"city_id",className:"text-base font-semibold",children:"City *"})}),e.jsxs(z,{onValueChange:le,value:F,children:[e.jsx(U,{ref:V,children:e.jsx(L,{placeholder:"Select city"})}),e.jsx(T,{children:Z.map(t=>e.jsx(G,{value:t.id.toString(),children:t.city},t.id))})]}),a.unit_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Please select a valid unit."}),K&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:K})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-gray-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"property_id",className:"text-base font-semibold",children:"Property *"})}),e.jsxs(z,{onValueChange:re,value:w,disabled:!F,children:[e.jsx(U,{ref:k,children:e.jsx(L,{placeholder:F?"Select property":"Select city first"})}),e.jsx(T,{children:te.map(t=>e.jsx(G,{value:t.id.toString(),children:t.property_name},t.id))})]}),q&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:q})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"unit_id",className:"text-base font-semibold",children:"Unit Name *"})}),e.jsxs(z,{onValueChange:ne,value:i.unit_id?i.unit_id.toString():"",disabled:!w,children:[e.jsx(U,{ref:P,children:e.jsx(L,{placeholder:w?"Select unit":"Select property first"})}),e.jsx(T,{children:ee.map(t=>e.jsx(G,{value:t.id.toString(),children:t.unit_name},t.id))})]}),a.unit_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.unit_id}),H&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:H})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"signed_lease",className:"text-base font-semibold",children:"Signed Lease *"})}),e.jsx(D,{value:i.signed_lease,onValueChange:t=>r("signed_lease",t),name:"signed_lease",options:[{value:"No",label:"No"},{value:"Yes",label:"Yes"}]}),a.signed_lease&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.signed_lease})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-purple-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"lease_signing_date",className:"text-base font-semibold",children:"Lease Signing Date"})}),e.jsxs(v,{open:j.lease_signing_date,onOpenChange:t=>o("lease_signing_date",t),modal:!1,children:[e.jsx(g,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:`w-full justify-start text-left font-normal ${!i.lease_signing_date&&"text-muted-foreground"}`,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),p(i.lease_signing_date)]})}),e.jsx(N,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:c(i.lease_signing_date),onSelect:t=>{t&&(r("lease_signing_date",f(t,"yyyy-MM-dd")),o("lease_signing_date",!1))},initialFocus:!0})})]}),a.lease_signing_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.lease_signing_date})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"move_in_date",className:"text-base font-semibold",children:"Move-In Date"})}),e.jsxs(v,{open:j.move_in_date,onOpenChange:t=>o("move_in_date",t),modal:!1,children:[e.jsx(g,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:`w-full justify-start text-left font-normal ${!i.move_in_date&&"text-muted-foreground"}`,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),p(i.move_in_date)]})}),e.jsx(N,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:c(i.move_in_date),onSelect:t=>{t&&(r("move_in_date",f(t,"yyyy-MM-dd")),o("move_in_date",!1))},initialFocus:!0})})]}),a.move_in_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.move_in_date})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"paid_security_deposit_first_month_rent",className:"text-base font-semibold",children:"Paid Security Deposit & First Month Rent"})}),e.jsx(D,{value:i.paid_security_deposit_first_month_rent,onValueChange:t=>r("paid_security_deposit_first_month_rent",t),name:"paid_security_deposit_first_month_rent",options:[{value:"No",label:"No"},{value:"Yes",label:"Yes"}]}),a.paid_security_deposit_first_month_rent&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.paid_security_deposit_first_month_rent})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"scheduled_paid_time",className:"text-base font-semibold",children:"Scheduled Paid Time"})}),e.jsxs(v,{open:j.scheduled_paid_time,onOpenChange:t=>o("scheduled_paid_time",t),modal:!1,children:[e.jsx(g,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:`w-full justify-start text-left font-normal ${!i.scheduled_paid_time&&"text-muted-foreground"}`,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),p(i.scheduled_paid_time)]})}),e.jsx(N,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:c(i.scheduled_paid_time),onSelect:t=>{t&&(r("scheduled_paid_time",f(t,"yyyy-MM-dd")),o("scheduled_paid_time",!1))},initialFocus:!0})})]}),a.scheduled_paid_time&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.scheduled_paid_time})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"handled_keys",className:"text-base font-semibold",children:"Handled Keys"})}),e.jsx(D,{value:i.handled_keys,onValueChange:t=>r("handled_keys",t),name:"handled_keys",options:[{value:"No",label:"No"},{value:"Yes",label:"Yes"}]}),a.handled_keys&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.handled_keys})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"move_in_form_sent_date",className:"text-base font-semibold",children:"Move-In Form Sent Date"})}),e.jsxs(v,{open:j.move_in_form_sent_date,onOpenChange:t=>o("move_in_form_sent_date",t),modal:!1,children:[e.jsx(g,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:`w-full justify-start text-left font-normal ${!i.move_in_form_sent_date&&"text-muted-foreground"}`,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),p(i.move_in_form_sent_date)]})}),e.jsx(N,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:c(i.move_in_form_sent_date),onSelect:t=>{t&&(r("move_in_form_sent_date",f(t,"yyyy-MM-dd")),o("move_in_form_sent_date",!1))},initialFocus:!0})})]}),a.move_in_form_sent_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.move_in_form_sent_date})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-red-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"filled_move_in_form",className:"text-base font-semibold",children:"Filled Move-In Form"})}),e.jsx(D,{value:i.filled_move_in_form,onValueChange:t=>r("filled_move_in_form",t),name:"filled_move_in_form",options:[{value:"No",label:"No"},{value:"Yes",label:"Yes"}]}),a.filled_move_in_form&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.filled_move_in_form})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-yellow-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"date_of_move_in_form_filled",className:"text-base font-semibold",children:"Date of Move-In Form Filled"})}),e.jsxs(v,{open:j.date_of_move_in_form_filled,onOpenChange:t=>o("date_of_move_in_form_filled",t),modal:!1,children:[e.jsx(g,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:`w-full justify-start text-left font-normal ${!i.date_of_move_in_form_filled&&"text-muted-foreground"}`,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),p(i.date_of_move_in_form_filled)]})}),e.jsx(N,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:c(i.date_of_move_in_form_filled),onSelect:t=>{t&&(r("date_of_move_in_form_filled",f(t,"yyyy-MM-dd")),o("date_of_move_in_form_filled",!1))},initialFocus:!0})})]}),a.date_of_move_in_form_filled&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.date_of_move_in_form_filled})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-cyan-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"submitted_insurance",className:"text-base font-semibold",children:"Submitted Insurance"})}),e.jsx(D,{value:i.submitted_insurance,onValueChange:t=>r("submitted_insurance",t),name:"submitted_insurance",options:[{value:"No",label:"No"},{value:"Yes",label:"Yes"}]}),a.submitted_insurance&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.submitted_insurance})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-violet-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(n,{htmlFor:"date_of_insurance_expiration",className:"text-base font-semibold",children:"Date of Insurance Expiration"})}),e.jsxs(v,{open:j.date_of_insurance_expiration,onOpenChange:t=>o("date_of_insurance_expiration",t),modal:!1,children:[e.jsx(g,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:`w-full justify-start text-left font-normal ${!i.date_of_insurance_expiration&&"text-muted-foreground"}`,children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),p(i.date_of_insurance_expiration)]})}),e.jsx(N,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(y,{mode:"single",selected:c(i.date_of_insurance_expiration),onSelect:t=>{t&&(r("date_of_insurance_expiration",f(t,"yyyy-MM-dd")),o("date_of_insurance_expiration",!1))},initialFocus:!0})})]}),a.date_of_insurance_expiration&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.date_of_insurance_expiration})]})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"flex w-full justify-end gap-2",children:[e.jsx(m,{type:"button",variant:"outline",onClick:de,children:"Cancel"}),e.jsx(m,{type:"submit",disabled:J,onClick:W,children:J?"Updating...":"Update Move-In Record"})]})})]})})})}export{Je as default};
