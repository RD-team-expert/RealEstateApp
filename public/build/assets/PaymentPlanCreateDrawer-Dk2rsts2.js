import{r,b as Q,j as o}from"./app-DIEWn7Ix.js";import{D as W,a as X,b as Y}from"./drawer-fqLIckn8.js";import{B as _}from"./button-C0qpziZb.js";import Z from"./LocationTenantSelection-uNGfugF_.js";import $ from"./PaymentPlanDetails-BaCruqzN.js";import B from"./NotesSection-B8ym9aS4.js";import"./app-ChTVGdbA.js";import"./index-DKA-WKms.js";import"./index-Bt0zfGgm.js";import"./index-VPuXs-fY.js";import"./index-C4fRG95q.js";import"./index-BtB4-ACe.js";import"./index-BBSsUOtm.js";import"./index-BWA9V35X.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-imATtpBe.js";import"./createLucideIcon-lZMskSwP.js";import"./label-BIgMUqDa.js";import"./select-DaMc0ZYU.js";import"./index-Dc_FVRD7.js";import"./index-Bp33PYYw.js";import"./index-DwaLeO51.js";import"./index-DWHJnJ6z.js";import"./index-B14YlqPx.js";import"./index-OmisV_7g.js";import"./chevron-down-DABifuem.js";import"./check-CBvn5g3p.js";import"./chevron-up-DPOsvpyl.js";import"./calendar-A7iFafDy.js";import"./format-PYUiRpxY.js";import"./chevron-left-CWUKElF8.js";import"./chevron-right-lBI-HPj1.js";import"./input-Dp80VBC1.js";import"./popover-BTBKKAKu.js";import"./calendar-BV4TAGR8.js";import"./textarea-DmwE5RE4.js";function At({cities:E,propertiesByCityId:g,unitsByPropertyId:P,tenantsByUnitId:v,open:U,onOpenChange:S,onSuccess:A}){const[j,w]=r.useState(null),[N,b]=r.useState(null),[D,u]=r.useState(null),[I,i]=r.useState(null),[F,y]=r.useState([]),[z,m]=r.useState([]),[R,l]=r.useState([]),[L,a]=r.useState({city:"",property:"",unit:"",tenant:""}),p=r.useRef(null),f=r.useRef(null),d=r.useRef(null),h=r.useRef(null),{data:c,setData:s,post:q,processing:T,errors:C,reset:G}=Q({tenant_id:null,amount:0,dates:"",paid:0,notes:""}),H=e=>{const t=parseInt(e);w(t),b(null),u(null),i(null),s("tenant_id",null),a(n=>({...n,city:"",property:"",unit:"",tenant:""})),t&&g[t]?y(g[t]):y([]),m([]),l([])},J=e=>{const t=parseInt(e);b(t),u(null),i(null),s("tenant_id",null),a(n=>({...n,property:"",unit:"",tenant:""})),t&&P[t]?m(P[t]):m([]),l([])},K=e=>{const t=parseInt(e);u(t),i(null),s("tenant_id",null),a(n=>({...n,unit:"",tenant:""})),t&&v[t]?l(v[t]):l([])},M=e=>{const t=parseInt(e),n=R.find(x=>x.id===t);n&&(i(t),s("tenant_id",n.id),a(x=>({...x,tenant:""})))},k=e=>{e.preventDefault(),a({city:"",property:"",unit:"",tenant:""});let t=!1;j||(a(n=>({...n,city:"Please select a city before submitting the form."})),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),N||(a(n=>({...n,property:"Please select a property before submitting the form."})),f.current&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),D||(a(n=>({...n,unit:"Please select a unit before submitting the form."})),d.current&&(d.current.focus(),d.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),(!I||!c.tenant_id)&&(a(n=>({...n,tenant:"Please select a tenant before submitting the form."})),h.current&&(h.current.focus(),h.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),!t&&q(route("payment-plans.store"),{onSuccess:()=>{V(),A?.()}})},V=()=>{G(),w(null),b(null),u(null),i(null),a({city:"",property:"",unit:"",tenant:""}),y([]),m([]),l([]),S(!1)};return o.jsx(W,{open:U,onOpenChange:S,modal:!1,children:o.jsx(X,{size:"half",title:"Create Payment Plan",children:o.jsxs("div",{className:"flex h-full flex-col",children:[o.jsx("div",{className:"flex-1 overflow-auto p-6",children:o.jsxs("form",{onSubmit:k,className:"space-y-4",children:[o.jsx(Z,{cities:E,availableProperties:F,availableUnits:z,availableTenants:R,selectedCity:j,selectedProperty:N,selectedUnit:D,selectedTenant:I,validationErrors:L,errors:C,onCityChange:H,onPropertyChange:J,onUnitChange:K,onTenantChange:M,cityRef:p,propertyRef:f,unitRef:d,tenantRef:h}),o.jsx($,{dates:c.dates,amount:c.amount,paid:c.paid,errors:C,onDatesChange:e=>s("dates",e),onAmountChange:e=>s("amount",e),onPaidChange:e=>s("paid",e)}),o.jsx(B,{notes:c.notes,errors:C,onNotesChange:e=>s("notes",e)})]})}),o.jsx(Y,{children:o.jsxs("div",{className:"flex justify-end gap-2 w-full",children:[o.jsx(_,{type:"button",variant:"outline",onClick:V,children:"Cancel"}),o.jsx(_,{type:"submit",onClick:k,disabled:T,children:T?"Creating...":"Create Payment Plan"})]})})]})})})}export{At as default};
