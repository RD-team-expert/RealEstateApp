import{r as c,b as pe,j as e}from"./app-C79wt3tX.js";import{B as N}from"./createLucideIcon-C1z_f29J.js";import{P as O,a as z,f,b as L,C as R,i as y,p as he}from"./popover-EABh-nYt.js";import{D as ue,a as _e,b as fe}from"./drawer-wgoO6h1K.js";import{I as je}from"./input-BS89LrTW.js";import{L as o}from"./label-CArU7ATR.js";import{R as g}from"./radioGroup-4V0hsG5D.js";import{S,a as P,b as C,c as w,d as F}from"./select-4_arDXlR.js";import{C as B}from"./calendar-DZOiGQZc.js";import"./app-Do7cDRzv.js";import"./chevron-right-CkaRxpST.js";import"./index-DMpLQi-Z.js";import"./index-ChhieIKn.js";import"./index-DkjncacZ.js";import"./index-CkXl1I8e.js";import"./index-DLJGb8q0.js";import"./index-BUbw163t.js";function ke({record:a,cities:H,properties:D,units:E,tenants:I,notices:Y,open:T,onOpenChange:M,onSuccess:Z}){const[m,x]=c.useState({}),[p,G]=c.useState(null),[h,k]=c.useState(null),[u,V]=c.useState(null),[W,q]=c.useState([]),[J,$]=c.useState([]),[K,U]=c.useState([]),[A,ee]=c.useState({date:!1,hearing_dates:!1,writ_date:!1}),j=(t,s)=>{ee(l=>({...l,[t]:s}))},_=t=>{if(!(!t||t.trim()===""))try{const s=he(t,"yyyy-MM-dd",new Date);if(y(s))return s;const l=new Date(t);return y(l)?l:void 0}catch(s){console.warn("Date parsing error:",s);return}},v=t=>{if(!t||t.trim()==="")return"";const s=_(t);return s&&y(s)?f(s,"yyyy-MM-dd"):""},{data:n,setData:d,put:te,processing:Q,errors:i}=pe({tenant_id:a.tenant_id||null,status:a.status||"",date:v(a.date)||"",type_of_notice:a.type_of_notice||"",have_an_exception:a.have_an_exception||"",note:a.note||"",evictions:a.evictions||"",sent_to_atorney:a.sent_to_atorney||"",hearing_dates:v(a.hearing_dates)||"",evected_or_payment_plan:a.evected_or_payment_plan||"",if_left:a.if_left||"",writ_date:v(a.writ_date)||""});c.useEffect(()=>{if(a&&a.tenant_id&&T){const t=I.find(s=>s.id===a.tenant_id);if(t){const s=E.find(l=>l.id===t.unit_id);if(s){const l=D.find(r=>r.id===s.property_id);if(l){G(l.city_id);const r=D.filter(b=>b.city_id===l.city_id);q(r),k(l.id);const me=E.filter(b=>b.property_id===l.id);$(me),V(s.id);const xe=I.filter(b=>b.unit_id===s.id);U(xe)}}}}},[a,I,E,D,T]);const se=t=>{const s=parseInt(t);G(s),k(null),V(null),d("tenant_id",null);const l=D.filter(r=>r.city_id===s);q(l),$([]),U([]),x(r=>({...r,city:"",property:"",unit:"",tenant:""}))},ae=t=>{const s=parseInt(t);k(s),V(null),d("tenant_id",null);const l=E.filter(r=>r.property_id===s);$(l),U([]),x(r=>({...r,property:"",unit:"",tenant:""}))},ne=t=>{const s=parseInt(t);V(s),d("tenant_id",null);const l=I.filter(r=>r.unit_id===s);U(l),x(r=>({...r,unit:"",tenant:""}))},le=t=>{const s=parseInt(t);d("tenant_id",s),x(l=>({...l,tenant:""}))},X=t=>{t.preventDefault(),x({});let s=!1;const l={};if(p||(l.city="Please select a city before submitting the form.",s=!0),h||(l.property="Please select a property before submitting the form.",s=!0),u||(l.unit="Please select a unit before submitting the form.",s=!0),n.tenant_id||(l.tenant="Please select a tenant before submitting the form.",s=!0),s){x(l);return}te(`/notice_and_evictions/${a.id}`,{onSuccess:()=>{x({}),M(!1),Z?.()},onError:r=>{console.log("Form submission errors:",r)}})},ie=()=>{d({tenant_id:a.tenant_id||null,status:a.status||"",date:v(a.date)||"",type_of_notice:a.type_of_notice||"",have_an_exception:a.have_an_exception||"",note:a.note||"",evictions:a.evictions||"",sent_to_atorney:a.sent_to_atorney||"",hearing_dates:v(a.hearing_dates)||"",evected_or_payment_plan:a.evected_or_payment_plan||"",if_left:a.if_left||"",writ_date:v(a.writ_date)||""}),x({}),M(!1)},re=()=>H.find(s=>s.id===p)?.city||"",de=()=>W.find(s=>s.id===h)?.property_name||"",oe=()=>J.find(s=>s.id===u)?.unit_name||"",ce=()=>{const t=K.find(s=>s.id===n.tenant_id);return t?`${t.first_name} ${t.last_name}`:""};return e.jsx(ue,{open:T,onOpenChange:M,modal:!1,children:e.jsx(_e,{size:"half",title:`Edit Notice & Eviction (ID: ${a.id})`,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border-l-4 border-l-blue-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"city",className:"text-base font-semibold",children:"City *"})}),e.jsxs(S,{onValueChange:se,value:p?.toString()||"",children:[e.jsx(P,{children:e.jsx(C,{placeholder:"Select city"})}),e.jsx(w,{children:H.map(t=>e.jsx(F,{value:t.id.toString(),children:t.city},t.id))})]}),m.city&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.city})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"property",className:"text-base font-semibold",children:"Property *"})}),e.jsxs(S,{onValueChange:ae,value:h?.toString()||"",disabled:!p,children:[e.jsx(P,{className:p?"":"opacity-50",children:e.jsx(C,{placeholder:p?"Select property":"Select city first"})}),e.jsx(w,{children:W.map(t=>e.jsx(F,{value:t.id.toString(),children:t.property_name},t.id))})]}),m.property&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.property})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-green-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"unit",className:"text-base font-semibold",children:"Unit *"})}),e.jsxs(S,{onValueChange:ne,value:u?.toString()||"",disabled:!h,children:[e.jsx(P,{className:h?"":"opacity-50",children:e.jsx(C,{placeholder:h?"Select unit":"Select property first"})}),e.jsx(w,{children:J.map(t=>e.jsx(F,{value:t.id.toString(),children:t.unit_name},t.id))})]}),m.unit&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.unit})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"tenant",className:"text-base font-semibold",children:"Tenant *"})}),e.jsxs(S,{onValueChange:le,value:n.tenant_id?.toString()||"",disabled:!u,children:[e.jsx(P,{className:u?"":"opacity-50",children:e.jsx(C,{placeholder:u?"Select tenant":"Select unit first"})}),e.jsx(w,{children:K.map(t=>e.jsxs(F,{value:t.id.toString(),children:[t.first_name," ",t.last_name]},t.id))})]}),i.tenant_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.tenant_id}),m.tenant&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.tenant})]}),(p||h||u||n.tenant_id)&&e.jsxs("div",{className:"rounded-lg border-l-4 border-l-gray-500 bg-gray-50 p-4",children:[e.jsx(o,{className:"text-base font-semibold text-gray-700",children:"Current Selection"}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm text-gray-600",children:[p&&e.jsxs("p",{children:[e.jsx("strong",{children:"City:"})," ",re()]}),h&&e.jsxs("p",{children:[e.jsx("strong",{children:"Property:"})," ",de()]}),u&&e.jsxs("p",{children:[e.jsx("strong",{children:"Unit:"})," ",oe()]}),n.tenant_id&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tenant:"})," ",ce()]})]})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-purple-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"status",className:"text-base font-semibold",children:"Status"})}),e.jsx(g,{value:n.status,onValueChange:t=>d("status",t),name:"status",options:[{value:"Posted",label:"Posted"},{value:"Sent to representative",label:"Sent to representative"}]}),i.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.status})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-orange-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"date",className:"text-base font-semibold",children:"Date"})}),e.jsxs(O,{open:A.date,onOpenChange:t=>j("date",t),modal:!1,children:[e.jsx(z,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:`w-full justify-start text-left font-normal ${!n.date&&"text-muted-foreground"}`,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),n.date&&n.date.trim()!==""?(()=>{const t=_(n.date);return t?f(t,"PPP"):"Pick a date"})():"Pick a date"]})}),e.jsx(L,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(R,{mode:"single",selected:_(n.date),onSelect:t=>{t&&y(t)&&(d("date",f(t,"yyyy-MM-dd")),j("date",!1))},initialFocus:!0})})]}),i.date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.date})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-emerald-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"type_of_notice",className:"text-base font-semibold",children:"Type of Notice"})}),e.jsxs(S,{onValueChange:t=>d("type_of_notice",t),value:n.type_of_notice,children:[e.jsx(P,{children:e.jsx(C,{placeholder:"Select type"})}),e.jsx(w,{children:Y.map(t=>e.jsx(F,{value:t.notice_name,children:t.notice_name},t.id))})]}),i.type_of_notice&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.type_of_notice})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-teal-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"have_an_exception",className:"text-base font-semibold",children:"Have An Exception?"})}),e.jsx(g,{value:n.have_an_exception,onValueChange:t=>d("have_an_exception",t),name:"have_an_exception"}),i.have_an_exception&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.have_an_exception})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-indigo-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"note",className:"text-base font-semibold",children:"Note"})}),e.jsx("textarea",{id:"note",value:n.note||"",onChange:t=>d("note",t.target.value),rows:3,placeholder:"Enter any notes...",className:"resize-vertical min-h-[100px] w-full rounded-md border border-gray-300 px-3 py-2 focus:border-transparent focus:ring-2 focus:ring-blue-500 focus:outline-none"}),i.note&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.note})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-pink-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"evictions",className:"text-base font-semibold",children:"Evictions"})}),e.jsx(je,{id:"evictions",value:n.evictions||"",onChange:t=>d("evictions",t.target.value),placeholder:"Enter evictions information"}),i.evictions&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.evictions})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-red-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"sent_to_atorney",className:"text-base font-semibold",children:"Sent to Attorney"})}),e.jsx(g,{value:n.sent_to_atorney,onValueChange:t=>d("sent_to_atorney",t),name:"sent_to_atorney"}),i.sent_to_atorney&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.sent_to_atorney})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-yellow-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"hearing_dates",className:"text-base font-semibold",children:"Hearing Dates"})}),e.jsxs(O,{open:A.hearing_dates,onOpenChange:t=>j("hearing_dates",t),modal:!1,children:[e.jsx(z,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:`w-full justify-start text-left font-normal ${!n.hearing_dates&&"text-muted-foreground"}`,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),n.hearing_dates&&n.hearing_dates.trim()!==""?(()=>{const t=_(n.hearing_dates);return t?f(t,"PPP"):"Pick a date"})():"Pick a date"]})}),e.jsx(L,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(R,{mode:"single",selected:_(n.hearing_dates),onSelect:t=>{t&&y(t)&&(d("hearing_dates",f(t,"yyyy-MM-dd")),j("hearing_dates",!1))},initialFocus:!0})})]}),i.hearing_dates&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.hearing_dates})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-cyan-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"evected_or_payment_plan",className:"text-base font-semibold",children:"Evected Or Payment Plan"})}),e.jsx(g,{value:n.evected_or_payment_plan,onValueChange:t=>d("evected_or_payment_plan",t),name:"evected_or_payment_plan",options:[{value:"Evected",label:"Evected"},{value:"Payment Plan",label:"Payment Plan"}]}),i.evected_or_payment_plan&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.evected_or_payment_plan})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-violet-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"if_left",className:"text-base font-semibold",children:"If Left?"})}),e.jsx(g,{value:n.if_left,onValueChange:t=>d("if_left",t),name:"if_left"}),i.if_left&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.if_left})]}),e.jsxs("div",{className:"rounded-lg border-l-4 border-l-slate-500 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx(o,{htmlFor:"writ_date",className:"text-base font-semibold",children:"Writ Date"})}),e.jsxs(O,{open:A.writ_date,onOpenChange:t=>j("writ_date",t),modal:!1,children:[e.jsx(z,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:`w-full justify-start text-left font-normal ${!n.writ_date&&"text-muted-foreground"}`,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),n.writ_date&&n.writ_date.trim()!==""?(()=>{const t=_(n.writ_date);return t?f(t,"PPP"):"Pick a date"})():"Pick a date"]})}),e.jsx(L,{className:"z-[60] w-auto p-0",onOpenAutoFocus:t=>t.preventDefault(),children:e.jsx(R,{mode:"single",selected:_(n.writ_date),onSelect:t=>{t&&y(t)&&(d("writ_date",f(t,"yyyy-MM-dd")),j("writ_date",!1))},initialFocus:!0})})]}),i.writ_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.writ_date})]})]})}),e.jsx(fe,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{type:"button",variant:"outline",onClick:ie,className:"flex-1",children:"Cancel"}),e.jsx(N,{type:"submit",onClick:X,disabled:Q,className:"flex-1",children:Q?"Updating...":"Update Notice & Eviction"})]})})]})})})}export{ke as default};
