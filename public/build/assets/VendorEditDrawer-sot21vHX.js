import{r as s,b as $,j as i}from"./app-C2rmVmHv.js";import{B as S}from"./button-VjjEP6Vi.js";import{D as q,a as z,b as A}from"./drawer-D0-Vx3W3.js";import L from"./CityField-B6087oyR.js";import Q from"./VendorNameField-BN2vJqbt.js";import W from"./PhoneNumberField-Y28NVhNQ.js";import G from"./EmailField-C8UNmG78.js";import H from"./ServiceTypeField-C76ziOmH.js";import"./app-Ofegqgfz.js";import"./index-DjZQUolQ.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-Bbv7bqK3.js";import"./index-ChVvoAJ-.js";import"./index-DzsQSqwg.js";import"./index-C3pxZEMX.js";import"./index-B-E9P7_A.js";import"./index-_JNlNNro.js";import"./x-C2ppUAbT.js";import"./createLucideIcon-vG7_p-6g.js";import"./label-Ck9md-qZ.js";import"./popover-BkIdV067.js";import"./index-CZ2k1_vM.js";import"./command-DMwCmjrB.js";import"./search-D28ecmXm.js";import"./input-DlixSfKS.js";import"./plus-Dp6PyI5R.js";import"./trash-2-CCcs6h2C.js";import"./select-CZv-Yj7g.js";import"./index-Dc_FVRD7.js";import"./index-B1jceYVp.js";import"./index-CZcEh-_6.js";import"./index-kc4RGjFa.js";import"./chevron-down-CfuMUa4e.js";import"./check-DMxaY1KP.js";import"./chevron-up-BB7v6AqZ.js";function Fe({vendor:e,cities:x,open:j,onOpenChange:_,onSuccess:N}){const d=s.useRef(null),f=s.useRef(null),[V,m]=s.useState(""),[w,c]=s.useState(""),[,h]=s.useState(""),{data:o,setData:a,put:F,processing:C,errors:n,transform:D}=$({city_id:e?.city_id?.toString()||"",vendor_name:e?.vendor_name||"",number:e?.number||[],email:e?.email||[],service_type:e?.service_type||[]}),b=t=>{if(n[t])return n[t];const r=Object.keys(n).find(l=>l.startsWith(`${t}.`));if(r)return n[r]};s.useEffect(()=>{if(e){const t=e.city_id?.toString()||"",r=e.city?.city||"";a({city_id:t,vendor_name:e.vendor_name,number:e.number||[],email:e.email||[],service_type:e.service_type||[]}),h(r)}},[e,j]);const R=t=>{a("city_id",t);const r=x.find(l=>l.id.toString()===t);h(r?r.city:""),m("")},k=t=>{a("vendor_name",t.target.value),c("")},P=t=>{a("number",t)},I=t=>{a("email",t)},U=t=>{a("service_type",t)},E=t=>{if(t.preventDefault(),!e)return;m(""),c("");let r=!1;if((!o.city_id||o.city_id.trim()==="")&&(m("Please select a city before submitting the form."),d.current&&(d.current.focus(),d.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),(!o.vendor_name||o.vendor_name.trim()==="")&&(c("Please enter a vendor name before submitting the form."),f.current&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"})),r=!0),r)return;const l=()=>{try{const g=new URLSearchParams(window.location.search),y=["city","city_id","vendor_name","number","email","per_page","page"],u={};return y.forEach(v=>{const p=g.get(v);p!==null&&(u[v]=p)}),u}catch{return{}}};D(g=>{const y=l(),u={};return[["city","filter_city"],["city_id","filter_city_id"],["vendor_name","filter_vendor_name"],["number","filter_number"],["email","filter_email"],["per_page","filter_per_page"],["page","filter_page"]].forEach(([p,T])=>{y[p]!==void 0&&(u[T]=y[p])}),{...g,...u}}),F(route("vendors.update",e.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{m(""),c(""),_(!1),N?.()}})},B=()=>{if(e){const t=e.city_id?.toString()||"",r=e.city?.city||"";a({city_id:t,vendor_name:e.vendor_name,number:e.number||[],email:e.email||[],service_type:e.service_type||[]}),h(r)}m(""),c(""),_(!1)};return e?i.jsx(q,{open:j,onOpenChange:_,modal:!1,children:i.jsx(z,{size:"half",title:`Edit Vendor - ${e.vendor_name}`,children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:E,className:"space-y-4",children:[i.jsx(L,{cityRef:d,value:o.city_id,cities:x,onChange:R,error:n.city_id,validationError:V}),i.jsx(Q,{vendorNameRef:f,value:o.vendor_name,onChange:k,error:n.vendor_name,validationError:w}),i.jsx(W,{value:o.number,onChange:P,error:b("number")}),i.jsx(G,{value:o.email,onChange:I,error:b("email")}),i.jsx(H,{value:o.service_type,onChange:U,error:b("service_type")})]})}),i.jsxs(A,{className:"flex-row justify-end gap-2 border-t bg-muted/50 p-4",children:[i.jsx(S,{type:"button",variant:"outline",onClick:B,children:"Cancel"}),i.jsx(S,{type:"submit",onClick:E,disabled:C,children:C?"Updating...":"Update Vendor"})]})]})})}):null}export{Fe as default};
