import{r as s,u as T,j as r,H as _,a as l}from"./app-mUrH0ynJ.js";import{C as $,b as L}from"./card-D_RIkHPn.js";import{u as R}from"./usePermissions-BawB_cjI.js";import{A as U}from"./app-layout-CXK9X9au.js";import H from"./VendorCreateDrawer-B0TFLtLV.js";import B from"./VendorEditDrawer-BzLtr-0z.js";import M from"./FlashMessages-mgqk_g91.js";import q from"./PageHeader-DF-G_HON.js";import z from"./VendorFilters--ytFacC1.js";import G from"./VendorTable-DdlbhCF7.js";import J from"./VendorPagination-CQy4hE1n.js";import"./app-BxoA0TtB.js";import"./utils-CBfrqCZ4.js";import"./index-Co1yv0YL.js";import"./index-CdJFUDDL.js";import"./button-BFBNYzQ-.js";import"./index-CQgkcMAl.js";import"./index-CgzaaCP9.js";import"./index-Do303mGv.js";import"./index-D9BBn6e9.js";import"./index-bRwiAiPA.js";import"./index-kDRJ7vWo.js";import"./x-BVVw4O5L.js";import"./createLucideIcon-DUXn48BB.js";import"./index-Dc_FVRD7.js";import"./index-CXBw7cFo.js";import"./index-DEcWu7_s.js";import"./index-5IheD20q.js";import"./index-I5U3wwZt.js";import"./collapsible-DR70Hr7v.js";import"./chevron-right-o746ehSI.js";import"./index-DK4fbPLM.js";import"./log-out-CXDwqi9T.js";import"./chevrons-up-down-FHN_82j5.js";import"./app-logo-icon-afD3Sqey.js";import"./house-Bx2Ik4FM.js";import"./building-uSWxfBdk.js";import"./users-C2kYwBw2.js";import"./wrench-Cq_dpeQy.js";import"./credit-card-Bcb_2PMm.js";import"./dollar-sign-BB476t67.js";import"./file-text-CjfNfFxM.js";import"./triangle-alert-Dr9RWMLY.js";import"./bell-ch4AgGU_.js";import"./drawer-B7FkQmZP.js";import"./CityField-CN7nPi-w.js";import"./label-DmNL2-zA.js";import"./select-NL-VGbzo.js";import"./index-p6YNWFgp.js";import"./chevron-down-CcniYHCH.js";import"./check-nxBTAIc9.js";import"./chevron-up-Cls6AU_3.js";import"./VendorNameField-BKqW67x0.js";import"./input-Bo52L6_R.js";import"./PhoneNumberField-DHjXl_qi.js";import"./plus-Vhp6TgB7.js";import"./trash-2-PUmSVtRb.js";import"./EmailField-D5Uw0iMC.js";import"./ServiceTypeField-BzJ7glVL.js";import"./CityField-Ai_weWUy.js";import"./VendorNameField-CEyZeicI.js";import"./PhoneNumberField-_XOXUaC6.js";import"./EmailField-rdBIB4M2.js";import"./ServiceTypeField-BLAVYa83.js";import"./download-tURfbWWG.js";import"./search-BHqZNlG5.js";import"./table-DpihfFkM.js";import"./VendorTableRow-CAoy3gl9.js";import"./square-pen-3gz5SX3m.js";const K=(i,a="vendors.csv")=>{const p=["ID","City","Vendor Name","Number","Email","Service Type"],n=t=>!t||!Array.isArray(t)||t.length===0?"":t.join("; "),h=[p.join(","),...i.map(t=>[t.id,`"${t.city?.city||"N/A"}"`,`"${t.vendor_name}"`,`"${n(t.number)}"`,`"${n(t.email)}"`,`"${n(t.service_type)}"`].join(","))].join(`
`),d=new Blob([h],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),m=URL.createObjectURL(d);o.setAttribute("href",m),o.setAttribute("download",a),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(m)};function lt({vendors:i,filters:a,cities:p}){const[,n]=s.useState(a),[h,d]=s.useState(!1),[o,m]=s.useState(!1),[t,y]=s.useState(!1),[g,j]=s.useState(null),{flash:w}=T().props,{hasPermission:f,hasAllPermissions:v}=R(),[C,S]=s.useState({city:a.city||"",vendor_name:a.vendor_name||""}),[E,c]=s.useState(!1),x=(e,u)=>{S(N=>({...N,[e]:u}))},D=e=>{const u=e.target.value;x("city",u),c(u.length>0)},b=e=>{x("city",e.city),c(!1)},V=()=>{const e={...C};n(e),l.get(route("vendors.index"),e,{preserveState:!0,preserveScroll:!0})},F=()=>{const e={city:"",vendor_name:""};S(e),n(e),c(!1),l.get(route("vendors.index"),{},{preserveState:!0,preserveScroll:!0})},A=()=>{if(i.data.length===0){alert("No data to export");return}d(!0);try{const e=`vendors-${new Date().toISOString().split("T")[0]}.csv`;K(i.data,e)}catch(e){console.error("Export failed:",e),alert("Export failed. Please try again.")}finally{d(!1)}},P=e=>{confirm("Are you sure you want to delete this vendor?")&&l.delete(route("vendors.destroy",e.id))},O=()=>{l.reload()},I=e=>{j(e),y(!0)},k=()=>{l.reload()};return r.jsxs(U,{children:[r.jsx(_,{title:"Vendors"}),r.jsx("div",{className:"py-12",children:r.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[r.jsx(M,{flash:w}),r.jsx(q,{hasExportPermission:f("vendor.export"),hasCreatePermissions:v(["vendors.create","vendors.store"]),isExporting:h,onExport:A,onAddVendor:()=>m(!0)}),r.jsx($,{children:r.jsxs(L,{className:"p-6",children:[r.jsx(z,{tempFilters:C,cities:p,showCityDropdown:E,onTempFilterChange:x,onCityInputChange:D,onCitySelect:b,onSearchClick:V,onClearFilters:F,setShowCityDropdown:c}),r.jsx(G,{vendors:i.data,hasEditPermissions:v(["vendors.edit","vendors.update"]),hasDeletePermission:f("vendors.destroy"),onEditVendor:I,onDeleteVendor:P}),r.jsx(J,{links:i.links})]})})]})}),r.jsx(H,{cities:p,open:o,onOpenChange:m,onSuccess:O}),r.jsx(B,{cities:p,open:t,onOpenChange:y,vendor:g,onSuccess:k})]})}export{lt as default};
