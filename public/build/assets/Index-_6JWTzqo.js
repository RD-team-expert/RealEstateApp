import{r as L,a as I,j as e,H as B,L as f,b as v}from"./app-BM6QPhCs.js";import{u as U,A as P}from"./app-layout-CFtgqb2g.js";import{B as h}from"./app-logo-icon-_BgUcEZ_.js";import{I as b}from"./input-DxItmhPy.js";import{C as o,c as x,a as R,b as V}from"./card-CBl_kNDF.js";import{P as H,T as k,a as Y,b as S,c as a,d as O,e as r,f as z}from"./table-BtCT9Bdr.js";import{B as c}from"./badge-BHzBvDls.js";import{D as F}from"./download-DPRof4Hp.js";import{E as M}from"./eye-pC2j2P_R.js";import{S as q}from"./square-pen-DMp9Pa9u.js";import"./app-EMhG3jeb.js";import"./index-_PhYekxG.js";import"./index-DSqKqkft.js";const G=(N,n="units.csv")=>{const p=[["ID","City","Property","Unit Name","Tenants","Lease Start","Lease End","Beds","Baths","Lease Status","Monthly Rent","Recurring Transaction","Utility Status","Account Number","Insurance","Insurance Expiration","Vacant","Listed","Applications"].join(","),...N.map(s=>[s.id,`"${s.city}"`,`"${s.property}"`,`"${s.unit_name}"`,`"${s.tenants||""}"`,`"${s.lease_start?new Date(s.lease_start).toLocaleDateString():""}"`,`"${s.lease_end?new Date(s.lease_end).toLocaleDateString():""}"`,s.count_beds||"",s.count_baths||"",`"${s.lease_status||""}"`,`"${s.formatted_monthly_rent||""}"`,`"${(s.recurring_transaction||"").replace(/"/g,'""')}"`,`"${(s.utility_status||"").replace(/"/g,'""')}"`,`"${(s.account_number||"").replace(/"/g,'""')}"`,`"${s.insurance||""}"`,`"${s.insurance_expiration_date?new Date(s.insurance_expiration_date).toLocaleDateString():""}"`,`"${s.vacant}"`,`"${s.listed}"`,s.total_applications||0].join(","))].join(`
`),u=new Blob([p],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),m=URL.createObjectURL(u);l.setAttribute("href",m),l.setAttribute("download",n),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(m)};function ce({auth:N,units:n,statistics:i,filters:p}){const{hasPermission:u,hasAnyPermission:l,hasAllPermissions:m}=U(),[s,C]=L.useState(p),[y,_]=L.useState(!1),{flash:j}=I().props,d=(t,g)=>{const w={...s,[t]:g};C(w),v.get(route("units.index"),w,{preserveState:!0,preserveScroll:!0})},T=t=>{confirm("Are you sure you want to delete this unit?")&&v.delete(route("units.destroy",t.id))},A=()=>{if(n.data.length===0){alert("No data to export");return}_(!0);try{const t=`units-${new Date().toISOString().split("T")[0]}.csv`;G(n.data,t)}catch(t){console.error("Export failed:",t),alert("Export failed. Please try again.")}finally{_(!1)}},D=t=>t?e.jsx(c,{variant:t==="Yes"?"destructive":"default",children:t}):e.jsx(c,{variant:"outline",children:"-"}),$=t=>t?e.jsx(c,{variant:t==="Yes"?"default":"secondary",children:t}):e.jsx(c,{variant:"outline",children:"-"}),E=t=>!t||t==="-"?e.jsx(c,{variant:"outline",children:"N/A"}):e.jsx(c,{variant:t==="Yes"?"default":"destructive",children:t});return e.jsxs(P,{children:[e.jsx(B,{title:"Units"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-full mx-auto sm:px-6 lg:px-8",children:[j?.success&&e.jsx("div",{className:"mb-4 bg-chart-1/20 border border-chart-1 text-chart-1 px-4 py-3 rounded",children:j.success}),j?.error&&e.jsx("div",{className:"mb-4 bg-destructive/20 border border-destructive text-destructive px-4 py-3 rounded",children:j.error}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsx(o,{children:e.jsxs(x,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Total Units"}),e.jsx("p",{className:"text-3xl font-bold text-primary",children:i.total})]})}),e.jsx(o,{children:e.jsxs(x,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Vacant"}),e.jsx("p",{className:"text-3xl font-bold text-destructive",children:i.vacant})]})}),e.jsx(o,{children:e.jsxs(x,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Occupied"}),e.jsx("p",{className:"text-3xl font-bold text-chart-1",children:i.occupied})]})}),e.jsx(o,{children:e.jsxs(x,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Listed"}),e.jsx("p",{className:"text-3xl font-bold text-chart-2",children:i.listed})]})}),e.jsx(o,{children:e.jsxs(x,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Total Applications"}),e.jsx("p",{className:"text-3xl font-bold text-chart-3",children:i.total_applications})]})})]}),e.jsxs(o,{children:[e.jsxs(R,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(V,{className:"text-2xl",children:"Units List"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:A,disabled:y||n.data.length===0,className:"flex items-center",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),y?"Exporting...":"Export CSV"]}),l(["units.store","units.create"])&&e.jsx(f,{href:route("units.create"),children:e.jsxs(h,{children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Unit"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 mt-4",children:[e.jsx(b,{type:"text",placeholder:"City",value:s.city||"",onChange:t=>d("city",t.target.value)}),e.jsx(b,{type:"text",placeholder:"Property",value:s.property||"",onChange:t=>d("property",t.target.value)}),e.jsx(b,{type:"text",placeholder:"Unit Name",value:s.unit_name||"",onChange:t=>d("unit_name",t.target.value)}),e.jsxs("select",{value:s.vacant||"",onChange:t=>d("vacant",t.target.value),className:"h-9 rounded-md border border-input bg-background px-3 text-sm text-foreground",children:[e.jsx("option",{value:"",children:"All Vacant Status"}),e.jsx("option",{value:"Yes",children:"Vacant"}),e.jsx("option",{value:"No",children:"Occupied"})]}),e.jsxs("select",{value:s.listed||"",onChange:t=>d("listed",t.target.value),className:"h-9 rounded-md border border-input bg-background px-3 text-sm text-foreground",children:[e.jsx("option",{value:"",children:"All Listed Status"}),e.jsx("option",{value:"Yes",children:"Listed"}),e.jsx("option",{value:"No",children:"Not Listed"})]}),e.jsxs("select",{value:s.insurance||"",onChange:t=>d("insurance",t.target.value),className:"h-9 rounded-md border border-input bg-background px-3 text-sm text-foreground",children:[e.jsx("option",{value:"",children:"All Insurance"}),e.jsx("option",{value:"Yes",children:"Has Insurance"}),e.jsx("option",{value:"No",children:"No Insurance"})]})]})]}),e.jsxs(x,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(k,{children:[e.jsx(Y,{children:e.jsxs(S,{children:[e.jsx(a,{children:"City"}),e.jsx(a,{children:"Property"}),e.jsx(a,{children:"Unit Name"}),e.jsx(a,{children:"Tenants"}),e.jsx(a,{children:"Lease Start"}),e.jsx(a,{children:"Lease End"}),e.jsx(a,{children:"Beds"}),e.jsx(a,{children:"Baths"}),e.jsx(a,{children:"Lease Status"}),e.jsx(a,{children:"Monthly Rent"}),e.jsx(a,{children:"Recurring Transaction"}),e.jsx(a,{children:"Utility Status"}),e.jsx(a,{children:"Account Number"}),e.jsx(a,{children:"Insurance"}),e.jsx(a,{children:"Insurance Exp."}),e.jsx(a,{children:"Vacant"}),e.jsx(a,{children:"Listed"}),e.jsx(a,{children:"Applications"}),l(["units.show","units.edit","units.update","units.destroy"])&&e.jsx(a,{children:"Actions"})]})}),e.jsx(O,{children:n.data.map(t=>e.jsxs(S,{className:"hover:bg-muted/50",children:[e.jsx(r,{className:"font-medium",children:t.city}),e.jsx(r,{children:t.property}),e.jsx(r,{children:e.jsx("span",{className:"font-medium",children:t.unit_name})}),e.jsx(r,{children:t.tenants||"-"}),e.jsx(r,{children:t.lease_start?new Date(t.lease_start).toLocaleDateString():"-"}),e.jsx(r,{children:t.lease_end?new Date(t.lease_end).toLocaleDateString():"-"}),e.jsx(r,{children:t.count_beds||"-"}),e.jsx(r,{children:t.count_baths||"-"}),e.jsx(r,{children:t.lease_status||"-"}),e.jsx(r,{children:e.jsx("span",{className:"font-medium",children:t.formatted_monthly_rent})}),e.jsx(r,{children:e.jsx("div",{className:"max-w-32 truncate",title:t.recurring_transaction||"",children:t.recurring_transaction||"-"})}),e.jsx(r,{children:e.jsx("div",{className:"max-w-24 truncate",title:t.utility_status||"",children:t.utility_status||"-"})}),e.jsx(r,{children:e.jsx("div",{className:"max-w-24 truncate",title:t.account_number||"",children:t.account_number||"-"})}),e.jsx(r,{children:E(t.insurance)}),e.jsx(r,{children:t.insurance_expiration_date?new Date(t.insurance_expiration_date).toLocaleDateString():"-"}),e.jsx(r,{children:D(t.vacant)}),e.jsx(r,{children:$(t.listed)}),e.jsx(r,{children:e.jsx(c,{variant:"secondary",className:"bg-secondary text-secondary-foreground",children:t.total_applications})}),l(["units.show","units.edit","units.update","units.destroy"])&&e.jsx(r,{children:e.jsxs("div",{className:"flex gap-1",children:[u("units.show")&&e.jsx(f,{href:route("units.show",t.id),children:e.jsx(h,{variant:"outline",size:"sm",children:e.jsx(M,{className:"h-4 w-4"})})}),m(["units.edit","units.update"])&&e.jsx(f,{href:route("units.edit",t.id),children:e.jsx(h,{variant:"outline",size:"sm",children:e.jsx(q,{className:"h-4 w-4"})})}),u("units.destroy")&&e.jsx(h,{variant:"outline",size:"sm",onClick:()=>T(t),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:e.jsx(z,{className:"h-4 w-4"})})]})})]},t.id))})]})}),n.data.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-lg",children:"No units found matching your criteria."}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search filters."})]}),n.last_page>1&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsx("nav",{className:"flex space-x-2",children:n.links.map((t,g)=>e.jsx("button",{onClick:()=>t.url&&v.get(t.url),disabled:!t.url,className:`px-3 py-2 text-sm rounded ${t.active?"bg-primary text-primary-foreground":t.url?"bg-muted text-foreground hover:bg-accent":"bg-muted text-muted-foreground cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:t.label}},g))})}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground text-center",children:["Showing ",n.from||0," to ",n.to||0," of ",n.total||0," units"]})]})]})]})})]})}export{ce as default};
