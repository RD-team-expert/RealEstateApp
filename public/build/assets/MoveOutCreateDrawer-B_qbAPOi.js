import{r as i,b as B,j as r}from"./app-IncGAUEB.js";import{D as G,a as H,b as J}from"./drawer-BabOL_dj.js";import{B as P}from"./button-BZreYh_c.js";import K from"./LocationSection-B4nX7I0g.js";import Q from"./DateFieldsSection-BjwfD0Ei.js";import W from"./PropertyDetailsSection-Dmzk_Qrz.js";import X from"./StatusFieldsSection-CohxKjqb.js";import"./app-DgqXL21p.js";import"./index-CfKQ6yNG.js";import"./index-bCzQdt7o.js";import"./index-BWcAjI1y.js";import"./index-D0fQOWIr.js";import"./index-yZxLUvKN.js";import"./index-iNsZkCT-.js";import"./index-6KC1G_4u.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-B_qSqN6z.js";import"./createLucideIcon-Ci0S1m_Z.js";import"./FormField-D0ltm2Bv.js";import"./label-BhALl-XJ.js";import"./TextInputField-c8ZEtt36.js";import"./input-BKi6rfRv.js";import"./popover-D0q3r5CP.js";import"./index-DfBxMdWp.js";import"./command-AnX11QHu.js";import"./search-CFDkSiim.js";import"./chevrons-up-down-D4md56fd.js";import"./check-gd2_wZBq.js";import"./DatePickerField-BGukHOV1.js";import"./calendar-UFpA7cIJ.js";import"./format-PYUiRpxY.js";import"./chevron-left-WEUqp8UO.js";import"./chevron-right-Dv0ELFzT.js";import"./chevron-down-uas8HWR-.js";import"./calendar-CBsjNrh9.js";import"./RadioGroupField-BY_MSgrz.js";import"./radioGroup-BhgCKDH3.js";import"./index-X0Rqfk2m.js";import"./index-DizBXXCV.js";import"./TextAreaField-DoaLUv1L.js";import"./textarea-Dt1hfgQe.js";function Oe({cities:N,propertiesByCityId:y,unitsByPropertyId:g,open:R,onOpenChange:b,onSuccess:k,redirectContext:l}){const u=i.useRef(null),c=i.useRef(null),p=i.useRef(null),[I,o]=i.useState({city:"",property:"",unit:""}),[v,S]=i.useState(null),[C,f]=i.useState(null),[x,m]=i.useState(null),[E,h]=i.useState([]),[U,_]=i.useState([]),[V,F]=i.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:s,setData:a,post:M,processing:j,errors:d,reset:T,transform:A}=B({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",all_the_devices_are_off:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",renter:"",move_out_form:"",utility_type:""}),O=n=>{const e=parseInt(n);S(e),f(null),m(null),a("unit_id",null),o(t=>({...t,city:"",property:"",unit:""})),e&&y[e]?h(y[e]):h([]),_([])},z=n=>{const e=parseInt(n);f(e),m(null),a("unit_id",null),o(t=>({...t,property:"",unit:""})),e&&g[e]?_(g[e]):_([])},L=n=>{const e=parseInt(n);m(e),a("unit_id",e),o(t=>({...t,unit:""}))},q=n=>{F(e=>({...e,[n]:!e[n]}))},D=n=>{n.preventDefault(),o({city:"",property:"",unit:""});let e=!1;v||(o(t=>({...t,city:"Please select a city before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),C||(o(t=>({...t,property:"Please select a property before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),(!x||!s.unit_id)&&(o(t=>({...t,unit:"Please select a unit before submitting the form."})),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),!e&&(A(t=>({...t,move_out_date:t.move_out_date?.trim()?t.move_out_date:null,date_lease_ending_on_buildium:t.date_lease_ending_on_buildium?.trim()?t.date_lease_ending_on_buildium:null,date_utility_put_under_our_name:t.date_utility_put_under_our_name?.trim()?t.date_utility_put_under_our_name:null,redirect_city:l?.city??null,redirect_property:l?.property??null,redirect_unit:l?.unit??null,redirect_page:l?.page??null,redirect_perPage:l?.perPage??null})),M(route("move-out.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{w(),k?.()}}))},w=()=>{T(),S(null),f(null),m(null),o({city:"",property:"",unit:""}),h([]),_([]),b(!1)};return r.jsx(G,{open:R,onOpenChange:b,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Move-Out Record",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsx(K,{cities:N,availableProperties:E,availableUnits:U,selectedCity:v,selectedProperty:C,selectedUnit:x,validationErrors:I,cityRef:u,propertyRef:c,unitRef:p,onCityChange:O,onPropertyChange:z,onUnitChange:L,tenants:s.tenants,tenantsError:d.tenants,onTenantsChange:n=>a("tenants",n)}),r.jsx(Q,{data:s,errors:d,calendarStates:V,onCalendarToggle:q,onDataChange:a}),r.jsx(W,{data:s,errors:d,onDataChange:a}),r.jsx(X,{data:s,errors:d,onDataChange:a})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex gap-2 w-full",children:[r.jsx(P,{type:"button",variant:"outline",onClick:w,className:"flex-1",children:"Cancel"}),r.jsx(P,{type:"submit",onClick:D,disabled:j,className:"flex-1",children:j?"Creating...":"Create Move-Out Record"})]})})]})})})}export{Oe as default};
