import{r as n,b as L,j as e}from"./app-DIEWn7Ix.js";import{D as q,a as B,b as G}from"./drawer-fqLIckn8.js";import{B as w}from"./button-C0qpziZb.js";import H from"./LocationSection-bA24amZM.js";import J from"./DateFieldsSection-BN21BcVt.js";import K from"./PropertyDetailsSection-DTfgQZoc.js";import Q from"./StatusFieldsSection-C8QzsqQn.js";import"./app-ChTVGdbA.js";import"./index-DKA-WKms.js";import"./index-Bt0zfGgm.js";import"./index-VPuXs-fY.js";import"./index-C4fRG95q.js";import"./index-BtB4-ACe.js";import"./index-BBSsUOtm.js";import"./index-BWA9V35X.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-imATtpBe.js";import"./createLucideIcon-lZMskSwP.js";import"./FormField-Bcd3p-iW.js";import"./label-BIgMUqDa.js";import"./SelectField-DzttpYaZ.js";import"./select-DaMc0ZYU.js";import"./index-Dc_FVRD7.js";import"./index-Bp33PYYw.js";import"./index-DwaLeO51.js";import"./index-DWHJnJ6z.js";import"./index-B14YlqPx.js";import"./index-OmisV_7g.js";import"./chevron-down-DABifuem.js";import"./check-CBvn5g3p.js";import"./chevron-up-DPOsvpyl.js";import"./TextInputField-DXwSnTh7.js";import"./input-Dp80VBC1.js";import"./DatePickerField-CFJUe7Ct.js";import"./calendar-A7iFafDy.js";import"./format-PYUiRpxY.js";import"./chevron-left-CWUKElF8.js";import"./chevron-right-lBI-HPj1.js";import"./popover-BTBKKAKu.js";import"./calendar-BV4TAGR8.js";import"./TextAreaField-CLVpdpcX.js";import"./textarea-DmwE5RE4.js";import"./RadioGroupField-DLXxrVuz.js";import"./radioGroup-BEE05Kck.js";function zt({cities:N,propertiesByCityId:h,unitsByPropertyId:y,open:P,onOpenChange:b,onSuccess:R}){const l=n.useRef(null),u=n.useRef(null),c=n.useRef(null),[k,i]=n.useState({city:"",property:"",unit:""}),[C,g]=n.useState(null),[x,f]=n.useState(null),[v,m]=n.useState(null),[I,_]=n.useState([]),[E,p]=n.useState([]),[U,V]=n.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:a,setData:s,post:F,processing:S,errors:d,reset:M}=L({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",move_out_form:"",utility_type:""}),T=r=>{const t=parseInt(r);g(t),f(null),m(null),s("unit_id",null),i(o=>({...o,city:"",property:"",unit:""})),t&&h[t]?_(h[t]):_([]),p([])},A=r=>{const t=parseInt(r);f(t),m(null),s("unit_id",null),i(o=>({...o,property:"",unit:""})),t&&y[t]?p(y[t]):p([])},O=r=>{const t=parseInt(r);m(t),s("unit_id",t),i(o=>({...o,unit:""}))},z=r=>{V(t=>({...t,[r]:!t[r]}))},j=r=>{r.preventDefault(),i({city:"",property:"",unit:""});let t=!1;C||(i(o=>({...o,city:"Please select a city before submitting the form."})),l.current&&(l.current.focus(),l.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),x||(i(o=>({...o,property:"Please select a property before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),(!v||!a.unit_id)&&(i(o=>({...o,unit:"Please select a unit before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),t=!0),!t&&F(route("move-out.store"),{onSuccess:()=>{D(),R?.()}})},D=()=>{M(),g(null),f(null),m(null),i({city:"",property:"",unit:""}),_([]),p([]),b(!1)};return e.jsx(q,{open:P,onOpenChange:b,modal:!1,children:e.jsx(B,{size:"half",title:"Create New Move-Out Record",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx(H,{cities:N,availableProperties:I,availableUnits:E,selectedCity:C,selectedProperty:x,selectedUnit:v,validationErrors:k,cityRef:l,propertyRef:u,unitRef:c,onCityChange:T,onPropertyChange:A,onUnitChange:O,tenants:a.tenants,tenantsError:d.tenants,onTenantsChange:r=>s("tenants",r)}),e.jsx(J,{data:a,errors:d,calendarStates:U,onCalendarToggle:z,onDataChange:s}),e.jsx(K,{data:a,errors:d,onDataChange:s}),e.jsx(Q,{data:a,errors:d,onDataChange:s})]})}),e.jsx(G,{children:e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx(w,{type:"button",variant:"outline",onClick:D,className:"flex-1",children:"Cancel"}),e.jsx(w,{type:"submit",onClick:j,disabled:S,className:"flex-1",children:S?"Creating...":"Create Move-Out Record"})]})})]})})})}export{zt as default};
